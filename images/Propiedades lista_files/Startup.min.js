function globalInit(n){if(!n)return!1;n.on401RedirectUrl&&n.genErrorMsg&&$(document).ajaxError(function(t,i){i.status===401?window.location.href=n.on401RedirectUrl:MessageBox.alert(n.genErrorMsg)});LazyMediaHandler.init();Overlay.init();HelpBox.initTooltips();TimeFilter.initDropdowns();n.translations&&Translations.init(n.translations);n.requests&&Requests.init(n.requests);n.limitURL&&(Limit.url=n.limitURL);n.calendar&&window.CalendarDate&&("firstDOW"in n.calendar&&(CalendarDate.firstDOW=n.calendar.firstDOW),n.calendar.WEEKDAYSABR&&(CalendarDate.WEEKDAYSABR=splitAnd(n.calendar.WEEKDAYSABR," ",null,!0)),n.calendar.WEEKDAYS&&(CalendarDate.WEEKDAYS=splitAnd(n.calendar.WEEKDAYS," ",null,!0)),n.calendar.MONTHS&&(CalendarDate.MONTHS=splitAnd(n.calendar.MONTHS," ",null,!0)));n.money&&Money.init(n.money);n.phoneNumber&&PhoneNumber.init(n.phoneNumber);n.urls&&Urls.init(n.urls);Search.GenericList.init();EventHandler.addListener(window,"resize",function(){setTimeout(function(){MultiCultureControl.checkLanguageWidth()},250)})}function successHandler(n,t,i,r){var u,f,e;if(!t||!isObject(t)||!("status"in t)){MessageBox.alert(Translations.get(Translations.keys.GenericError));return}if(t.replaces&&$(t.replaces).length>0)for(f in t.replaces)u=t.replaces[f],u&&document.querySelectorAll(f).forEach(function(n){var t;Popup.isPopup(n)&&(t=n.id);$(n).replaceWith(u);t&&Popup.rebind()});if(t.updates&&$(t.updates).length>0)for(f in t.updates)u=t.updates[f],u&&document.querySelectorAll(f).forEach(function(n){$(n).html(u)});if(t.insertBefore&&$(t.insertBefore).length>0&&forEachProp(t.insertBefore,function(n,t){u=t[n];u&&document.querySelectorAll(n).forEach(function(n){$(n).before(u)})}),t.remove&&t.remove.length>0&&t.remove.forEach(function(n){document.querySelectorAll(n).forEach(function(n){n.remove()})}),t.insertAfter&&$(t.insertAfter).length>0&&forEachProp(t.insertAfter,function(n,t){u=t[n];u&&document.querySelectorAll(n).forEach(function(n){$(n).after(u)})}),t.alertMessage&&(r&&typeof r.messageBoxCallback=="function"?MessageBox.alert(t.alertMessage.message,function(){r.messageBoxCallback(t)},t.alertMessage.title,t.alertMessage.okText):MessageBox.alert(t.alertMessage.message,t.alertMessage.okAction,t.alertMessage.title,t.alertMessage.okText)),t.confirmMessage){if(r&&typeof r.messageBoxCallback=="function"&&Array.isArray(t.confirmMessage.buttons))for(e=0;e<t.confirmMessage.buttons.length;e++)if(t.confirmMessage.buttons[e].isMain){t.confirmMessage.buttons[e].action=function(){r.messageBoxCallback(t)};break}MessageBox.confirmMultiple(t.confirmMessage.message,t.confirmMessage.buttons,t.confirmMessage.title)}t.popupContent&&(n&&n.removeAttribute("ajaxRequest"),Popup.open(t.popupContent,null,n?n.getAttribute("data-persistence"):!1,r?r.popupOptions:null),n&&n.setAttribute("ajaxRequest","true"));t.redirectData&&(typeof t.redirectData.url=="string"&&t.redirectData.url.length>0?t.redirectData.parameters?window.post(t.redirectData.url,HttpUtility.queryToObject(t.redirectData.parameters),t.redirectData.target):t.redirectData.target?window.open(t.redirectData.url,t.redirectData.target):window.location.href=t.redirectData.url:(console.log("ajaxRequest recebeu uma instancia de redirectData sem URL para redirecionar."),console.log(t)));typeof i=="function"&&i(t);LazyMediaHandler.init();Overlay.init();MultiCultureControl.checkLanguageWidth();HelpBox.initTooltips();TimeFilter.initDropdowns()}function exportSuccessHandler(n,t,i,r,u){var e,o,s,f,h;t&&(e=null,u&&u.getResponseHeader("content-disposition")&&(e=/filename[^;\n=]*=(['"].*?\2|[^;\n]*)/.exec(u.getResponseHeader("content-disposition"))),o=isObject(r)&&r.fileName?r.fileName:e&&e.length>1?e[1]:guid(),s=n==="application/vnd.openxmlformats-officedocument.wordprocessingml.document"?new Blob([t],{type:n}):new Blob(["﻿",t],{type:n+";charset=utf-8;"}),navigator.msSaveBlob?navigator.msSaveBlob(s,o):(f=document.createElement("a"),f.download!==undefined&&(h=URL.createObjectURL(s),f.setAttribute("href",h),f.setAttribute("download",o),f.style.visibility="hidden",document.body.appendChild(f),f.click(),document.body.removeChild(f))));typeof i=="function"&&i(t)}function ajaxRequest(n,t,i,r,u,f){if(!n||n.getAttribute("ajaxRequest")!="true"){f&&f.hideLoading||Loading.showLate();n&&n.setAttribute("ajaxRequest","true");var e={data:r||"",method:i||"GET",async:f&&"async"in f?f.async:!0,success:function(t,i,r){if(r.status!=302){var e=r.getResponseHeader("content-type");ExportContentTypes.indexOf(e)>-1?exportSuccessHandler(e,t,u,f,r):successHandler(n,t,u,f)}},error:function(n,u,e){if(!n||n.status!=0){if(isObject(f)){if("onError"in f&&typeof f.onError=="function")f.onError(n,u,e);if(f.suppressMessageOnError){console.warn("the following error occurred in the ajaxRequest and the generic message was suppressed");console.log("error: "+e);console.log("url: "+t);console.log("requestMethod: "+i);console.log("params: "+r);return}}MessageBox.alert(Translations.get(Translations.keys.GenericError))}},complete:function(){f&&f.hideLoading?f.hideLoading&&n&&!f.keepInlineLoading&&Element.remove(n.querySelector(".loading")||n.next(".loading")):Loading.hide();isObject(f)&&"onComplete"in f&&typeof f.onComplete=="function"&&f.onComplete();n&&n.removeAttribute("ajaxRequest")}};return isObject(f)&&isObject(f.ajaxOptions)&&forEachProp(f.ajaxOptions,function(n,t){e[n]=t[n]}),$.ajax(t,e)}}function updateParams(n,t,i){var r;return!Array.isArray(n)||isBlank(t)?n:(r=n.findIndex(function(n){return n.name===t}),r===-1?n.push({name:t,value:i}):n[r].value=i,n)}function getOptionsForDirectFileDownload(n){var t=function(){var n=new XMLHttpRequest,t=window.navigator.userAgent,i=t.indexOf("MSIE "),r=t.indexOf("Trident/");return(i>-1||r>-1)&&n.open("POST",url),n.onreadystatechange=function(){if(n.readyState==2){var t=n.getResponseHeader("content-type");ExportContentTypes.indexOf(t)>-1&&(n.responseType="blob")}},n.responseType="text",n};return isObject(n)?isObject(n.ajaxOptions)?n.ajaxOptions.xhr=t:n.ajaxOptions={xhr:t}:n={ajaxOptions:{xhr:t}},n}function appendStringParams(n,t){var i=ensureArray(t).filter(function(n){return!isBlank(n)});return n=n||"",i.length>0&&(n+=(n?"&":"")+i.join("&")),n}function onEscapeKeypress(){$(document).on("keydown",function(n){var t=n.keyCode||n.which;t===EventKeys.Esc&&Popup.getLayerCount()>0&&Popup.onEscapeKeypress()});IsEscKeyBinded=!0}function regexEscape(n){return(n+"").replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function matchSearchText(n,t){var f,r,i,u,e;return(t=(t+"").trim().toLowerCase(),t.indexOf(n)>=0)?!0:(f=new RegExp(regexEscape(n).toUTF8Base(),"ig"),r=t.toUTF8Base(),i=r.match(f),i&&(u=r.indexOf(i[0]),e=i[0].length+u,u!=-1&&e<=t.length))?!0:!1}function dataSerializer(n,t,i,r){var f,e,u,h,o=function(n){var u,t;if(!n||!n.length)return"";for(u=[],t=0;t<n.length;t++)n[t]&&n[t].getAttribute(i)&&u.push(n[t].getAttribute(i)+"="+encodeURIComponent(n[t].getAttribute(r)||""));return u.join("&")},s;if(!i||!r||(typeof n=="string"?(h=n,n=document.getElementById(h),n||(n=document.querySelector(h))):n instanceof jQuery&&(n=n[0]),!n))return"";if(e=[],n.getAttribute(i)&&(u=o([n]),u&&e.push(u)),t){if(f=n.querySelectorAll(t),f&&f.length>0)for(u=o(f),u&&e.push(u),s=0;s<f.length;s++)u=o(f[s].querySelectorAll("["+i+"]["+r+"]")),u&&e.push(u)}else u=o(n.querySelectorAll("["+i+"]["+r+"]")),u&&e.push(u);return e.join("&")}function isObject(n){return n!=null&&n!=undefined&&n!==""&&n!==0&&n!==NaN&&typeof n=="object"}function isBlank(n,t){return typeof n!="string"?(console.log("valor recebido nao é uma string. valor = "+n),!0):t?n.length==0:n.trim().length==0}function isEmptyObject(n){var t,i;if(!isObject(n))return console.log('isEmptyObject: param "obj" is not an object.'),!0;t=0;for(i in n)i&&t++;return t==0}function stopEventPropagation(n,t){if(!n)return!1;n.stopPropagation?n.stopPropagation():n.cancelBubble=!0;n.stopped=!0;t&&n.preventDefault()}function cancelEvent(n){if(!n)return!1;if(n.cancelBubble=!0,n.stopPropagation){n.stopPropagation();
//!IE
}if(n.returnValue=!1,n.preventDefault){n.preventDefault();
//!IE
}return!1}function textAreaKeyUp(n){n.style.height="auto";n.style.height=n.scrollHeight+"px"}function createHtmlElement(n,t,i){var r;return n?(r=document.createElement(n),isObject(t)&&forEachProp(t,function(n,t){n in r&&typeof r[n]==typeof t[n]?r[n]=t[n]:r.setAttribute(n,t[n])}),i!==undefined&&r.appendMany(ensureArray(i)),r):!1}function setSelectionRange(n,t,i){if(n.setSelectionRange)n.focus(),n.setSelectionRange(t,i);else if(n.createTextRange){var r=n.createTextRange();r.collapse(!0);r.moveEnd("character",i);r.moveStart("character",t);r.select()}}function highlightNode(n){var t,i,r,u,f;n&&(t="highlighter_"+(n.id||shortGuid()),i=n.offsetTop+"px",r=n.parentNode.clientWidth+"px",u=n.clientHeight+"px",f=createHtmlElement("div",{id:t,style:"position:absolute;top:{0};width:{1};height:{2};background-color:rgba(28, 164, 232, 0.6);".format(i,r,u)}),n.parentNode.appendChild(f),$("#"+t).fadeOut(1e3,"linear",function(){this.remove()}))}function getEventKeyCode(n){var t=n||window.event;return t?t.keyCode||t.which:0}function guid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n==="x"?t:t&3|8;return i.toString(16)})}function shortGuid(){return"x"+Math.floor(Math.random(4294967295)*4294967295).toString(16)+(new Date).getTime().toString(16)}function updateArray(n,t){for(var r=n.length,i=t.length;i--;)n[r+i]=t[i];return n}function copyElementContents(n){var t,i,r;document.body.createTextRange?(t=document.body.createTextRange(),t.moveToElementText(n),t.select(),t.execCommand("Copy")):window.getSelection&&document.createRange&&(i=document.createRange(),i.selectNodeContents(n),r=window.getSelection(),r.removeAllRanges(),r.addRange(i),document.execCommand("copy"))}function isMobile(n){var t=n||window;return t.innerWidth<=768?!0:function(n){try{return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substr(0,4))}catch(t){return!1}}(navigator.userAgent||navigator.vendor||t.opera)}function inputNumberValue(n){var t,i,r;if(!n)return NaN;if(t=n.value,n.hasAttribute("data-groupsymbol"))for(i=new RegExp(n.getAttribute("data-groupsymbol"),"g");t.indexOf(i.source)>-1;)t=t.replace(i.source,"");return n.hasAttribute("data-decimalsymbol")&&(t=t.replace(n.getAttribute("data-decimalsymbol"),".")),r=new Number(t),r.valueOf()}function applyDropdowns(n,t){var u=[],r,i;if(!n)return!1;for(t&&!t.applyText?t.applyText=Translations.get(Translations.keys.Apply):t||(t={applyText:Translations.get(Translations.keys.Apply)}),r=n.querySelectorAll("select[multiple],select[data-group-selectable]"),i=0;i<r.length;i++)r[i].hasAttribute("data-is-template")||u.push(new Dropdown(r[i],t).get());return u}function forEachProp(n,t){if(!isObject(n)){console.log("forEachProp: requer objeto para iterar.");return}if(typeof t!="function"){console.log("forEachProp: sem acao a executar.");return}for(var i in n)if(i&&n.hasOwnProperty(i)&&t(i,n)===!1)break}function setTimeline(){$(".contentTimeline").each(function(){var r=$(window).width(),u=$(this).find(".contentTimelineStep").length,i;if(r<769&&u>2){$(this).find(".contentTimelineStep.active").prev().addClass("previous");var n=$(this).find(".contentTimelineStep.active").position().left*-1,t=$(this).find(".contentTimelineSteps").width()/2,f=n+t-11;$(this).parents(".popupContent").length>0&&$(this).is(":visible")?(i=n+t,$(this).find(".contentTimelineStep:first-child").css({marginLeft:i-22})):$(this).find(".contentTimelineStep:first-child").css("margin-left",f)}else $(this).find(".contentTimelineStep:first-child").removeAttr("style")})}function isEven(n){return n%2==0}function isOdd(n){return Math.abs(n%2)==1}function isInViewport(n){var t=n.getBoundingClientRect();return t.bottom>=0&&t.right>=0&&t.top<=(window.innerHeight||document.documentElement.clientHeight)+100&&t.left<=(window.innerWidth||document.documentElement.clientWidth)+100}function applyScroll(n,t){var r,i;if(n&&(r=0,i=$("#"+n),i&&i.length==1)){if(t){var u=i.offset().top,f=i.outerHeight(),e=$(window).height();r=u-e+f}else r=i.offset().top;$(window).scrollTop(r)}}function isValidPhone(n){return n?(n=(n+"").replace(/[\s\.]/ig,""),n.startsWith("+")&&(n=n.substring(1)),n%1==0):!1}function ensureDraggableBeforeStart(){var n;!window.ensuredDraggableBeforeStart&&"jQuery"in window&&"ui"in jQuery&&"draggable"in jQuery.ui&&(n=$.ui.draggable.prototype._mouseStart,$.ui.draggable.prototype._mouseStart=function(t,i,r){this._trigger("beforeStart",t,this._uiHash());n.apply(this,[t,i,r])},window.ensuredDraggableBeforeStart=!0)}function htmlStringToElement(n,t,i){var r,u;return n?(r=createHtmlElement("div",{innerHTML:n}),t?(u=r.children.map(function(n){return n}),r.innerHTML="",u):i?r.querySelector(i):r.children[0]):null}function getTodayDate(){var n=new Date,t=n.getDate(),i=n.getMonth(),r=n.getFullYear();return new Date(r,i,t,0,0,0,0)}function getWindowOpenSpecs(n,t){var i=0,r=0,u,f;return n&&(i=n/2),t&&(r=t/2),u=screen.height/2-i,f=screen.width/2-r,"top="+u+"px,left="+f+"px,width="+t+"px,height="+n+"px"}function showAllHiddenTabListItems(n,t){var i;n&&t&&(i=n.up(t),i)&&(n.hide(),i.querySelectorAll(".HiddenTabListItem").invoke("show"))}function focusFirstTextBox(n){var t;(n&&(t=n.querySelector("input[type=text],textarea")),t)&&(t.focus(),t.moveCursorEnd())}function mergeArrays(){var n=[];return getSubArray(arguments,0).forEach(function(t){Array.isArray(t)&&t.forEach(function(t){n.push(t)})}),n}function inputIsChecked(n){return n&&(n.checked||"hasAttribute"in n&&n.hasAttribute("checked"))?!0:!1}function ensureNumberWithinLimits(n,t,i,r){if(typeof t!="number"||typeof i!="number"||t===i)return n;if(typeof n!="number")try{n=r?parseFloat(n):parseInt(n)}catch(u){return n}return n<t?n=t:n>i&&(n=i),n}function ensureElementID(n,t){var i;if(n)return i=n.id,i||(n.id=i=t||shortGuid()),i}function splitAnd(n,t,i,r,u){var f,e,o,s;if(!n||!t)return[];if(f=typeof i=="number"?n.split(t,i):n.split(t),f.length==0||!r)return f;for(o=function(n){return typeof n!="string"||n.length==0},s=u?function(n){return o(n)||n==" "}:o,e=0;e<f.length;)s(f[e])?f.splice(e,1):e++;return f}function ensureArray(n){return n?Array.isArray(n)||n.constructor.name==="NodeList"||n.constructor.name==="HTMLCollection"?n:n?[n]:[]:[]}function getSubArray(n,t){for(var i=typeof t=="number"&&t>0?t:0,r=new Array(n.length>i?n.length-i:0),u=0;u<r.length;u++)r[u]=n[i],i++;return r}function isOfTypes(n,t){var r,u,i;for(t=ensureArray(t),r=typeof n,u=t.length,i=0;i<u;i++)if(r==t[i])return!0;return!1}function compressText(n){return n?n.replace(/\r?\n|\r|\t/igm,""):""}function htmlToTextareaValue(n){return(n+"").replace(/\<br(\s)?(\/)?\>/igm,"\n")}function textareaValueToHtml(n){return(n+"").replace(/\n/igm,"<br />")}function toggleSummaryHiddenItems(n,t){var i=n.up(".SummaryMasterContext");$(i.querySelector(".HiddenSummaryItems"))[t?"slideDown":"slideUp"]({complete:function(){i.classList.toggle("Visible",t)}})}function resetDropdown(n){var t;n&&(t=document.getElementById(n),t)&&(t.selectedIndex=0)}function ensureObjectStructure(n,t,i){var r,f,u;return t?(n||(n={}),r=t.split("."),f=r.length-1,u=function(n,t){var e=r[t];t==f?e in n||(n[e]=i):(e in n||(n[e]={}),u(n[e],t+1))},u(n,0),n):n}function toggleElementDisplay(n,t,i){n||(n=document);var r=n.querySelector(t);if(!r){console.warn("toggleElementDisplay: Element not found.");console.log(n);console.log(t);return}i==undefined&&(i=$(r).is(":visible")?!1:!0);r[i?"show":"hide"]()}function checkJsResource(n,t){typeof n==typeof Function||$.getScript(t)}function applyFixedHeader(){$(".fixedHeader")&&$(".fixedHeader").length&&$(window).scroll(function(){var n=$(window).scrollTop(),i=$(window).width(),t=$(".fixedHeader").parent().offset().top,r;n>t&&i>768?(r=$(".fixedHeader").outerHeight(),$(".fixedHeader").addClass("fixed"),$(".fixedHeader").parent().css({paddingTop:r}),n=$(window).scrollTop(),t=$(".fixedHeader").parent().offset().top,n>t&&i>768||($(".fixedHeader").removeClass("fixed"),$(".fixedHeader").parent().css({paddingTop:0}))):($(".fixedHeader").removeClass("fixed"),$(".fixedHeader").parent().css({paddingTop:0}),typeof Timeline=="object"&&typeof Timeline.updateWidth=="function"&&Timeline.updateWidth())})}function bindAnimatedScrollFromLink(n,t){n=n||".spMenu";t=t||".spContent";document.querySelectorAll(n+" > a").forEach(function(n){$(n).on("click",function(n){n.preventDefault();var r=this.getAttribute("href").replace("#",""),i=$(t+' a[id="'+r+'"]:first').offset();i&&$([document.documentElement,document.body]).animate({scrollTop:i.top},500)})})}function TableView(n,t,i){function h(){return u||(u=document.getElementById(s)),u}function e(){var n=h();return n?n.querySelector('[id="'+f+'"]'):null}function c(n){n.target.style.display="inline"}function l(n){n.target.style.width="auto";n.target.style.display="block";n.target.style.left=""}function a(n,t){var u=e(),h=null,i,l,a,r;if(u&&(h=u.up(".gridResultsTable")),!h){console.log('tabela ".gridResultsTable" nao encontrada para header = #'+f);return}var s=h.getElementsByTagName("tr"),v=u.querySelectorAll("th"),p=h.getElementsByTagName("th").length,y=v.indexOf(t.draggable.get(0).up()),c=v.indexOf(n.target);if(y!=c){for(i=0;i<s.length;i++)l=s[i].cells,a=s[i].removeChild(l[y]),c+1>=p?s[i].appendChild(a):s[i].insertBefore(a,l[c]);u&&(r="",u.querySelectorAll("[id^=oFH_]").forEach(function(n){$(n).is(":visible")&&(r!=""&&(r+=","),r+=n.getAttribute("value"))}),r!=""&&Cookie.set(o,r,365))}}var o=n,s=i||t+"ListResults",f=t+"TableHeader",u,r=e();r&&($(r).find(".ui-draggable").draggable("destroy"),$(r).find(".ui-droppable").droppable("destroy"),$(r).find(".DragElem").draggable({containment:r,helper:"clone",start:c,stop:l}),$(r).find(".DropElem").droppable({accept:".DragElem",hoverClass:"Dropping",drop:a}))}function GenerateEmailAccountPassword(n){var u="abcdefghijklmnopqrstuvwxyz",f="ABCDEFGHIJKLMNOPQRSTUVWXYZ",e="0123456789",r="",t=n/2,t=t-1,o=n-t-t;for(i=0;i<t;i++)r+=u.charAt(Math.floor(Math.random()*u.length));for(i=0;i<o;i++)r+=f.charAt(Math.floor(Math.random()*f.length));for(i=0;i<t;i++)r+=e.charAt(Math.floor(Math.random()*e.length));return r.split("").sort(function(){return.5-Math.random()}).join("")}function GeneratePasswordWithoutIdenticChars(n){var u="abcdefghkprstwxyz",f="ABCDEFGHKPRSTWXYZ",e="23456789",r="",t=n/2,t=t-1,o=n-t-t;for(i=0;i<t;i++)r+=u.charAt(Math.floor(Math.random()*u.length));for(i=0;i<o;i++)r+=f.charAt(Math.floor(Math.random()*f.length));for(i=0;i<t;i++)r+=e.charAt(Math.floor(Math.random()*e.length));return r.split("").sort(function(){return.5-Math.random()}).join("")}function createAsyncFunction(n,t){var i=n.split("."),f,r,u;if(i.length>1){for(f=i.pop(),r=window,u=0;u<i.length;u++)r=r[i[u]];return r[f].apply(r,t)}return window[i[0]].apply(i,t)}function async(n,t){window.async.f.push(function(){createAsyncFunction(n,t)})}function Dropdown(n,t){function u(n,i,r,u,f,e){this.parent=null;this.description=n;this.value=i;this.index=r;this.selected=u;this.domObject=null;this.checkboxDomObject=null;this.isHighlight=f;this.isMultiple=t.isMultiple;this.isDefaultOption=e;this.isVisible=!0}function i(n,i,r,u){this.parent=null;this.description=n;this.value=i;this.items=u?u:[];this.index=r;this.domObject=null;this.selected=!1;this.isMultiple=t.isMultiple;this.groupSelectable=t.groupSelectable;this.status=0;this.isVisible=!0;this.checkboxDomObject=null}function r(n){this.select=n;this.domObject=null;this.dropDomObject=null;this.items=[];this.totalHightlights;this.isMultiple=t.isMultiple,function(t){var e={},l=function(n,t){n in e||(e[n]=[]);e[n].push(t)},p=function(n){for(var i,t=0;t<e;t++)for(i=0;i<e[t].length;i++)if(e[t][i].getValue()==n)return e[t][i];return null},v=function(n){var i=t.findGroup(n);return i||(i=p(n)),i},r,w=function(n,u){if(r=new i(n.textContent,n.value,n.index),u||n.getAttribute("data-parent")?u?u.addItem(r):l(n.getAttribute("data-parent"),r):t.addItem(r),r.getValue()in e){for(var f=0;f<e[r.getValue()].length;f++)r.addItem(e[r.getValue()][f]);delete e[r.getValue()]}},y=function(n,i,f){var o=new u(n.textContent,n.value,n.index,n.selected,!i&&f,n.hasAttribute("data-default-option")),e;i?i.addItem(o):(e=n.getAttribute("data-parent"),e?(r&&r.getValue()==e||(r=v(e)),r?r.addItem(o):l(e,o)):t.addItem(o))},s,f,h,o,a,c;for(t.totalHightlights=n.getAttribute("data-total-highlights"),t.totalHightlights=isNaN(t.totalHightlights)?-1:parseInt(t.totalHightlights),s=0;s<n.children.length;s++)if(f=n.children[s],f.tagName=="OPTGROUP"){for(h=new i(f.label,""),o=0;o<f.children.length;o++)f.children[o].tagName=="OPTION"&&f.children[o].getAttribute("data-type")=="group"?w(f.children[o],h):f.children[o].tagName=="OPTION"&&y(f.children[o],f.children[o].getAttribute("data-parent")?null:h);t.addItem(h)}else if(f.tagName=="OPTION"&&f.getAttribute("data-type")=="group"){if(r=new i(f.textContent,f.value),f.getAttribute("data-parent")?(a=v(f.getAttribute("data-parent")),a?a.addItem(r):l(f.getAttribute("data-parent"),r)):t.addItem(r),r.getValue()in e){for(c=0;c<e[r.getValue()].length;c++)r.addItem(e[r.getValue()][c]);delete e[r.getValue()]}}else f.tagName=="OPTION"&&y(f,null,t.totalHightlights>=s);t.render(n.parentNode);t.select.style.display="none";t.select.setAttribute("data-dropdown","true")}(this)}if(n&&n.tagName=="SELECT"&&n.getAttribute("data-dropdown")!="true"){var t=t||{applyText:"Apply"};t.isMultiple=n.hasAttribute("multiple");t.groupSelectable=n.hasAttribute("data-group-selectable");t.isSearchable=t.isMultiple;this.innerDropdown=null;u.prototype.getParent=function(){return this.parent};u.prototype.setParent=function(n){this.parent&&this.parent.removeItem&&this.parent.removeItem(this);this.parent=n};u.prototype.getDescription=function(){return this.description};u.prototype.getValue=function(){return this.value};u.prototype.getIndex=function(){return this.index};u.prototype.toggleState=function(n){this.selected=typeof n=="boolean"?n:!this.selected;this.updateDom()};u.prototype.isSelected=function(){return this.selected};u.prototype.getDomObject=function(){return this.domObject};u.prototype.showDom=function(){this.isVisible=!0;this.domObject&&(this.domObject.style.display="block")};u.prototype.hideDom=function(){this.isVisible=!1;this.domObject&&(this.domObject.style.display="none")};u.prototype.updateDom=function(){this.domObject&&(this.domObject.setAttribute("data-selected",this.isSelected()),this.checkboxDomObject&&(this.checkboxDomObject.checked=this.selected))};u.prototype.render=function(){var i=this,n=document.createElement("DIV"),r,u;return n.classList.add("dSelectLine"),this.isMultiple&&(r=document.createElement("INPUT"),r.type="checkbox",r.checked=this.isSelected(),EventHandler.addListener(r,"click",function(r){r.stopPropagation();i.toggleState();i.parent.childrenChanged(r);t.clickCallback&&typeof t.clickCallback=="function"&&t.clickCallback(n)}),n.appendChild(r),this.checkboxDomObject=r),u=document.createElement(this.isHighlight?"STRONG":"SPAN"),u.textContent=this.getDescription(),n.appendChild(u),n.setAttribute("data-index",this.getIndex()),EventHandler.addListener(n,"click",function(r){r.stopPropagation();i.isMultiple||i.parent.clearAllSelected(r);i.toggleState();r.dropdownClose=!0;i.parent.childrenChanged(r);t.clickCallback&&typeof t.clickCallback=="function"&&t.clickCallback(n)}),n.setAttribute("data-type","item"),n.setAttribute("data-value",this.getValue()),n.setAttribute("data-index",this.getIndex()),n.setAttribute("data-description",this.getDescription()),n.setAttribute("title",this.getDescription()),this.isSelected()&&n.setAttribute("data-selected","true"),this.domObject=n,n};i.prototype.getParent=function(){return this.parent};i.prototype.setParent=function(n){this.parent&&this.parent.removeItem&&this.parent.removeItem(this);this.parent=n};i.prototype.getDescription=function(){return this.description};i.prototype.setDescription=function(n){this.description=n};i.prototype.getValue=function(){return this.value};i.prototype.getIndex=function(){return this.index};i.prototype.setValue=function(n){this.value=n};i.prototype.getItems=function(){return this.items};i.prototype.setItems=function(n){this.options=n};i.prototype.addItem=function(n){n.setParent&&n.setParent(this);this.items.push(n)};i.prototype.removeItem=function(n){n.setParent&&n.setParent(null);this.items.pop(n)};i.prototype.getDomObject=function(){return this.domObject};i.prototype.search=function(n){for(var u,r=!1,t=0;t<this.items.length;t++)this.items[t]instanceof i?this.items[t].search(n)&&(r=!0):!n||matchSearchText(n,this.items[t].getDescription())?(this.items[t].showDom(),r=!0):this.items[t].hideDom();return u=this.parent instanceof i&&this.getItems()&&this.getItems().length>0,u||(this.domObject.style.display=r||n&&matchSearchText(n,this.getDescription())?"block":"none"),r};i.prototype.selectedIDs=function(){var t=[],r=this.getValue(),n;if(this.groupSelectable&&this.status==2&&r&&r!="0")return t.push(this.getValue()),t;for(n=0;n<this.items.length;n++)this.items[n]instanceof i?t=t.concat(this.items[n].selectedIDs()):this.items[n].isSelected()&&t.push(this.items[n].getValue());return t};i.prototype.selectedText=function(){var t=[],r,n;if(this.groupSelectable&&this.status==2)return t.push(this.getDescription()),t;for(r=this.getItems(),n=0;n<r.length;n++)r[n]instanceof i?t=t.concat(r[n].selectedText()):r[n].isSelected()&&t.push(r[n].getDescription());return t};i.prototype.isSelected=function(){return this.status==2||this.status==1};i.prototype.allChildsSelected=function(){var t,i,n;if(!this.isMultiple)return!1;for(t=!0,i=this.getItems(),n=0;n<i.length;n++)i[n].isSelected()||(t=!1);return t};i.prototype.anyChildSelected=function(n){if(!this.isMultiple)return!1;for(var t=0;t<this.items.length;t++)if((!n||this.items[t].isVisible)&&this.items[t].isSelected())return!0;return!1};i.prototype.anyChildDeselected=function(n){if(!this.isMultiple)return!1;for(var t=0;t<this.items.length;t++)if((!n||this.items[t].isVisible)&&!this.items[t].isSelected())return!0;return!1};i.prototype.childrenChanged=function(n){this.isMultiple&&(this.status=this.allChildsSelected()?2:this.anyChildSelected()?1:0,this.updateDom());this.parent.childrenChanged(n)};i.prototype.toggleState=function(n){var t,i,r;if(typeof n=="boolean"){for(t=0;t<this.items.length;t++)this.items[t].toggleState(n);this.status=n?2:0;this.childrenChanged();return}i=this;r=function(n){for(var t=0;t<i.items.length;t++)i.items[t].isVisible&&i.items[t].toggleState(n)};this.status==1?r(this.anyChildDeselected(!0)):r(this.status==0);this.childrenChanged()};i.prototype.clearAllSelected=function(n){this.parent.clearAllSelected(n)};i.prototype.updateDom=function(){if(this.domObject){switch(this.status){case 0:this.checkboxDomObject.checked=!1;this.checkboxDomObject.indeterminate=!1;break;case 1:this.checkboxDomObject.checked=!1;this.checkboxDomObject.indeterminate=!0;break;case 2:this.checkboxDomObject.checked=!0;this.checkboxDomObject.indeterminate=!1;this.checked=!0}this.domObject.setAttribute("data-selected",this.checked)}};i.prototype.render=function(){var e=this,s=this.parent instanceof i&&this.getItems()&&this.getItems().length>0,n=document.createElement("DIV"),t=document.createElement("DIV"),u,h,c,o,f,r;for(s?(t.classList.add("dSelectLine"),t.classList.add("multiLevel"),n.classList.add("dSelectLineGroup"),n.style.display="none"):(t.classList.add("dSelectHeader"),n.classList.add("dSelectDropGroup"),n.setAttribute("data-type","group"),n.appendChild(t)),this.isMultiple&&(u=document.createElement("INPUT"),u.type="checkbox",EventHandler.addListener(u,"click",function(n){n.stopPropagation();e.toggleState();e.parent.childrenChanged(n)}),t.appendChild(u),this.checkboxDomObject=u),h=document.createElement("SPAN"),h.textContent=this.getDescription(),t.appendChild(h),c=this.getItems(),o=0;o<c.length;o++)f=c[o].render(),Array.isArray(f)?(n.appendChild(f[0]),n.appendChild(f[1])):n.appendChild(f);return s&&(r=document.createElement("I"),r.classList.add("icon-adicionar"),EventHandler.addListener(r,"click",function(t){t.stopPropagation();r.classList.contains("icon-adicionar")?(r.classList.remove("icon-adicionar"),r.classList.add("icon-menos"),n.style.display="block"):(r.classList.remove("icon-menos"),r.classList.add("icon-adicionar"),n.style.display="none")}),t.appendChild(r)),this.getIndex()&&n.setAttribute("data-index",this.getIndex()),this.selected=this.allChildsSelected(),EventHandler.addListener(t,"click",function(n){n.stopPropagation();e.toggleState();n.dropdownClose=!0;e.parent.childrenChanged(n)}),this.domObject=n,this.isMultiple&&(this.status=this.allChildsSelected()?2:this.anyChildSelected()?1:0,this.updateDom()),s?[t,n]:n};i.prototype.find=function(n){for(var r,t=0;t<items.length;t++){if(this.items[t].getValue()==n)return this.items[t];if(this.items[t]instanceof i&&(r=this.items[t].find(n),r))return r}};r.prototype.getDomObject=function(){return this.domObject};r.prototype.getDefaultItem=function(){};r.prototype.addItem=function(n){n.setParent&&n.setParent(this);this.items.push(n)};r.prototype.removeItem=function(n){n.setParent&&n.setParent(null);this.options.pop(n)};r.prototype.getItems=function(){return this.items};r.prototype.findGroup=function(n,t){if(!n)return null;t||(t=this.items);for(var r=0;r<t.length;r++)if(t[r]instanceof i)return t[r].getValue()==n?t[r]:this.findGroup(n,t[r].getItems());return null};r.prototype.search=function(n){for(var t=0;t<this.items.length;t++)this.items[t]instanceof i?this.items[t].search(n):!n||matchSearchText(n,this.items[t].getDescription())?this.items[t].showDom():this.items[t].hideDom()};r.prototype.updateDescription=function(){for(var e,r,o,f,u=[],s,t=this.getItems(),n=0;n<t.length;n++)t[n]instanceof i?u=u.concat(t[n].selectedText()):t[n].isSelected()&&(e=t[n].getDescription(),t[n].isDefaultOption&&(s=e),u.push(e));r=u.join(", ");r.length==0||r==s?(o=this.domObject.querySelector(".dSelectDefault"),o&&(r=o.textContent),this.domObject.classList.remove("edited")):this.domObject.classList.add("edited");f=this.domObject.querySelector(".dSelectVal");f&&(f.textContent=r,f.title=r)};r.prototype.childrenChanged=function(n){this.updateDescription();this.updateDomSelect();n&&n.dropdownClose===!0&&this.close()};r.prototype.close=function(){if(this.domObject.classList.contains("active")&&typeof t.onClose=="function")t.onClose(this.domObject);this.domObject.classList.remove("active")};r.prototype.updateDropWidth=function(){this.domObject&&this.dropDomObject&&(this.dropDomObject.style.width=this.domObject.offsetWidth+"px")};r.prototype.clearAllSelected=function(n,t){for(var i=0;i<this.items.length;i++)this.items[i].toggleState(!1);t===!0&&this.childrenChanged(n)};r.prototype.render=function(i){var r=this,o=document.createElement("DIV"),a,y,f,v,p,w,b,s,h,c,l,e,k;for(o.classList.add("dSelect"),a=document.createElement("DIV"),o.appendChild(a),a.classList.add("dSelectBtn"),EventHandler.addListener(a,"click",function(){var n,i;if(r.domObject.classList.toggle("active"),r.domObject.classList.contains("active")&&(r.updateDropWidth(),n=r.domObject.querySelector("input"),n&&(n.value="",r.search(""),n.focus()),i=r.domObject.querySelector(".dSelectDropList"),i&&(i.scrollTop=0),typeof t.onOpen=="function"))t.onOpen(r.domObject)}),y=document.createElement("SPAN"),y.classList.add("dSelectVal"),a.appendChild(y),f=document.createElement("DIV"),f.classList.add("dSelectDrop"),t.isSearchable&&f.classList.add("searchSelectDrop"),o.appendChild(f),this.dropDomObject=f,this.isMultiple&&(v=document.createElement("DIV"),v.classList.add("dSelectSearch"),f.appendChild(v),p=document.createElement("INPUT"),p.type="text",v.appendChild(p),EventHandler.addListener(p,"keyup",function(){r.search(this.value)}),w=document.createElement("SPAN"),w.classList.add("input-value"),v.appendChild(w),b=document.createElement("I"),b.classList.add("icon-pesquisa"),w.appendChild(b)),s=document.createElement("DIV"),s.classList.add("dSelectDropList"),f.appendChild(s),h=0;h<this.items.length;h++)c=this.items[h],c instanceof u&&h==0?(y.textContent=c.getDescription(),l=document.createElement("DIV"),l.classList.add("dSelectDefault"),l.textContent=c.getDescription(),l.setAttribute("data-description",c.getDescription()),EventHandler.addListener(l,"click",function(n){n.dropdownClose=!0;r.clearAllSelected(n,!0);n.stopPropagation()}),s.appendChild(l)):s.appendChild(c.render()),this.totalHightlights==h&&s.appendChild(document.createElement("HR"));if(this.isMultiple&&(e=document.createElement("A"),e.classList.add("blueLink"),e.href="javascript:void(0);",EventHandler.addListener(e,"click",function(){r.close()}),f.appendChild(e),k=document.createElement("I"),k.classList.add("icon-check"),e.appendChild(k),e.innerHTML+=t.applyText),EventHandler.addListener(document,"click",function(n){r.domObject==n.target||r.domObject.contains(n.target)||r.close()}),EventHandler.addListener(window,"resize",function(){r.updateDropWidth()}),this.domObject=o,!i||!(i instanceof HTMLElement))return o;i.appendChild(o);this.updateDropWidth();this.updateDescription();EventHandler.addListener(n,"Dropdown:Reset",function(n){r.clearAllSelected(n,!0)});EventHandler.addListener(n,"Dropdown:Destroy",function(){r.destroy()});EventHandler.addListener(n,"Dropdown:SetDefault",function(n){n.detail&&n.detail.value&&r.setDefault(n.detail.value)})};r.prototype.updateDomSelect=function(){for(var r,u,f,t=[],n=0;n<this.items.length;n++)this.items[n]instanceof i?t=t.concat(this.items[n].selectedIDs()):this.items[n].isSelected()&&t.push(this.items[n].getValue());if(this.select){for(r=0;r<this.select.options.length;r++)u=this.select.options[r],u.selected=t.indexOf(u.value)>-1;f=document.createEvent("HTMLEvents");f.initEvent("change",!1,!0);this.select.dispatchEvent(f)}};r.prototype.destroy=function(){this.domObject.parentElement.removeChild(this.domObject);this.select.style.display="block"};r.prototype.setDefault=function(n){var i,t;for(this.clearAllSelected(),i=[],t=0;t<this.items.length;t++)this.items[t]instanceof u&&this.items[t].getValue()==n&&i.push(this.items[t]);for(t=0;t<i.length;t++)i[t].toggleState(!0);this.updateDescription()};r.prototype.find=function(n){for(var r,t=0;t<this.items.length;t++){if(this.items[t].getValue()==n)return this.items[t];if(this.items[t]instanceof i&&(r=this.items[t].find(n),r))return r}};r.prototype.toggleValue=function(n,t){var i=this.find(n);i&&(i.toggleState(t),this.childrenChanged())};this.innerDropdown=new r(n)}}function CalendarDate(n,t,i,r,u,f,e){this.date=new Date(Date.UTC(n,t-1));this.date.setUTCDate(i);this.date.setUTCHours(r||0,u||0,f||0);this.year=this.date.getUTCFullYear();this.month=this.date.getUTCMonth()+1;this.day=this.date.getUTCDate();this.hour=this.date.getUTCHours();this.minute=this.date.getUTCMinutes();this.second=this.date.getUTCSeconds();this.PM=e||"";this.value=this.date.getTime();this.isCalendarDate=!0}function CalendarDateSelect(n,t,i){var f,r,u;if(this.field=document.getElementById(n),this.field){f=this.field.up(".CalendarDate").querySelector(".calendar_date_select");f&&(f.innerHTML="");this.options=t||{};this.fieldid=t.id;this.dateFormat=t.dateFormat||"yyyy-MM-dd";this.onFieldChanged();this.field.setAttribute("initval",this.date.toString(this.dateFormat));t.defaultToNow&&this.date.date.valueOf()==new Date("1/1/1901").valueOf()&&(this.setDate(CalendarDate.parse("",this.dateFormat)),this.setCursor(this.date));this.createElement();document.getElementById(this.fieldid).CalendarDate=this;this._onEditChe=this.onFieldEdit.bind(this);r=this.fieldid.replace("[","\\[").replace("]","\\]");$("#"+r).off("blur",this._onEditChe);$("#"+r).on("blur",this._onEditChe);$("#"+r).on("click",function(){$("#"+r).blur();var n=this.field.up(".CalendarDate").querySelector("a.CalendarBtn");(function(){n.focus()}).defer();$(n).trigger("click")}.bindAsEventListener(this));this._ToggleHandler=null;document.getElementById(this.fieldid).getAttribute("disabled")&&(u=this.element.up(".CalendarDate").querySelector(".CalendarBtn"),u.ondisabledclick=u.onclick,u.onclick=null);this.field.up(".popupBox")?(this.options.allowAdjustOverflow&&this.element.setAttribute("data-allow-adj-overflow","1"),this.options.onCalendarOpen=function(n,t){isMobile(window)||t.getAttribute("data-allow-adj-overflow")!="1"||Popup.adjustOverflow(!1)},this.options.onCalendarClose=function(n,t){isMobile(window)||t.getAttribute("data-allow-adj-overflow")!="1"||Popup.adjustOverflow(!0)}):this.field.up(".CalendarPositionHandler")&&(this.options.onCalendarOpen=function(n,t){var u;if(!isMobile(window)){if(u=t.up(".CalendarPositionHandler"),!t||!u)return;if(t.up().classList.contains("active")){var i=t.up(),r=i?$(i.querySelector(".listItemActionDrop")):null,f=t.viewportOffset(),e=u.viewportOffset(),o=f.top,c=$(t).height(),s=r&&r.length>0?r.outerHeight():0,h=e.top,l=o-h,a=o-h+c+s,v=$(u).height()-($(u.querySelector("div")).outerHeight()+20);a>v&&l>s&&i&&i.classList.add("bottom");var y=f.left,p=e.left,w=r&&r.length>0?r.outerWidth():0,b=y-p;b<w&&i&&i.classList.add("left")}else t.up().classList.remove("left","right","bottom")}});typeof i=="function"&&i()}}var EventHandler=function(){var n={},t=function(t,i,r){n.hasOwnProperty(t)||(n[t]={});n[t].hasOwnProperty(i)||(n[t][i]=[]);n[t][i].push(r)},t=function(t,i,r){n.hasOwnProperty(t)||(n[t]={});n[t].hasOwnProperty(i)||(n[t][i]=[]);n[t][i].push(r)};return{addListener:function(n,i,r){n.addEventListener?n.addEventListener(i,r,!1):n.attachEvent?n.attachEvent("on"+i,r):n["on"+i]=r;t(n,i,r)},removeListener:function(n,t,i){n.removeEventListener?n.removeEventListener(t,i,!1):n.detachEvent?n.detachEvent("on"+t,i):n["on"+t]=null},removeAllListeners:function(t,i){var r,u,f;if(n.hasOwnProperty(t)&&(r=i?n[t].hasOwnProperty(i)?[i]:[]:Object.getOwnPropertyNames(n[t]),r.length>0))for(u=0;u<r.length;u++)if(n[t].hasOwnProperty(r[u]))for(f=0;f<n[t][r[u]].length;f++)EventHandler.removeListener(t,i,n[t][r[u]][f])},trigger:function(n,t,i){var u=typeof i=="boolean"?i:!0,r;document.createEvent?(r=document.createEvent("HTMLEvents"),r.initEvent(t,u,!0)):document.createEventObject&&(r=document.createEventObject(),r.eventType=t,r.cancelBubble=!u);r.eventName=t;n.dispatchEvent?n.dispatchEvent(r):n.fireEvent&&htmlEvents["on"+t]?n.fireEvent("on"+r.eventType,r):n[t]?n[t]():n["on"+t]&&n["on"+t]()}}}(),EventKeys,BusinessObject,IsEscKeyBinded,ExportContentTypes,RTCPeerConnection,HttpUtility,HtmlUtility;EventKeys=Object.freeze({Enter:13,Esc:27,Space:32,Backspace:8,ArrowLeft:37,ArrowRight:39});BusinessObject=Object.freeze({Undefined:0,Realestate:1,Vehicle:5,ClientProduct:17});window.post=function(n,t,i,r){var u,e,f;r=r||"post";u=document.createElement("form");u.setAttribute("method",r);u.setAttribute("action",n);i&&u.setAttribute("target",i);typeof t=="string"&&(t=HttpUtility.queryToObject(t,/%[0-9a-f]{2}/i.test(t)));for(e in t)t.hasOwnProperty(e)&&(f=document.createElement("input"),f.setAttribute("type","hidden"),f.setAttribute("name",e),f.setAttribute("value",t[e]),u.appendChild(f));document.body.appendChild(u);u.submit();document.body.removeChild(u)};window.onunload=function(){};window.onerror=function(){window&&"Loading"in window&&"hide"in Loading&&typeof Loading.hide=="function"&&Loading.hide()};window.requireClass=function(n){window.__requireClass=function(n){if(n&&!(n in window))throw new Error('Classe JS nao carregada: "'+n+'".');};async("__requireClass",[n])};IsEscKeyBinded=!1;ExportContentTypes=["application/octet-stream","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/pdf"],function(n){n.prototype.join||(n.prototype.join=Array.prototype.join);n.prototype.replace||(n.prototype.replace=function(n,t){n&&t&&(this.contains(n)&&this.remove(n),this.add(t))})}(DOMTokenList),function(n){function r(n){var t,i=n.ownerDocument.defaultView,r;return i&&i.opener||(i=window),r=i.getComputedStyle(n),r&&(t=r.getPropertyValue("display")||r.display),t!==undefined?t+"":t}function t(n,t,i){while(n=n[t])if(n.nodeType===1&&(!i||typeof n.matches!="function"||n.matches(i)))return n;return null}n.prototype.matches||(n.prototype.matches=n.prototype.matchesSelector||n.prototype.mozMatchesSelector||n.prototype.msMatchesSelector||n.prototype.oMatchesSelector||n.prototype.webkitMatchesSelector||function(n){for(var i=(this.document||this.ownerDocument).querySelectorAll(n),t=i.length||0;--t>=0&&i[t]!==this;);return t>-1});var i={up:function(n){return n?t(this,"parentNode",n):this.parentNode},next:function(n){return t(this,"nextSibling",n)},previous:function(n){return t(this,"previousSibling",n)},remove:function(){var n=this.parentElement;n&&n.removeChild(this)},toggleClass:function(n,t){this.classList.toggle(n,t)},toggleClassName:function(n,t){t===undefined?this.classList.toggle(n):this.classList.toggle(n,t?!0:!1)},moveCursorEnd:function(){var n=this,i=n.nodeName.toLowerCase(),t;(i!="div"||n.getAttribute("contenteditable")&&n.getAttribute("contenteditable")=="true")&&i=="input"&&(n.createTextRange?(t=n.createTextRange(),t.move("character",n.value.length),t.select()):n.setSelectionRange&&n.setSelectionRange(n.value.length,n.value.length))},show:function(){var n;(this.style.display=="none"&&(this.style.display=""),this.style.display==""&&r(this)=="none")&&(n=this.ownerDocument.createElement(this.nodeName),this.ownerDocument.body.appendChild(n),this.style.display=r(n),this.ownerDocument.body.removeChild(n))},hide:function(){this.style.display!="none"&&(this.style.display="none")},html:function(n){while(this.firstChild)this.removeChild(this.firstChild);typeof n=="string"?this.innerHTML=n:typeof n=="object"&&this.appendChild(n)},queryChildren:function(n){var t=this;return t.children?n?t.children.filter(function(t){return t&&t.matches(n)}):t.children:[]},queryChildrenLast:function(n){var t=this.queryChildren(n);return t.length?t[t.length-1]:null},viewportOffset:function(){var t=0,i=0,r=document.body,n=this;do if(t+=n.offsetTop||0,i+=n.offsetLeft||0,n.offsetParent==r&&n.style.position=="absolute")break;while(n=n.offsetParent);n=this;do n!=r&&(t-=n.scrollTop||0,i-=n.scrollLeft||0);while(n=n.parentNode);return{left:Math.round(i),top:Math.round(t)}},hasParent:function(n){var t;if(!n)return!1;for(t=this;t=t.parentNode;)if(t.nodeType!==1&&n==t)return!0;return!1},querySelectorLast:function(n){var t;return(n&&(t=this.querySelectorAll(n)),!t||!t.length)?null:t[t.length-1]},queryCheckedInput:function(n,t){var r,f,i,u;if(n&&(r=this.querySelectorAll(n)),f=[],r&&r.length>0)for(u=0;u<r.length;u++)if(i=r[u],i&&i.nodeName=="INPUT"&&(i.type=="checkbox"||i.type=="radio")&&i.checked){if(t)return i;f.push(i)}return t?null:f},siblings:function(n){for(var i=[],t=this.previous(n);t;)i.push(t),t=t.previous(n);for(i.reverse(),t=this.next(n);t;)i.push(t),t=t.next(n);return i},clearChildren:function(){for(var n=this.childNodes;n.length>0;)n[0].remove();return this},queryChildTextNodes:function(){return this.childNodes.filter(function(n){return n&&n.nodeName=="#text"})},queryLastChildTextNode:function(){var n=this.queryChildTextNodes();return n.length?n[n.length-1]:null},queryLastChildTextContent:function(){var n=this.queryLastChildTextNode();return n?n.nodeValue:""},containsNode:function(n){var t,r,i;if(!n)return!1;if(typeof n=="string")try{return this.querySelector(n)!=null}catch(u){return!1}else if("contains"in this&&typeof this.contains=="function")try{return this.contains(n)}catch(u){return!1}else{if(t=this.children,!t||t.length==0)return!1;for(i=0;i<t.length;i++)if(r=t[i],r&&r===n)return!0;return!1}},appendMany:function(n){var t;if(n==undefined||n==null){console.log('Element.prototype.appendMany: param "items" is null or undefined.');return}if(!Array.isArray(n)&&(!("constructor"in n)||n.constructor.name!="NodeList"&&n.constructor.name!="HTMLCollection")){console.log('Element.prototype.appendMany: param "items" is not a valid Array or NodeList or HTMLCollection.');return}t=this;n.forEach(function(n){n&&t.appendChild(n)})},update:function(n){var i,t;typeof n!="undefined"&&n!=null&&((typeof n=="string"&&(t=htmlStringToElement(n,!0),n=t&&t instanceof Element?t:document.createTextNode(n)),i=this,i.clearChildren(),isObject(n)&&isEmptyObject(n))||ensureArray(n).forEach(function(n){i.appendChild(n)}))},tryAddAfter:function(n){var t=this,i;if(!t||!n){console.log("Element.prototype.tryAddAfter: missing required elements.");console.log("supplied target:");console.log(t||typeof t);console.log("supplied newNode:");console.log(n||typeof n);return}i=t.next();i?t.up().insertBefore(n,i):t.up().appendChild(n)},replaceWith:function(){"use-strict";var t=this.parentNode,i=arguments.length,n;if(t)for(i||t.removeChild(this);i--;)n=arguments[i],typeof n!="object"?n=this.ownerDocument.createTextNode(n):n.parentNode&&n.parentNode.removeChild(n),i?t.insertBefore(n,this.previousSibling):t.replaceChild(n,this)},addClassName:function(){this.classList.add.apply(this.classList,getSubArray(arguments,0))},removeClassName:function(){this.classList.remove.apply(this.classList,getSubArray(arguments,0))},replaceClassName:function(n,t){this.classList.replace.apply(this.classList,[n,t])},setValue:function(n){"value"in this&&(this.value=n||"")},changeCheckState:function(n){"checked"in this&&(this.checked=n?!0:!1)},getMatchedCssClass:function(n,t){var u,f,i,r;if(!n)return t?"":[];for(u=this,f=[],i=0;i<u.classList.length;i++)if(r=u.classList[i],r.match(n)){if(t)return r;f.push(r)}return t?"":f}};forEachProp(i,function(t){t in n.prototype||(n.prototype[t]=i[t]);t in n||(n[t]=function(n){if(n)return i[t].apply(n,getSubArray(arguments,1))})})}(Element),function(n){n.prototype.find||(n.prototype.find=function(n){var i=Object(this),f=i.length>>>0,t,u,r;if(typeof n!="function")throw new TypeError("match must be a function");for(u=arguments[1],t=0;t<f;){if(r=i[t],n.call(u,r,t,i))return r;t++}return undefined});n.prototype.findIndex||(n.prototype.findIndex=function(n){var i=Object(this),f=i.length>>>0,t,r,u;if(typeof n!="function")throw new TypeError("match must be a function");for(r=arguments[1],t=0;t<f;){if(u=i[t],n.call(r,u,t,i))return t;t++}return-1});n.prototype.pluck=function(n){for(var i=[],t=0;t<this.length;++t)i.push(this[t][n]);return i};n.prototype.remove=function(n){var t=this,i;return n?(i=typeof n=="function"?t.findIndex(n):t.findIndex(function(t){return t===n}),i>-1)?t.splice(i,1).length>0:!1:!1};n.prototype.first||(n.prototype.first=function(){var n=this;return n.length>0?n[0]:null});n.prototype.map||(n.prototype.map=function(n){var f,r,t,i,u,e,o;if(this==null)throw new TypeError("this is null or not defined");if(i=Object(this),u=i.length>>>0,typeof n!="function")throw new TypeError(n+" is not a function");for(arguments.length>1&&(f=arguments[1]),r=new Array(u),t=0;t<u;)t in i&&(e=i[t],o=n.call(f,e,t,i),r[t]=o),t++;return r});n.prototype.pushUnique||(n.prototype.pushUnique=function(n){n!=null&&n!=undefined&&this.indexOf(n)==-1&&this.push(n)});n.prototype.last||(n.prototype.last=function(n){var i,r,t;if(!this||!this.length)return undefined;if(i=this.length,r=i-1,typeof n=="function"){for(t=i;t>0;t--)if(n(this[t]))return this[t];return undefined}return this[r]})}(Array),function(n){n.prototype.strip=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")};n.prototype.toUTF8Base=function(){return this.replace(/[\u00C0-\u00C6]|[\u00E0-\u00E6]/g,"a").replace(/[\u00C7\u00E7]/g,"c").replace(/[\u00C8-\u00CB]|[\u00E8-\u00EB]/g,"e").replace(/[\u00EC-\u00EF]/g,"i").replace(/[\u00D0]/g,"d").replace(/[\u00D1\u00F1]/g,"n").replace(/[\u00D2-\u00D6]|[\u00F2-\u00F6]/g,"o").replace(/[\u00D9-\u00DC]|[\u00F9-\u00FC]/g,"u").replace(/[\u00FD\u00FF]/g,"y")};n.prototype.format=function(){var n=arguments;return this.replace(/{(\d+)}/g,function(t,i){return typeof n[i]!="undefined"?n[i]:t})};n.prototype.trimChar=function(n){var t=this;return t=t.trimStartChar(n),t.trimEndChar(n)};n.prototype.trimStartChar=function(n){var t=this;return n?t.startsWith(n)?t.substring(n.length):t.substring(0):t.trimStart()};n.prototype.trimEndChar=function(n){var t=this;return n?t.endsWith(n)?t.substring(0,t.length-n.length):t.substring(0):t.trimEnd()};n.prototype.toTitleCase=function(){var t=this,n=[];return t.split(" ").forEach(function(t){for(var u=t.length,r="",i=0;i<u;i++)r+=i==0?t[i].toUpperCase():t[i].toLowerCase();n.push(r)}),n.join(" ")};n.prototype.toIntList||(n.prototype.toIntList=function(n){var t=this;return t?(n||(n=","),t.split(n).map(function(n){return parseInt(n)}).filter(function(n){return typeof n=="number"&&!isNaN(n)})):[]})}(String),function(n){var t=Array.prototype.slice;n.prototype.lazyDo=function(n){var i=this,r=t.call(arguments,1);return n=n*1e3,window.setTimeout(function(){return i.apply(i,r)},n)};n.prototype.defer=function(){var n=this,t=updateArray([.01],arguments);return n.lazyDo.apply(this,t)};n.prototype.bindAsEventListener=function(n){var i=this,r=t.call(arguments,1);return function(t){var u=updateArray([t||window.event],r);return i.apply(n,u)}}}(Function),function(n){n.prototype.forEach=n.prototype.forEach||Array.prototype.forEach;n.prototype.indexOf||(n.prototype.indexOf=Array.prototype.indexOf);n.prototype.find||(n.prototype.find=Array.prototype.find);n.prototype.findIndex||(n.prototype.findIndex=Array.prototype.findIndex);n.prototype.filter||(n.prototype.filter=Array.prototype.filter);n.prototype.slice||(n.prototype.slice=Array.prototype.slice);n.prototype.any||(n.prototype.any=function(n){return this.findIndex(n)>-1});n.prototype.first||(n.prototype.first=Array.prototype.first);n.prototype.invoke||(n.prototype.invoke=function(n){var r,u,t,i;n&&(r=this,u=getSubArray(arguments,1),t=splitAnd(n,".",null,!0),i=t.pop(),r.forEach(function(n){for(var r=n,f=0;f<t.length;f++)if(t[f]in r)r=r[t[f]];else break;typeof r[i]=="function"&&r[i].apply(r,u)}))});n.prototype.map||(n.prototype.map=Array.prototype.map)}(NodeList),function(n){n.prototype.find||(n.prototype.find=Array.prototype.find);n.prototype.findIndex||(n.prototype.findIndex=Array.prototype.findIndex);n.prototype.forEach||(n.prototype.forEach=Array.prototype.forEach);n.prototype.first||(n.prototype.first=Array.prototype.first);n.prototype.map||(n.prototype.map=Array.prototype.map);n.prototype.filter||(n.prototype.filter=Array.prototype.filter)}(HTMLCollection),function(n){n.querySelectorLast||(n.querySelectorLast=function(n){var t=null;return(n&&(t=this.querySelectorAll(n)),!t||t.length==0)?null:t[t.length-1]})}(document);ajaxRequest.StatusType=Object.freeze({GenericError:0,Success:1,Handled:2,Redirect:3});var LazyMediaHandler=function(){return{init:function(){EventHandler.addListener(document,"load",LazyMediaHandler.lazyLoad);EventHandler.addListener(document,"scroll",LazyMediaHandler.lazyLoad);EventHandler.addListener(window,"resize",LazyMediaHandler.lazyLoad);LazyMediaHandler.lazyLoad()},lazyLoad:function(){var n=document.getElementsByClassName("lazy"),f,i,r,u,t;if(n&&n.length>0)for(f=isMobile(window),t=0;t<n.length;t++)isInViewport(n[t])&&(f?(i=n[t].getAttribute("data-mobile-src")||n[t].getAttribute("data-src"),r="data-loaded-mobile",u="data-loaded-desktop"):(i=n[t].getAttribute("data-src"),r="data-loaded-desktop",u="data-loaded-mobile"),i&&n[t].getAttribute(r)!="1"&&(n[t].src=i,(n[t].hasAttribute("data-error-src")||n[t].hasAttribute("data-alt-src"))&&(n[t].onerror=function(){LazyMediaHandler.onerror(this,this.getAttribute("data-error-src"),this.getAttribute("data-alt-src"))}),n[t].setAttribute(r,"1"),n[t].setAttribute(u,"0")))},onerror:function(n,t,i){i?(n.src=i,n.onerror=function(){LazyMediaHandler.onerror(n,t)}):t?(n.src=t,n.onerror=function(){LazyMediaHandler.onerror(n)}):(n.onerror=null,n.hasAttribute("data-error-class")&&(n.classList.add(n.getAttribute("data-error-class")),n.removeAttribute("data-error-class")))}}}(),Overlay=function(){function t(n,t){setSelectionRange(n,t,t)}var n;return{init:function(){n=document.querySelectorAll('input[type="text"],textarea');for(var t=0;t<n.length;t++)n[t].getAttribute("data-overlay")&&!n[t].getAttribute("data-overlay-active")&&(EventHandler.addListener(n[t],"keydown",function(){Overlay.onKeyDown(this)}),EventHandler.addListener(n[t],"paste",function(){Overlay.onKeyDown(this)}),EventHandler.addListener(n[t],"keyup",function(){Overlay.onKeyUp(this)}),EventHandler.addListener(n[t],"focus",function(){Overlay.onFocus(this)}),n[t].setAttribute("data-overlay-active","1"),n[t].getAttribute("data-overlay")==n[t].value&&n[t].classList.add("greyText"))},onKeyDown:function(n){n.nodeName==="INPUT"?n.value==n.getAttribute("data-overlay")&&(n.value="",n.classList.remove("greyText")):(n.innerHTML==n.getAttribute("data-overlay")||n.value==n.getAttribute("data-overlay"))&&(n.innerHTML="",n.value="",n.classList.remove("greyText"))},change:function(n,t){n.nodeName==="INPUT"?n.value==n.getAttribute("data-overlay")?(n.value="",n.classList.add("greyText")):(n.value=t,n.classList.remove("greyText")):n.innerHTML==n.getAttribute("data-overlay")||n.value==n.getAttribute("data-overlay")?(n.innerHTML="",n.value="",n.classList.add("greyText")):(n.innerHTML=t,n.value=t,n.classList.remove("greyText"))},onKeyUp:function(n){n.value||(n.classList.add("greyText"),n.value=n.getAttribute("data-overlay"),t(n,0))},onFocus:function(n){(n.innerHTML==n.getAttribute("data-overlay")||n.value==n.getAttribute("data-overlay"))&&t(n,0)},removeDefaults:function(t){if(n=t.nodeName==="INPUT"||t.nodeName==="TEXTAREA"?[t]:t.querySelectorAll('input[type="text"],textarea'),n&&n.length!=0)for(var i=0;i<n.length;i++)n[i].nodeName==="INPUT"&&(n[i].value==n[i].getAttribute("data-overlay")?(n[i].value="",n[i].classList.remove("greyText")):n[i].innerHTML==n[i].getAttribute("data-overlay")&&(n[i].innerHTML="",n[i].classList.remove("greyText")))},applyDefaults:function(i){var r,u;if(n=i.nodeName==="INPUT"||i.nodeName==="TEXTAREA"?[i]:i.querySelectorAll('input[type="text"],textarea'),n&&n.length!=0)for(r=0;r<n.length;r++)n[r].nodeName==="INPUT"?n[r].value||(u=n[r].getAttribute("data-classDefault"),u!==undefined&&u!==null?u!=""&&n[r].classList.add(u):n[r].classList.add("greyText"),n[r].value=n[r].getAttribute("data-overlay"),document.activeElement==n[r]&&t(n[r],0)):n[r].innerHTML||(n[r].classList.add("greyText"),n[r].value=n[r].getAttribute("data-overlay"),n[r].innerHTML=n[r].getAttribute("data-overlay"),document.activeElement==n[r]&&t(n[r],0))}}}(),FloatMenu=function(){function i(u){if(u&&u.classList.contains("active")){n&&n.id!=u.id&&i(n);u.classList.remove("active","left","right","bottom");u.querySelectorAll('[data-float-menu="1"]').forEach(function(n){n.hide()});u.removeAttribute("data-closing");r(u);n=null;var f=t.find(function(n){return n.id==u.id});if(f&&f.options&&typeof f.options.onClose=="function")f.options.onClose(u);EventHandler.removeListener(document.body,"click",function(n){FloatMenu.close(n)})}}function r(){clearTimeout(u)}function e(n,t){this.onOpen=n;this.onClose=t}var u=null,n=null,t=[],f={Options:e,bind:function(n,t,i){n.id||(n.id=guid());t&&(t.onOpen||t.onClose)&&FloatMenu.registerCallback(n,t,!0);FloatMenu.click(n);n.setAttribute("onclick","FloatMenu.click(this, event);"+(i?"event.stopPropagation();":""));FloatMenu.PositionHandler.set()},click:function(t,r){if(r&&(t.querySelector("[data-float-menu]").contains(r.target)||r.target.up("[data-float-menu]")))return!1;var u;n&&(u=n.id,i(n));u!=t.id&&FloatMenu.show(t)},hide:function(n,t,f){var e=t.toElement||t.relatedTarget||t.currentTarget||t.target;e.parentNode!=n&&e!=n&&(r(n),u=setTimeout(i,1e3,n,f))},forceClose:function(n){i(n)},stopHide:function(t){n&&n.id==t.id&&r(t)},show:function(r){var u,f;if(n&&i(n),r.classList.add("float-menu"),r.classList.add("active"),r.querySelector('[data-float-menu="1"]').show(),n=r,u=r.querySelector('input[type="text"]'),u||(u=r.querySelector("textarea")),u&&u.focus(),f=t.find(function(n){return n.id==r.id}),f&&f.options&&typeof f.options.onOpen=="function")f.options.onOpen(r);FloatMenu.boundDomClickOnShow||(EventHandler.addListener(document.body,"click",function(n){FloatMenu.close(n)}),FloatMenu.boundDomClickOnShow=!0)},close:function(t){var r=t.target||t.srcElement;r.up(".float-menu")||n&&i(n)},registerCallback:function(n,i,r){if(n&&n.id&&i){var u=t.findIndex(function(t){return t.id==n.id});u>-1?r||!t[u].options?t[u].options=i:(typeof i.onOpen=="function"&&(t[u].options.onOpen=i.onOpen),typeof i.onClose=="function"&&(t[u].options.onClose=i.onClose)):t.push({id:n.id,options:i})}},isFloatMenu:function(n){return n&&n.classList.contains("float-menu")}};return f.PositionHandler=function(){function n(n,t){typeof n=="string"&&n!=""&&typeof t=="function"&&$(n).each(function(n,i){$(i).find(".listItemAction > a:not(.BoundPositionHandler)").each(function(n,r){r.classList.add("BoundPositionHandler");t(r,$(i));EventHandler.addListener(r.up(".listItemAction"),"click",function(){t(this.querySelector("a"),$(i))})})})}return{_maxMobileWindowWidth:768,set:function(){n(".popupContent",function(n,t){if(n&&t&&!(t.length<1))if(n.up().classList.contains("active")){var u=$(n),i=n.up(),r=i?$(i.querySelector(".listItemActionDrop")):null,f=u.offset(),e=t.offset(),o=$(window).width(),s=f.top,l=u.height(),h=r&&r.length>0?r.outerHeight():0,a=o<1025?$("#Sidebar:not(.open)").outerHeight()||0:0,c=e.top,v=s-c-a,y=s-c+l+h,p=t.height();y>p&&v>h&&i&&i.classList.add("bottom");var w=f.left,b=e.left,k=r&&r.length>0?r.outerWidth():0,d=w-b;d<k&&o>FloatMenu.PositionHandler._maxMobileWindowWidth&&i&&i.classList.add("left")}else n.up().classList.remove("left","bottom")});n(".taskTableContent",function(n,t){var l,a;if(n&&t&&!(t.length<1))if(n.up().classList.contains("active")){var f=$(n),r=n.up(),e=f.offset(),i=null,u=null;r&&(i=$(r.querySelector(".listItemActionDrop")),u=$(r.up(".list")));var o=e.top,v=f.height(),s=i&&i.length>0?i.outerHeight():0,h=t.offset().top,y=o-h,p=o-h+v+s,w=t.height()-t.find("tr:first").height();p>w&&y>s&&r&&r.classList.add("bottom");var c=$(window).width(),b=$(".menu").width(),k=e.left,d=u&&u.length>0?u.outerWidth():0,g=i&&i.length>0?i.outerWidth():0,nt=k-b+g;nt>d&&c>FloatMenu.PositionHandler._maxMobileWindowWidth&&r&&r.classList.add("right");l=u&&u.length>0?u.offset().left:0;a=i&&i.length>0?i.offset().left:0;l>a&&c>FloatMenu.PositionHandler._maxMobileWindowWidth&&r&&r.classList.add("left")}else n.up().classList.remove("left","right","bottom")});n(".tasksTableContent",function(n,t){var l,a;if(n&&t&&!(t.length<1))if(n.up().classList.contains("active")){var f=$(n),i=n.up(),e=f.offset(),u=null,r=null;i&&(u=$(i.querySelector(".listItemActionDrop")),r=$(i.up(".list")));var o=e.top,v=f.height(),s=u&&u.length>0?u.outerHeight():0,h=t.offset().top,y=o-h,p=o-h+v+s,w=t.height()-(t.find("div:first").outerHeight()+20);p>w&&y>s&&i&&i.classList.add("bottom");var c=$(window).width(),b=$(".menu").width(),k=e.left,d=r&&r.length>0?r.outerWidth():0,g=u.outerWidth(),nt=k-b+g;nt>d&&c>FloatMenu.PositionHandler._maxMobileWindowWidth&&i&&i.classList.add("right");l=r&&r.length>0?r.offset().left:0;a=u.offset().left;l>a&&c>FloatMenu.PositionHandler._maxMobileWindowWidth&&i&&i.classList.add("left")}else n.up().classList.remove("left","right","bottom")})}}}(),f}(),Popup=function(){function r(t){t?(document.body.style.position=document.body.style.overflowY=document.body.style.width=document.body.style.top="",$(window).scrollTop(parseInt(document.body.getAttribute("data-og-pos")))):(n.length>1||document.body.setAttribute("data-og-pos",$(window).scrollTop()),document.body.style.position="fixed",document.body.style.overflowY="scroll",document.body.style.width="100%",document.body.style.top="-"+document.body.getAttribute("data-og-pos")+"px")}function s(n){if(i)return!1;if(i=!0,n instanceof f&&typeof n.id=="string"){var u=document.getElementById(n.id),r=null;if(u&&(r=u.up(".popup")),r&&(t=r,t.style.display="flex",typeof n.onResume=="function"))n.onResume(n.toElem())}else return!1;Popup.busyOff()}function h(){window.BoundOrientationChanged!=1&&(EventHandler.addListener(window,"resize",function(){Popup.adjustContentHeight()}),window.BoundOrientationChanged=1)}function u(n,i){i&&$(t).find(".popupBg").fadeOut("fast");n?$(t).fadeOut().css({display:"none"}):($(t).fadeOut().css({transform:"scale(.9)",display:"none"}).html(""),t.remove())}function a(n,t,i,r,u){this.onOpen=n;this.onResume=t;this.onBlur=i;this.onClose=r;this.discardOnForcedClose=typeof u=="function"?u:function(){return u?!0:!1}}function f(n,t){var i=typeof n=="string"?htmlStringToElement(n):n;i.id=i.id||shortGuid();this.id=i.id;this.html=i.outerHTML;this.onResume=null;this.onBlur=null;this.onClose=null;this.discardOnForcedClose=function(){return!1};isObject(t)&&(this.onResume=t.onResume,this.onBlur=t.onBlur,this.onClose=t.onClose,this.discardOnForcedClose=t.discardOnForcedClose)}var n=[],t=null,o=!1,i=!1,e="data-persistent",c=["1","true"],l=function(){function n(n){n.childNodes.forEach(function(n){var i=n.nodeValue.trim(),t;try{t=new Function(i);t.apply(t)}catch(r){console.warn("something went wrong when trying to run script on value: "+i);console.log(r);return}})}function t(n){var t=n.getAttribute("src");try{$(n).replaceWith(createHtmlElement("script",{type:"text/javascript",src:t}))}catch(i){console.warn("something went wrong when trying to load script file from source: "+t);console.log(i);return}}return{runOnTarget:function(i){var r,u;i&&(r=[],u=[],i.querySelectorAll('script[type="text/javascript"]').forEach(function(n){n.getAttribute("src")?u.push(n):n.childNodes.length&&r.push(n)}),r.forEach(n),u.forEach(t))}}}();return window.onbeforeunload=function(){n&&n.length>0&&Popup.close(!0,!0)},f.prototype.toElem=function(){var n=this,i;return n.id&&(i=document.getElementById(n.id)),n.html&&(i=htmlStringToElement(n.html)),i?i:t?t.querySelector(".popupBox"):Popup.current()},{LayerOptions:a,current:function(){return n.length==0?null:document.getElementById(n[n.length-1].id)},getLayerCount:function(){return n.length},disableBackgroundClick:function(){o=!0},busyOff:function(){i=!1},open:function(u,o,s,c){if(i)return!1;i=!0;var a,p,w,v,y;if(n.length>0&&(p=n[n.length-1],w=document.getElementById(p.id)),IsEscKeyBinded||onEscapeKeypress(),c&&c.popupID?(t=document.getElementById(c.popupID),t.classList.add("popup")):t=createHtmlElement("div",{"class":"popup"}),o)typeof o=="string"?v=document.getElementById(o):o instanceof jQuery?v=o[0]:isObject(o)&&(v=o),v&&(a=new f(v.querySelector(".popupBox").outerHTML,c),t=v,y=n.findIndex(function(n){return n.id==a.id}),y>-1&&n.splice(y,-1),n.push(a));else if(u)a=new f(u,c),t.innerHTML='<div class="popupBg"><\/div>'+a.html,a.html="",y=n.findIndex(function(n){return n.id==a.id}),y>-1&&n.splice(y,-1),n.push(a);else return!1;if(s&&t.hasAttribute(e)||Popup.bindCloseEvents(),s&&t.setAttribute(e,"1"),w&&(p&&typeof p.onBlur=="function"&&p.onBlur(),w.up(".popup").hide()),v||document.body.appendChild(t),$(t).find(".popupBg").fadeIn(),$(t).css({transform:"scale(1)",display:"flex"}),Popup.adjustContentHeight(),h(),c&&typeof c.onOpen=="function")c.onOpen(a.toElem());l.runOnTarget(t.querySelector(".popupBox"));n.length>0&&r(!1);i&&setTimeout(function(){Popup.busyOff()},600)},openWithStructure:function(n,t,i,r,u){var f=createHtmlElement("div",{"class":"popupBox"}),o,c,s,h,e;n&&(f.id=n);u&&u.hideHeader||(o=createHtmlElement("div",{"class":"popupHeader"}),u&&u.hideCloseBtn||(e=createHtmlElement("div",{"class":"popupCloseBtn",href:"javascript:void(0)"},createHtmlElement("i",{"class":"icon-fechar"})),o.appendChild(e)),!t||u&&u.hideTitle||(c=createHtmlElement("div",{"class":"popupHeaderTitle"}),c.innerHTML=t,o.appendChild(c)),f.appendChild(o));!i||u&&u.hideBodyContent||(s=createHtmlElement("div",{"class":"popupContent"}),i instanceof HTMLElement?s.appendChild(i):s.innerHTML=i,f.appendChild(s));u&&u.hideFooterContent||(h=createHtmlElement("div",{"class":"popupFooter"}),r?h.innerHTML=r:(e=createHtmlElement("div",{"class":"blueBtn CloseBtn",href:"javascript:void(0)",onclick:"Popup.close();"}),e.innerText=Translations.get(Translations.keys.Close),h.appendChild(e)),f.appendChild(h));u&&u.fitContent&&(f.style.width="auto");Popup.open(f)},close:function(f,o){var p,v,y,b,l;if(!f&&i||!t)return o&&r(!0),!1;if(p=t.querySelector(".popupBox"),!p)return f&&(n=[]),o&&r(!0),!1;var k=p.id,h=n.find(function(n){return n.id==k}),a=c.indexOf(t.getAttribute(e))>-1,w=null;if(h&&typeof h.onClose=="function"&&(typeof h.discardOnForcedClose!="function"||!h.discardOnForcedClose())&&(w=h.toElem().cloneNode(!0)),f&&!a){for(v=n.length-1;v>=0;v--)y=n[v],y&&y.id&&(b=document.getElementById(y.id),l=null,b&&(l=b.up(".popup")),l&&l.style.display=="none"&&l.remove());n=[];u(a,!0)}else n.length>1?(n.splice(-1,1),u(a),s(n[n.length-1])):(n.splice(-1,1),u(a,!0));if(n.length<1&&r(!0),w)h.onClose(w)},closeByID:function(t){var i=null,f=-1;if(t&&t instanceof Element&&(t=t.id),t&&typeof t=="string"&&(f=n.findIndex(function(n){return n.id==t}),f>-1&&(i=n[f])),!i){Popup.close(!1);return}if(n.splice(-1,f),n.length>0?(u(!1),s(n[n.length-1])):(u(!1,!0),r(!0)),typeof i.onClose=="function"&&(typeof i.discardOnForcedClose!="function"||!i.discardOnForcedClose()))i.onClose(i.toElem())},onEscapeKeypress:function(){if(o)return!1;Popup.close()},bindCloseEvents:function(){$(t).find(".popupCloseBtn").each(function(n,t){t.getAttribute("onclick")||$(t).click(function(){Popup.close()})});$(t).find(".popupBg").click(function(){Popup.close()})},openPersistent:function(n,t,i,r,u,f,e){var o=document.getElementById(u);e?e.popupOptions?e.popupOptions.popupID=u:e.popupOptions={popupID:u}:e={popupOptions:{popupID:u}};o&&o.childNodes.length>0?Popup.open(null,u,!0,e.popupOptions):ajaxRequest(n,t,i,r,f,e)},registerCallbacks:function(t,i){var r,u;if(!isObject(t))return!1;if(r=-1,typeof i=="string"?r=i?n.findIndex(function(n){return n.id==i}):n.length-1:typeof i=="number"&&i<=0&&(r=n.length-1+i),r==-1)return console.error("Popup.registerCallbacks: this function should be used to register callbacks for already opened popups. to register for a new popup, do it on opening of the popup, using the options param in Popup.open();"),!1;for(u in t)t.hasOwnProperty(u)&&u in n[r]&&t[u]!=null&&(n[r][u]=t[u])},adjustOverflow:function(n,t){var i=Popup.current(),r;i&&(r=i.querySelector(".popupContent"),n?(i.style.overflow=i.getAttribute("data-prev-overflow")||"",r.style.overflow=r.getAttribute("data-prev-overflow")||""):(i.setAttribute("data-prev-overflow",$(i).css("overflow")),r.setAttribute("data-prev-overflow",$(r).css("overflow")),i.style.overflow=t?"hidden":"visible",r.style.overflow=t?"hidden":"visible"))},adjustContentHeight:function(){var n,i,u,r;if(t||(t=Popup.current()),n=t.querySelector(".popupContent"),n){i=n.up(".swiper-wrapper");i&&(n=i);u=t.querySelector(".popupHeader");r=t.querySelector(".popupFooter");n.style.minHeight&&(n.style.minHeight="");var o=$(t).height()||0,s=$(u).height()||0,f=$(n).height()||0,h=$(r).height()||0,e;e=isMobile(window)?0:window.innerHeight<1024?20:100;n.style.maxHeight=o-s-10-(r?h:0)-e+"px";n.style.minHeight=(f<=140?f:140)+"px"}},adjustContentPosition:function(n,t,i){var r,u,f,o,s,h;if((!isMobile(window)||i)&&(n&&(r=n.up(".popupBox"),u=$(n).height(),f=n.viewportOffset().top),r)){var c=f+u,e=$(r).find(".popupContent:first").height(),l=r.querySelector(".popupFooter").viewportOffset().top;(e<u||l<c)&&(o=window.innerHeight,s=parseInt(o/2),e<s?Popup.adjustOverflow(t):t||(h=u<200?200:f,$(r).find(".popupContent:first").animate({scrollTop:h+"px"})))}},removeLayer:function(t,i){if(!t&&t!=0)return!1;var u=!1,r;if(typeof t=="number"?t<0?r=n.length-1+t:t==0&&(r=n.length-1,u=!0):typeof t=="string"&&(r=n.findIndex(function(n){return n.id==t}),r>-1&&(u=r==n.length-1)),r<=-1)return!1;u&&i?Popup.close():n.splice(r,-1)},closeAt:function(t){var r,u,i;return typeof t!="number"||t>=0?!1:(r=n.length-1+t,r<=-1)?!1:(u=n[r],u&&u.id)?(i=document.getElementById(u.id),i&&(i=i.up(".popup")),n.splice(r,1),i.remove(),!0):!1},rebind:function(n){Popup.bindCloseEvents();Popup.adjustContentHeight();h();typeof n=="number"&&n>0&&(Popup.current().querySelector(".popupContent").scrollTop=n)},isPopup:function(t){return!t||!t.id||!t.classList.contains("popupBox")||!n.find(function(n){return n.id===t.id})?!1:!0}}}(),MessageBox=function(){function r(n,t,i){if(n&&Array.isArray(t)&&t.length>0)if(i){var r=createHtmlElement("div",{"class":"alertMessage"});r.appendChild(createHtmlElement("i",{"class":"icon-exclamacao"}));r.innerHTML+=t.join("<br>");n.innerHTML=r.outerHTML}else n.innerHTML=t.join("<br>");return n}function t(t,i,u,f,e){var h,s,c,l,a,o;if(e=e||!1,!t||!Array.isArray(i)||i.length==0)return!1;h=createHtmlElement("div",{"class":"popupHeader"});u&&typeof u=="string"&&h.appendChild(createHtmlElement("div",{"class":"popupHeaderTitle",innerText:u}));s=createHtmlElement("div",{"class":"smallBoxText"});typeof t=="string"?s=r(s,[t],f):Array.isArray(t)&&t.length>0&&(s=r(s,t,f));c=createHtmlElement("div",{"class":"popupContent"});c.appendChild(s);l=createHtmlElement("div",{"class":"popupFooter"});i.filter(function(n){return n&&!isBlank(n.text)}).forEach(function(n){var t=createHtmlElement("a",{href:"javascript:void(0);","class":(n.isMain?"blueBtn MainActionBtn":"whiteBtn CancelActionBtn")+" MessageBoxBtn",innerText:n.text,tabindex:1});EventHandler.addListener(t,"click",function(){MessageBox.close(this)});typeof n.action=="function"?EventHandler.addListener(t,"click",n.action):typeof n.action=="string"&&t.setAttribute("onclick",n.action);l.appendChild(t)});a=e?createHtmlElement("div",{"class":"popupBox"},[h,c,l]):createHtmlElement("div",{"class":"popupBox smallBox"},[h,c,l]);o=document.getElementById(n);o||(o=createHtmlElement("div",{id:n,"class":"popup",style:"z-index: 10000;"}),document.body.appendChild(o));o.children.length>0&&o.clearChildren();o.appendChild(createHtmlElement("div",{"class":"popupBg",onclick:"MessageBox.close();"}));o.appendChild(a);$(o).fadeIn(100).css({transform:"scale(1)",display:"flex"});o.querySelector(".MessageBoxBtn").focus()}function i(n,t,i){return{text:n,isMain:t,action:i}}var n="PopupSmallBox";return{alert:function(n,r,u,f){if(!n)return!1;var e=[i(f||Translations.get(Translations.keys.OK),!0,r)];t(n,e,u)},confirm:function(n,r,u,f,e,o,s,h){if(!n)return!1;var c=[i(r||Translations.get(Translations.keys.OK),!0,u),i(e||Translations.get(Translations.keys.Cancel),!1,o)];t(n,c,f,s,h)},confirmMultiple:function(n,i,r,u,f){if(!n)return!1;if(Array.isArray(i)&&i.length==2)for(var e=0;e<i.length;e++)i[e].text||(i[e].text=i[e].isMain?Translations.get(Translations.keys.OK):Translations.get(Translations.keys.Cancel));t(n,i,r,u,f)},close:function(t){var i,r,u;t?i=t.up(".popup"):(i=document.getElementById(n),r=i.querySelectorAll(".MessageBoxBtn"),u=r.length==1?r[0]:r.find(function(n){return n.classList.contains("CancelActionBtn")}),u&&u.click());i.clearChildren();i.hide()}}}(),Loading=function(){function u(n,t){var u=createHtmlElement("i",{"class":"icon-loading"}),i=createHtmlElement("div",{"class":"loading"},u),r;if(n&&i.setAttribute("id",n),t)if(typeof t=="string")i.classList.add(t);else if(Array.isArray(t))for(r=0;r<t.length;r++)i.classList.add(t[r]);return i}var n,t,r,i=0;return{show:function(r,u){!u&&(i++,i>1)||(r||(r=document.body),n||(n=document.createElement("div"),n.setAttribute("id","BoxLoading"),n.setAttribute("class","loadingLarge")),t||(t=document.createElement("div"),t.setAttribute("id","BoxOverlay"),t.setAttribute("class","boxOverlay")),r.appendChild(n),r.appendChild(t))},hide:function(u){if(i--,i<0)i=0;else if(i>0)return;r&&clearTimeout(r);u||(u=document);n||(n=u.getElementById("BoxLoading"));t||(t=u.getElementById("BoxOverlay"));n&&n.remove();t&&t.remove()},showLate:function(n){(i++,i>1)||(r=setTimeout(function(){Loading.show(n,!0)},200))},ensureInline:function(n,t){var r,i;return n?(r=n.up().querySelector(".InlineLoading"),r?(i=r.id,i||(i=t||"InlineLoading_"+shortGuid(),r.id=i),n.setAttribute("data-loading-id",i),r):(i=t||n.getAttribute("data-loading-id"),i||(i="InlineLoading_"+shortGuid(),n.setAttribute("data-loading-id",i)),r=u(i,"InlineLoading"),r.style.display="none",n.up().insertBefore(r,n),r)):!1},generateInline:u,toggleStacked:function(n,t){var i=n?n.querySelector(".loading"):null,r;i&&(i.getAttribute("data-loading-stack")||i.setAttribute("data-loading-stack","0"),r=parseInt(i.getAttribute("data-loading-stack")),t?(r=Math.max(0,r-1),r==0&&i.hide()):(r++,i.show()),i.setAttribute("data-loading-stack",r.toString()))}}}(),Translations=function(){var n=Object.freeze({OK:0,Cancel:1,Delete:2,And:3,Or:4,Exclude:5,More:6,GenericError:7,EmailPopupLangChange:8,Customize:9,Yes:10,No:11,Close:12,EmailRecipientLimitExceeded:13,WarningNameEmpty:14,MustChooseTemplate:15,FacebookNoImageSelected:16,NoRealestateSelected:17,CurrentlyUploadingFile:18,UPLOAD_NOT_ALLOWED:19,ErrorUploadingFile:20,UNSUPPORTED_FILE_TYPE:21,YoutubeNoSelectedVideos:22,YoutubeAuthenticationRequired:23,YoutubeRequiredInfo:24,YoutubeOnlyOneVideoAllowed:25,ToSelect:26,SeeRealestate:27,MandatoryFields:28,RoadMapNoSelection:29,SolveProblem:30,ErrorSavingRoadMap:31,FacebookExportAuthenticationRequired:32,SelectOnePropertyOnly:33,SelectedSingle:34,SelectedMultiple:35,Apply:36,NoItemsSelected:37,VirtualTourSelectFirstImage:38,VirtualTourDeletePointConfirm:39,VirtualTourSelectNextImage:40,VirtualTourNotImages:41,VideoEncoderLeavingWarn:42,VideoEncoderCurrentlyRendering:43,VideoEncoderNoScene:44,NoSelectedEvents:45,AboutReachLimit:46,LimitReached:47,Realestates:48,ForPortal:49,NoFractionSelected:50,PublishLandingWarn:51,LandingLimitWarn:52,LandingPairWarn:53,EmptyRecordsList:54,SelectDate:55,ChooseContact:56,MustInsertDescription:57,ClickOnTheLocationYouWant:58,ValueTooSmall:59,ValueTooBig:60,MsgAppraisalFields:61,MsgSecondAppraisalFields:62,SureYouWantToContinue:63,NewsletterBulkSendConfirm:64,LandingMinWarn:65,NoSurveySelected:66,LandingLimitWarnVehicle:67,LandingPairWarnVehicle:68,LandingMinWarnVehicle:69,LandingLimitWarnClientProduct:70,LandingPairWarnClientProduct:71,LandingMinWarnClientProduct:72,CompanyName:73,FirstName:74,EmarketingWarningSelectRecipients:75,PaymentsListProfileContext:76,PaymentsListProfile:77,Proceed:78,NoPermissionToPerformThisAction:79,CasaSapoConfirmCancelCampaign:80,NEWSLETTER_TEMPLATE_CHANGE:81,NEWSLETTER_DATA_CHANGED:82,ERROR_FILE_SIZE:83}),t={};return{_seeCache:function(){var n=[];return forEachProp(t,function(t,i){n.push(t+":"+i[t])}),n.join("\n")},availableLanguages:null,keys:n,init:function(i){if(!i)return console.error("Translations: cannot run init() without options. Translations cache will be empty"),!1;forEachProp(i,function(i,r){i in n?t[n[i]]=r[i]:console.warn("Translations: key provided in options must be registered in the CacheKeys, prior to running init(). key = "+i)})},get:function(n){return n>=0?t[n]:(console.error("Translations: cannot find registered translation for key = "+n),"")},fillAllTranslations:function(n,t,i,r){var o,s,h,f,u,e,c;if(n&&r,Translations.availableLanguages){for(o="",s="",u=0;u<Translations.availableLanguages.length;u++)if(h=document.getElementById(i+Translations.availableLanguages[u].Culture.toLowerCase()),h&&$(h).is(":visible")){s=Translations.availableLanguages[u].Culture;o=h.value;break}if(o!=""&&s!=""){for(f="",u=0;u<Translations.availableLanguages.length;u++)e=document.getElementById(i+Translations.availableLanguages[u].Culture.toLowerCase()),e&&(typeof e.value!="undefined"?e.value||(f+=(f?",":"")+Translations.availableLanguages[u].Culture):typeof e.innerHTML!="undefined"&&(e.innerHTML||(f+=(f?",":"")+Translations.availableLanguages[u].Culture)));f&&(c="Text="+encodeURIComponent(o)+"&From="+s+"&MissingLanguages="+f,ajaxRequest(n,t,"GET",c,function(n){var r,f,u,t,e;if(n&&isObject(n.data)&&n.data.translations){for(r=JSON.parse(n.data.translations),u="",t=0;t<r.length;t++)r[t].Success?(f=document.getElementById(i+r[t].Culture.toLowerCase()),f&&(e=decodeURIComponent(r[t].Translation),Translations.fillTranslation(e,f))):u==""&&(u=r[t].Error);u!=""&&MessageBox.alert(Translations.get(u))}},{async:!0}))}}},fillTranslation:function(n,t){t||(t=this.CurrentElement);typeof t.value!="undefined"?t.value||(t.value=n):typeof t.innerHTML!="undefined"&&(t.innerHTML||(t.innerHTML=n))},initAvailableLanguages:function(n,t){Translations.availableLanguages||ajaxRequest(n,t,"GET",null,function(n){n&&n.status==1&&isObject(n.data)&&n.data.availableLanguages&&(Translations.availableLanguages=JSON.parse(n.data.availableLanguages))})}}}(),Requests=function(){var n=Object.freeze({ObjectIDs:0,Medias:1,EntityIDs:2,Emails:3,SearchText:4,SelectedIDs:5,ApplicationID:6,Type:7,CustomSearchContext:8,RLTyCookie:9,SearchContext:10,AssociatedCategory:11,IsCreateEditContext:12,Context:13,CustomSearchName:14,Page:15,CustomSearchID:16,SearchParameters:17,IDs:18,Level:19,Names:20,ParentID:21,RealestateStatus:22,ObjectID:23,SelectedID:24,CustomLimit:25,ReportID:26,SimplifiedContext:27,OnChange:28,BusinessObject:29,EntityIDsTo:30,TypeID:31,VisitFileID:32,AccessPermissionType:33,DateEndHour:34,DateEndMin:35,CurrentSelection:36,LeadID:37,RoadMapID:38,CheckAppConfiguration:39,Date:40,MediaJSON:41,Guid:42,ProcessManagementStage:43,CurrentUserID:44,TargetUserID:45,Format:46,Template:47,TourItems:48,RecordCount:49,HistoricListType:50,EventCategories:51,HistoricTypeID:52,Visible:53,Index:54,IsSingle:55,EventID:56,HistoricID:57,ShowMsg:58,ViewType:59,EventIDs:60,EventType:61,UniqueID:62,Name:63,Source:64,RoleID:65,OldRoleID:66,CategoryID:67,CallID:68,ProcessID:69,IsFromList:70,Reload:71,SearchUrl:72,Items:73,KeyGroupID:74,Status:75,Floor:76,Position:77,DateStart:78,DateEnd:79,AssociatedEmailTo:80,RealestateField:81,OpportunityField:82,OccupationID:83,AppraisalClassLevel:84,AppraisalMarketValue:85,AppraisalImediateSale:86,AppraisalJustify:87,RealestateFeaturesIDs:88,AppraisalRepairs:89,AppraisalRecomendations:90,AppraisalFeatureDeValues:91,AppraisalData:92,CurrentAccountAmount:93,CurrentAccountDescription:94,Video:95,LastVideo:96,Scenes:98,CurrentAccountID:99,RealestateID:100,IsFromBuilder:101,FileName:102,FilePath:103,FileFormat:104,NewsletterHeader:105,NewsletterReference:106,NewsletterSendDate:107,MultiStepStep:108,ActionType:109,EntityID:110,NextLevel:111,InvoiceNumber:112,CurrentUrl:113,Text:114,ID:115,IsFirstCrossRealestateCall:116,Value:117,GoogleJSON:118,GoogleAccessToken:119,GoogleResourceName:120,EmarketingType:121,GoogleIDToken:122,Configs:123,MediaID:124,RealestateProspectingSuboriginID:125,Permissions:126,MapGuid:127,BusinessObjectWorkOn:128,CurrentStep:129,CurrentStepDeleted:130,MultiStepStepToLoad:131,EmarketingTemplateID:132,RenderContainer:133,IsChecked:134,TimelineID:135,Commission:136,Percentage:137,EmarketingLandingTemplateID:138,RealestateBaseDevelopments:139,TargetID:140}),t={};return{_seeCache:function(){var n=[];return forEachProp(t,function(t,i){n.push(t+":"+i[t])}),n.join("\n")},keys:n,init:function(i){if(!i)return console.error("Requests: cannot run init() without options. Requests cache will be empty"),!1;forEachProp(i,function(i,r){i in n?t[n[i]]=r[i]:console.warn("Requests: key provided in options must be registered in the CacheKeys, prior to running init(). key = "+i)})},get:function(n){return n>=0?t[n]:(console.error("Requests: cannot find registered request for key = "+n),"")},getPair:function(n,t){return isOfTypes(t,["string","number","boolean"])||(t=""),encodeURIComponent(Requests.get(n))+"="+encodeURIComponent(t)}}}(),ListActions=function(){function i(){var n=document.querySelector(".PageListActions");if(!n||!n.up(".listScroll")){var i=$(window).scrollTop(),u=$(window).width(),f=$(n).outerHeight()+15,t=$(".listOrder"),e=t>0?t.offset().top:0;i>e&&u<r?(n&&n.classList.add("fixed"),$(".listResults, .gridResults").css({"margin-top":f+"px"})):(n&&n.classList.remove("fixed"),$(".listResults, .gridResults").css({"margin-top":"auto"}))}}var n=!1,t=!1,r=769;return{menuHiddenDOMClickHandler:function(n){var t=document.getElementById("listActionsMenuHidden");n.target&&(t&&t.contains(n.target)||n.target.up("#listActionsMenuHidden"))||(ListActions.menuHide(),EventHandler.removeListener(document.body,"click",ListActions.menuHiddenDOMClickHandler))},bind:function(){var u,r,f;document.querySelector(".PageListActions")&&(n||(EventHandler.addListener(document,"scroll",function(){i()}),n=!0),t||(EventHandler.addListener(window,"resize",function(){i()}),t=!0),u=document.getElementById("listActionsMenuHidden"),u)&&(EventHandler.addListener(u.querySelector(".dropHeader").querySelector("a"),"click",function(){ListActions.menuHide()}),r=u.querySelector("a"),r&&!r.getAttribute("title")&&r.setAttribute("title",Translations.get(Translations.keys.More)),r&&!r.getAttribute("onclick")&&r.setAttribute("onclick","ListActions.menuClick(this);"),f=document.getElementById("listActionsMenuDrop").querySelector(".listActionsMenuDropContent").querySelectorAll("a"),f&&f.length>0&&f.forEach(function(n){EventHandler.addListener(n,"click",function(){ListActions.menuHide()})}))},menuClick:function(n){if(n.getAttribute("data-working")=="1")return!1;n.setAttribute("data-working","1");var t=n.up().querySelector("#listActionsMenuDrop");t.getAttribute("data-vis")=="1"?(t.setAttribute("data-vis","0"),$(t).fadeOut("fast"),$("#Sidebar").css("z-index","7"),$("#header").css("z-index","8"),EventHandler.removeListener(document.body,"click",ListActions.menuHiddenDOMClickHandler)):(t.setAttribute("data-vis","1"),$(t).fadeIn("fast"),$("#Sidebar").css("z-index","0"),$("#header").css("z-index","6"),EventHandler.addListener(document.body,"click",ListActions.menuHiddenDOMClickHandler));n.setAttribute("data-working","0")},menuHide:function(){var t=$(window).width(),n=document.getElementById("listActionsMenuDrop");n&&(n.hide(),n.setAttribute("data-vis","0"),t<769&&($("#Sidebar").css("z-index","9"),$("#header").css("z-index","8")),EventHandler.removeListener(document.body,"click",ListActions.menuHiddenDOMClickHandler))},toggleItemActions:function(n){var i,t;if(n.getAttribute("data-working")=="1")return!1;n.setAttribute("data-working","1");i=n.up(".listItemActions");i.classList.toggle("open");t=n.querySelector("i");t.classList.contains("icon-dot-menu")?(t.classList.remove("icon-dot-menu"),t.classList.add("icon-fechar"),$(n).delay(500).queue(function(n){i.style.overflow="visible";n()})):(t.classList.remove("icon-fechar"),t.classList.add("icon-dot-menu"),i.style.overflow="");n.setAttribute("data-working","0")},expandMoreInfo:function(n){$(n).parent().find(".listItemExpandContent").slideToggle();n.classList.toggle("open")}}}(),DetailActions=function(){function t(n,t){if(n&&n.target&&(n.target.classList.contains("float-menu")||n.target.up(".listItemAction.float-menu")||document.getElementById("DetailActions").contains(n.target)))return!1;t&&t.classList.contains("active")&&t.click()}var n=!1;return{bind:function(){var i=document.getElementById("DetailActions"),r=i?i.querySelector(".listItemActionDrop"):null;if(!r)return!1;r.querySelectorAll("a:not(.ClkBnd)").forEach(function(n){EventHandler.addListener(n,"click",function(){t(null,this.up(".listItemAction.float-menu"))});n.classList.add("ClkBnd")});n||(EventHandler.addListener(document.body,"click",function(n){t(n,document.getElementById("DetailActions"))}),n=!0)}}}(),Impersonate=function(){return{openSwitchUserPopup:function(n,t){ajaxRequest(n,t,"GET",null)},switchUser:function(n,t,i){ajaxRequest(n,t,"POST","userID="+i,function(n){if(n&&n.status==1&&isObject(n.data)&&n.data.url){var t=n.data.url;$.ajax("/EgoForge/Ajax/ActiveUserActions.aspx",{data:"action=2&nid="+i,method:"POST",async:!0,beforeSend:function(){Loading.show()},success:function(){window.location=t},complete:function(){try{Loading.hide()}catch(n){}}})}})},switchApplication:function(n,t,i){ajaxRequest(n,t,"POST",Requests.get(Requests.keys.ApplicationID)+"="+i,function(n){if(n&&n.status==1&&isObject(n.data)&&n.data.url){var t=n.data.url;$.ajax("/EgoForge/Ajax/ActiveUserActions.aspx",{data:"action=1&nid="+i,method:"POST",async:!0,beforeSend:function(){Loading.show()},success:function(){window.location=t},complete:function(){try{Loading.hide()}catch(n){}}})}})}}}(),Tabs=function(){function i(n){var i=t.find(function(t){return t.id==n.get(0).id});if(i)if(n.is(":hidden")){if(typeof i.onCollapse==typeof Function)i.onCollapse(n.get(0))}else if(typeof i.onExpand==typeof Function)i.onExpand(n.get(0))}function r(){function u(n){var t,r,i;if(!n)return null;for(t=n,r=parseInt(n.getAttribute("data-up-levels"))||2,i=0;i<r;i++)t=t.parentNode;return t.querySelector(".collapsingContent,.detailSectionContent,.detailSectionNoContent,.dashboardBoxContent,.CollapsingContent")}function f(t){if(!(t instanceof r)){console.warn('_registerCallbacks: param "options" must be of type CollapsingPaneOptions. options type = '+(t?t.constructor:t+""));return}if(typeof t.onOpen!="function"&&typeof t.onClose!="function"){console.warn('_registerCallbacks: param "options" must contain at least one valid callback function (onOpen or onClose). options = '+JSON.stringify(t));return}var i=n.findIndex(function(n){return n.id==t.id});i>-1&&n.splice(i,1);n.push(t)}function i(n,t){t=ensureArray(t);t.length==0&&(t=n?n.querySelectorAll(".tabsHeader"):document.querySelectorAll(".tabsHeader"));t.forEach(function(n){var t=n.up(".collapsingContent"),i,r;t&&t.style.display!="none"&&(i=$(n).outerWidth(),r=$(n).find(".tabsHeaderContent > div").width(),i>r?$(n).removeClass("largeNav"):$(n).addClass("largeNav"))})}function r(n,t,i){this.id=n;this.onOpen=t;this.onClose=i}var n=[],t={};return{toggle:function(t,i,f,e,o,s,h){var c,a,v,p,l,y;i&&t.getAttribute("data-status")!="loaded"||(c=u(t),c&&(c.id||(c.id=shortGuid()),p=c.id,l=n.find(function(n){return n.id==p}),l&&l instanceof r&&(a=l.onOpen,v=l.onClose)),t.getAttribute("data-visible")!="true"?(AjaxQueue.push(function(){if($(c).stop().slideDown({complete:function(){var t,n;for(typeof a=="function"&&a(),t=c.querySelectorAll("*"),n=0;n<t.length;n++)EventHandler.trigger(t[n],"Pane:Opened",!1);AjaxQueue.process()}}),s&&h){var n=c.up(s);n&&$(n).children(h).stop().slideDown()}}),t.parentNode.classList.add("active"),t.classList.add("active"),t.setAttribute("data-visible","true"),t.hasAttribute("data-tabname")&&Associated.setTabOpen(t)):(AjaxQueue.push(function(){if($(c).stop().slideUp({complete:function(){typeof v=="function"&&v();AjaxQueue.process()}}),s&&h){var n=c.up(s);n&&$(n).children(h).stop().slideUp()}}),t.parentNode.classList.remove("active"),t.classList.remove("active"),t.setAttribute("data-visible","false"),t.hasAttribute("data-tabname")&&Associated.setTabClose(t)));i&&!t.getAttribute("data-status")&&(t.setAttribute("data-status","loading"),t.classList.add("CollapsingPaneActivator"),y=Loading.generateInline(),t.appendChild(y),ajaxRequest(t,i,o||"GET",f?f:null,function(n){t.setAttribute("data-status","loaded");t.setAttribute("data-visible","false");y.remove();Tabs.CollapsingPane.toggle(t);typeof e=="function"&&e(n,t)},{hideLoading:!0}))},clearCallbacks:function(i){if(!i){console.log("Tabs.CollapsingPane.clearCallbacks: cannot clear callbacks for unknown context. contextKey = "+i+".");return}var r=t[i];Array.isArray(r)&&r.length!=0?(r.forEach(function(t){var i=n.findIndex(function(n){return n.id==t});i>-1&&n.splice(i,1)}),t[i]=[]):n=[]},resizeNavHeader:i,registerNavHeaders:function(n,u,e){if(!n){console.log('Tabs.CollapsingPane.registerNavHeaders: param "contextKey" is missing.');return}if(!u){console.log('Tabs.CollapsingPane.registerNavHeaders: param "parentElem" is missing.');return}n in t||(t[n]=[]);var o={};u.querySelectorAll(".tabsHeader").forEach(function(i){var r=i.up(".collapsingContent");r&&(t[n].findIndex(function(n){return n==r.id})==-1&&t[n].push(r.id),r.id in o||(o[r.id]=[]),o[r.id].push({isvisible:r.style.display=="block"||$(r).parents(".collapsingLine").find(".collapsingBtn:first").hasClass("active")?!0:!1,header:i}))});forEachProp(o,function(n,t){i(null,t[n].filter(function(n){return n.isvisible==!0}).map(function(n){return n.header}));f(new r(n,function(n){return function(){i(null,n)}}(t[n].map(function(n){return n.header}))))});typeof e!="function"?console.log('Tabs.CollapsingPane.registerNavHeaders: param "windowResizeElemAccessor" is not a function. will not add "resize" listener to the "window".'):EventHandler.addListener(window,"resize",function(){Tabs.CollapsingPane.resizeNavHeader(e())})},resetPane:function(n){var t,i;n&&(t=n.classList.contains("CollapsingPaneActivator")?n:n.querySelector(".CollapsingPaneActivator"),t&&(t.removeAttribute("data-status"),t.getAttribute("data-visible")=="true"&&(t.classList.remove("active"),t.parentNode.classList.remove("active"),i=u(t),i&&i.hide(),t.click())))},openMoreInfo:function(n){n&&n.hasAttribute("data-target")&&($(n).parent().find(n.getAttribute("data-target")).slideToggle(),n.classList.toggle("open"))}}}function u(n,t){this.id=n;this.fn=t}function f(n,t,i){this.id=n;this.onExpand=t;this.onCollapse=i}var n=[],t=[];return{toggleActive:function(r,e,o,s){var c=r.getAttribute("data-content-id"),h=$("#"+c),a,v,l;if(h&&h.length){if((o||s)&&(l=t.findIndex(function(n){return n.id==c}),l>-1?(t[l].onExpand=o,t[l].onCollapse=s):t.push(new f(c,o,s))),a=h.attr("data-content-holder"),v=a?h.find(a):h,!v.html()){l=n.findIndex(function(n){return n.id==c});l>-1?n[l].fn=Tabs.updateActiveBtn:n.push(new u(c,Tabs.updateActiveBtn));h.click();return}h.parent().children(e).stop().slideUp().finish(h.stop().slideToggle({complete:function(){var n=$("#"+c),t;n.length>0&&n[0]&&(t=n[0].up(".listItemExpand"),t.querySelectorAll("a.active[data-content-id]").invoke("classList.remove","active"),n.is(":visible")&&t.querySelectorAll('a[data-content-id="'+c+'"]').invoke("classList.add","active"),i(n))}}))}},updateActiveBtn:function(n){var t=$("#"+n),i=t.parents(".listItemExpand:first");i.find("a.active[data-content-id]").each(function(n,t){$(t).removeClass("active")});t.is(":visible")||i.find('a[data-content-id="'+n+'"]').each(function(n,t){$(t).addClass("active")})},loadDataContent:function(t,r,u){var e,f,o;t&&(e=t.id,e&&(f=document.querySelectorAll("[data-content-id='"+e+"']"),f&&f.length>0&&(o=f[0].getAttribute("data-count"),o&&(u+="&"+o))));ajaxRequest(t,r,"GET",u,function(r){var u,f;(r.replaces||r.updates)&&(u=$("#"+t.id),r.status==ajaxRequest.StatusType.Success&&(f=n.findIndex(function(n){return n.id==t.id}),f>-1&&(n[f].fn(t.id),u.removeAttr("data-update-btn-callback"))),u.parent().children(".listItemExpandBox").stop().slideUp().finish(u.stop().slideToggle({complete:function(){i(u)}})),document.getElementById(t.id).removeAttribute("onclick"))})},changeActive:function(n){var t=$(n).parent().index();$(n).parent().siblings().removeClass("active");$(n).parent().addClass("active");$(n).parent().parent().hasClass("tabController")&&($(n).closest(".tabsContainer").find(".tabsContentTab").hide(),$(n).closest(".tabsContainer").find(".tabsContentTab").eq(t).fadeIn());var i=$(n).parent().parent(".tabsHeaderContent").width()/2,r=$(".tabsHeaderContent").scrollLeft(),u=$(n).outerWidth()/2,f=$(n).position().left-36,e=f+u-i;$(n).parent().parent(".tabsHeaderContent").animate({scrollLeft:r+e},600)},navigateLeft:function(n){$(n.parentNode.querySelector(".tabsHeaderContent")).animate({scrollLeft:"-=200"})},navigateRight:function(n){$(n.parentNode.querySelector(".tabsHeaderContent")).animate({scrollLeft:"+=200"})},ajaxReset:function(n,t){var i,r;n&&(i=n.querySelector(".AjaxSection"),i&&(i.removeAttribute("data-status"),i.removeAttribute("data-visible"),i.setAttribute("data-pendingreset","1"),r=n.querySelector(".detailSectionContent"),r.innerHTML="",r.hide(),t?(i.hasAttribute("data-tabname")&&Tabs.updateTabCookie(i.getAttribute("data-tabname"),"o"),i.click()):i.click()))},updateTabCookie:function(n,t){var i=localStorage.getItem("ATabs"),r,u;i==null&&(i=Cookie.get("ATabs"),localStorage.setItem("ATabs",i),Cookie.remove("ATabs"));i?(r=i.split(";"),u=r.indexOf(n+":o")==-1?r.indexOf(n+":c"):r.indexOf(n+":o"),u!=-1&&r.splice(u,1),i=r.join(";"),t=="c"&&(i+=";"+n+":"+t),localStorage.setItem("ATabs",i)):localStorage.setItem("ATabs",n+":"+t)},loadForMainSection:function(n,t,i){n.classList.contains("active")||ajaxRequest(n,t,"GET",i)},CollapsingPane:r(),Items:function(){var i=function(n,t){var r,i;if(n)for(r=n.querySelectorAll('input[type="checkbox"]'),i=0;i<r.length;i++)r[i].checked=t,r[i].parentNode.toggleClass("selected",t)},t=function(n){var f=[],t=n.querySelectorAll(".checkBoxLabel"),e=t?t.length:0,i,u,r;if(e>0)for(i=0;i<t.length;i++)u=t[i].querySelector('input[type="checkbox"]'),u&&u.checked&&(r=t[i].queryLastChildTextContent(),r.trim(),r.length>0&&f.push(r));return[f,e]},r=function(n,i){var u,r,f;if(n&&i&&(u=n.querySelector(".tabControllerCheck"),u.classList.remove("icon-menos"),u.classList.remove("icon-check"),r=t(i),r[0]&&r[0].length>0))return u.classList.add(r[0].length==r[1]?"icon-check":"icon-menos"),r[0].length>3?(f=n.queryChildrenLast("a"),(f.innerText||f.textContent).trim()):r[0].join(", ")},n=function(n){var u,f,i,e,o,s;if(n&&n.classList&&n.classList.contains("HasDescription")){if(u="",f=n.querySelector(".tabsContainer"),f){var h=f.querySelectorAll(".tabControllerBtn"),l=f.querySelectorAll(".tabsContentTab"),c=[];for(i=0;i<h.length;i++)e=r(h[i],l[i]),e&&c.push(e);u=c.join(", ")}else o=t(n)[0],o.length>0&&(u=o.join(", "));s=n.querySelector(".ContainerDescription");s&&(s.innerText=u)}};return{onLoad:function(t){var r,i;if(t)for(r=t.querySelectorAll(".collapsingLine"),i=0;i<r.length;i++)r[i].classList.contains("HasDescription")&&n(r[i])},tabClick:function(t){var f=t.up(".tabControllerBtn").getAttribute("data-id"),u=t.up(".HasDescription"),r;u&&(r=u.querySelector('.tabsContentTab[data-id="'+f+'"]'),r&&i(r,!t.classList.contains("icon-check")),n(t.up(".collapsingLine")),r.offsetParent===null&&Tabs.changeActive(t.nextSibling))},itemClick:function(t){t.parentNode.toggleClass("selected",t.checked);n(t.up(".collapsingLine"))}}}()}}(),Cookie=function(){return{get:function(n){var t=document.cookie.match(new RegExp("(^|;)\\s*"+escape(n)+"=([^;\\s]*)"));return t?unescape(t[2]):null},set:function(n,t,i){var u="; path=/",r;return i!=undefined&&(r=new Date,r.setTime(r.getTime()+864e5*parseFloat(i)),u+="; expires="+r.toGMTString()),document.cookie=encodeURIComponent(n)+"="+encodeURIComponent(t||"")+u},remove:function(n){var t=Cookie.get(n)||!0;return Cookie.set(n,"",-1),t},push:function(n,t,i){var r=Cookie.get(n),u,f;return r||(r=""),u=r.split(","),f=u.indexOf(t),f==-1&&u.push(t.toString()),r=u.filter(function(n){return n.length}).join(","),Cookie.set(n,r,i)},pop:function(n,t,i){var r=Cookie.get(n),u,f;return r?(u=r.split(","),f=u.indexOf(t.toString()),f>-1&&u.splice(f,1),r=u.filter(function(n){return n.length}).join(","),Cookie.set(n,r,i)):!1}}}(),TinyMceEditor=function(){return{loadSimpleEditor:function(n,t,i,r,u){var f=n?document.getElementById(n):null,e,o;if(!f)return!1;e=t!=undefined?t:300;o=i!=undefined?i:"padding:8px;";f.TinyEditor=new TINY.editor.edit("editor",{id:n,width:"100%",height:e,cssclass:"",controlclass:"",rowclass:"",dividerclass:"",controls:[],footer:!1,fonts:["Verdana","Arial","Georgia","Trebuchet MS"],xhtml:!1,cssfile:"",bodyid:"editor",footerclass:"",toggle:{text:"source",activetext:"wysiwyg",cssclass:"toggle"},resize:{cssclass:"resize"},css:"body{font-family:Helvetica,Arial,sans-serif;font-size: 13px;line-height:22px;margin:0;"+o+"}",onKeyUp:function(n){var s;r();var t=f.TinyEditor.i,e=t.contentDocument?t.contentDocument:t.contentWindow.document,o=e.body,i=e.documentElement,u=Math.max(o.scrollHeight,o.offsetHeight,i.clientHeight,i.scrollHeight,i.offsetHeight);(u<110||f.TinyEditor.i.height<110)&&(s=n&&n.which?n.which:n.keyCode,s==13&&(u+=20),f.TinyEditor.setHeight(Math.min(u,110)))},onPaste:u})},load:function(n,t,i,r){var f=n?document.getElementById(n):null,e,u;if(!f)return!1;e=t!=undefined?t:300;u=["bold","italic","underline","strikethrough","|","subscript","superscript","|","orderedlist","unorderedlist","|","outdent","indent","|","leftalign","centeralign","rightalign","blockjustify","|","unformat","|","undo","redo","n","font","size","style","|","image","hr","link","unlink","|","cut","copy","paste","print","|","uploadimage"];u=mergeArrays(u,r);f.TinyEditor=new TINY.editor.edit("editor_"+n,{id:n,width:"100%",height:e,cssclass:"te",controlclass:"tecontrol",rowclass:"teheader",dividerclass:"tedivider",controls:u,footer:!0,fonts:["Verdana","Arial","Georgia","Trebuchet MS"],xhtml:!1,cssfile:"",bodyid:"editor_"+n,footerclass:"tefooter",toggle:{text:"source",activetext:"wysiwyg",cssclass:"toggle"},resize:{cssclass:"resize"},css:"body{font-family:Helvetica, Arial, sans-serif; font-size: 13px; line-height:22px;}",upload_handler:TinyMceEditor.uploadHandler(i)})},loadMultiple:function(n,t,i,r,u){var s=n?document.getElementById(n):null,e,o,f;if(!s)return!1;e=t!=undefined?t:300;window.tinyEditors||(window.tinyEditors=[]);o=u?"|":"n";f=["bold","italic","underline","strikethrough","|","subscript","superscript","|","orderedlist","unorderedlist","|","outdent","indent","|","leftalign","centeralign","rightalign","blockjustify","|","unformat","|","undo","redo",o,"font","size","style","|","image","hr","link","unlink","|","cut","copy","paste","print","|"];r||f.push("uploadimage");window.tinyEditors.push(new TINY.editor.edit("editor"+window.tinyEditors.length+1,{id:n,width:"100%",height:e,cssclass:"te",controlclass:"tecontrol",rowclass:"teheader",dividerclass:"tedivider",controls:f,footer:!0,fonts:["Verdana","Arial","Georgia","Trebuchet MS"],xhtml:!1,cssfile:"",bodyid:"editor",footerclass:"tefooter",toggle:{text:"source",activetext:"wysiwyg",cssclass:"toggle"},resize:{cssclass:"resize"},css:"body{font-family:Helvetica, Arial, sans-serif; font-size: 13px; line-height:22px;}",upload_handler:TinyMceEditor.uploadHandler(i)}))},uploadHandler:function(n){return("qq"in window)?function(t,i){var r=Media.getBasicOptions(t,n,!1,{onSubmit:function(n,t){Loading.show();var r=","+t.substring(t.lastIndexOf(".")).toLowerCase()+",";if(",.jpg,.jpeg,.gif,.png,.pdf,.doc,".indexOf(r)==-1)return Loading.hide(),MessageBox.alert(Translations.get(Translations.keys.UNSUPPORTED_FILE_TYPE)),i&&(i.i.contentDocument.body.focus(),i.restoreSelection()),!1},onComplete:function(n,t,r){var f,e,o,u;Loading.hide();i.i.contentDocument.body.focus();isObject(r)&&r.success&&r.Media?(i.restoreSelection(),Array.isArray(i.t.Medias)||(i.t.Medias=[]),i.t.Medias.push(r.Media),r.isImage?(f=0,e=0,e=setInterval(function(n){var t=!1;if($.get(r.Media.Src,{async:!1},function(n){t=n?!0:!1}),t||f===3){clearInterval(e);n._options.button.editorRef.e.execCommand("insertimage",0,r.Media.Src)||MessageBox.alert(Translations.get(Translations.keys.GenericError));return}f++},500,this)):(o=createHtmlElement("a",{href:r.Media.Src,target:"_blank",innerText:r.Media.Name}),u=this._options.button.editorRef.e.getSelection(),u&&(u.focusNode||u.collapse(),u.focusNode&&u.focusNode.insertBefore(o,null)))):MessageBox.alert(r.message?r.message:Translations.get(Translations.keys.GenericError))}});return r.text={fileInputTitle:t.title},new qq.FineUploaderBasic(r)}:(console.error('TinyEditor requer o plugin "fine-uploader.core" (wwwroot/Scripts/lib/fine-uploader.core.js) de JS para upload de media.'),null)},loadByID:function(n,t,i,r){var u,f;n&&t&&(u=document.getElementById(n),u&&(f=u.getAttribute("data-tinymce-upload-url"),f&&TinyMceEditor.load(t,i||300,f,r)))},post:function(n){if(!n){console.warn("TinyMceEditor.post: targetID invalido.");console.log(n);return}var t=typeof n=="string"?document.getElementById(n):n;if(!t){console.warn("TinyMceEditor.post: target nao encontrado.");console.log(n);return}if(!t.TinyEditor){console.warn("TinyMceEditor.post: TinyEditor nao carregado para o target apresentado. Necessario correr uma das funcoes de load, consoante o contexto.");console.log(t);return}t.TinyEditor.post()},listUploadedMedia:function(n){if(!n){console.warn("TinyMceEditor.listUploadedMedia: targetID invalido.");console.log(n);return}var t=typeof n=="string"?document.getElementById(n):n;if(!t){console.warn("TinyMceEditor.post: target nao encontrado.");console.log(n);return}return t.Medias||[]}}}(),Limit=function(){var n=Object.freeze({AddRealestate:1,AddEntity:2,AddMedia:3,AddVideo:4,SendFacebook:5,SendSurvey:6,SendEmail:7,SocialSearch:8,AddUser:9});return{LimitType:n,url:"",withinLimit:function(){var i,n;if(arguments.length==0)return!1;for(i=arguments[0],n=1;n<arguments.length;n++)i+=","+arguments[n];var t=!0,r="Type="+i+"&Increment="+({}.increment||0);return ajaxRequest(null,Limit.url,"GET",r,function(i){if(i.status==1&&Array.isArray(i.data)&&i.data.length>0)for(n=0;n<i.data.length;n++){var r=i.data[n];if(r.status==0){MessageBox.alert(r.message);t=!1;break}else if(r.status==1)continue;else if(r.status==2&&(t=confirm(r.message),!t))break}},{async:!1}),t}}}(),Flash=function(){function n(n,t,i,r,u,f){var e=['<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="https://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,29,0"'],o,h,s;if(e.push(' id="'+t+'" '),e.push(' width="'+r+'" '),e.push(' height="'+u+'" '),o=['<embed pluginspage="https://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" '],o.push(' id="'+t+'" '),o.push(' width="'+r+'" '),o.push(' height="'+u+'" '),e.push(">"),e.push('<param name="src" value="'),e.push(i),e.push('">'),o.push(' src="'),o.push(i),o.push('" '),f)for(h=0;h<f.length;h++)s=f[h],e.push('<param name="'),e.push(s.name),e.push('" value="'),e.push(s.value),e.push('">'),o.push(" "),o.push(s.name),o.push('="'),o.push(s.value),o.push('" ');o.push("><\/embed>");e.push(o.join(""));e.push("<\/object>");n.innerHTML=e.join("")}function t(t,i,r,u,f){n(t,i,r,u,f,[{name:"quality",value:"high"},{name:"wmode",value:"transparent"},{name:"menu",value:"false"},{name:"allowScriptAccess",value:"always"},{name:"allowFullScreen",value:"true"}])}return{setExt:n,setIn:t}}(),SwipeButton=function(){return{_isListening:!1,_ActiveBtn:null,_OutOfFocusTimeout:0,toggle:function(n,t,i){clearTimeout(SwipeButton._OutOfFocusTimeout);SwipeButton._ActiveBtn&&SwipeButton._ActiveBtn!=n&&SwipeButton._ActiveBtn.classList.remove("active");SwipeButton._ActiveBtn=n;n.classList.contains("active")?t():(n.classList.add("active"),EventHandler.removeListener(n,"mouseleave"),EventHandler.removeListener(n,"mouseenter"),EventHandler.addListener(n,"mouseleave",function(){SwipeButton._OutOfFocusTimeout=setTimeout(function(){SwipeButton._ActiveBtn&&(SwipeButton._ActiveBtn.classList.remove("active"),SwipeButton._ActiveBtn=null)},2e3)}),EventHandler.addListener(n,"mouseenter",function(){clearTimeout(SwipeButton._OutOfFocusTimeout)}));SwipeButton._isListening||(stopEventPropagation(i),EventHandler.addListener(document.body,"click",SwipeButton.focusOutListener),SwipeButton._isListening=!0)},focusOutListener:function(n){if(SwipeButton._ActiveBtn){if(n&&n.target&&(n.target.contains(SwipeButton._ActiveBtn)||n.target==SwipeButton._ActiveBtn||n.target.up("."+SwipeButton._ActiveBtn.classList.join("."))||n.target.hasParent(SwipeButton._ActiveBtn)))return!1;SwipeButton._ActiveBtn.classList.remove("active");SwipeButton._ActiveBtn=null}}}}(),IframeManager=function(){var n=[],t=function(){n=n.filter(function(n){return n&&n.constructor===i?n.exists():!1});for(var t=0;t<n.length;t++)n[t].updateHeight()},i=function(n,t,i,r){var u=document.getElementById(n),f;return u?(f=function(n){var t,r;(u.hasAttribute("data-ajust-width")&&u.getAttribute("data-ajust-width")&&(u.style.width=u.contentWindow.document.body.offsetWidth+"px"),u.hasAttribute("data-min-height")&&(t=parseInt(u.getAttribute("data-min-height"))),t||(t=160),u.height=t+5+"px",u.offsetParent!==null)&&(i&&!u.hasAttribute("data-expanded")?n>t?(r=u.getAttribute("data-loadmore-selector"),r?$(r).attr("style","display:block;"):$(u).next("a.readMore").attr("style","display:block;")):u.height=n+5+"px":u.height=n)},u.src="about:blank",u.before,u.onload=function(){var o=document.createElement("div"),i,n,e;o.innerHTML=HtmlUtility.decode(t);u.contentWindow.document.write(o.outerHTML);u.contentWindow.document.body.classList.add("NoMargin");u.hasAttribute("data-classes")&&u.contentWindow.document.body.classList.add(u.getAttribute("data-classes"));i=document.createElement("meta");i.name="viewport";i.content="width=device-width, initial-scale=1.0";n=document.createElement("link");n.href=Urls.get(Urls.keys.IframeCSS);n.rel="stylesheet";n.type="text/css";n.onload=function(){f($(u.contentWindow.document.body.querySelector("div")).outerHeight(!0))};u.contentWindow.document.head.appendChild(i);u.contentWindow.document.head.appendChild(n);r&&(e=document.createElement("base"),e.setAttribute("target","_blank"),u.contentWindow.document.head.appendChild(e));u.contentWindow.document.close();f(u.contentWindow.document.body.scrollHeight);EventHandler.addListener(u,"Pane:Opened",function(){f($(u.contentWindow.document.body.querySelector("div")).outerHeight(!0))},!0)},{exists:function(){return document.body.contains(u)},updateHeight:function(){f($(u.contentWindow.document.body.querySelector("div")).outerHeight(!0))}}):undefined};return{registerIframes:[],register:function(n,t,i){IframeManager.registerIframes.push({ID:n,Content:t});i&&IframeManager.build()},build:function(r,u){if(IframeManager.registerIframes&&IframeManager.registerIframes.length>0){for(var f=0;f<IframeManager.registerIframes.length;f++)n.push(new i(IframeManager.registerIframes[f].ID,IframeManager.registerIframes[f].Content,r,u));IframeManager.registerIframes=[];EventHandler.removeListener(window,"resize",t);EventHandler.addListener(window,"resize",t)}},openFullFrame:function(n,t){var i=document.getElementById(t),u=i.contentDocument?i.contentDocument:i.contentWindow?i.contentWindow.document:i.document,r;i.height=u.body.scrollHeight+"px";i.setAttribute("data-expanded","true");r=i.getAttribute("data-loadmore-selector");r?$(r).hide():$(n).hide()},clearIframeContent:function(n){if(n){var t=document.getElementById(n);t&&(t.contentWindow.document.body.innerHTML="")}},collapsingPaneToggle:function(n,t,i,r,u){var e,f;if(Tabs.CollapsingPane.toggle(n,t,i,r,u),n)for(e=n.parentNode.parentNode.parentNode.querySelectorAll("iframe"),f=0;f<e.length;f++)EventHandler.trigger(e[f],"Iframe:Show")}}}(),MultiCultureControl=function(){function t(t){for(var i=0;i<t.classList.length;i++)if(n.indexOf(t.classList[i])>-1)return!0;return!1}var n=Object.freeze(["active","selected"]);return{showCultureEditor:function(n){var t=null,i=null,u=null,f,e,r,o;if(n&&!n.classList.contains("active")&&(u=n.up(".MultiLanguageDropContext"),u&&(t=u.up())),t&&(i=n.getAttribute("data-container")),!i)return MultiCultureControl.toggleDrop(n,!0),!1;f=t.querySelector('[id="'+i+'"]');f&&(t.querySelectorAll(".contentText, .smsCharCount").forEach(function(n){n.setAttribute("style","display:none;")}),e=n.up(".MultiLanguageFlagList"),e&&e.querySelectorAll(".FlagSelector.active").forEach(function(n){n.classList.remove("active")}),n.classList.add("active"),f.setAttribute("style",""),o=t.querySelector('[id="charCounter_'+i+'"]'),o&&o.setAttribute("style",""),r=u.querySelector(".SelectedLanguage .FlagSelector"),r&&(r.setAttribute("data-container",i),r.querySelector("i").className=n.querySelector("i").className,r.querySelector("span").textContent=n.querySelector("span").textContent,MultiCultureControl.toggleDrop(n,!0)))},countChars:function(n){var t,i,u,r;n&&!n.classList.contains("active")&&(t=n.up(".languageListControl").querySelector(".MultiLanguageFlagList"),i=t.querySelector(".active"));t&&i&&(u=i.getAttribute("data-container"),r=document.getElementById("charCounter_"+u+"").querySelector(".currentSmsCount span"),r&&(r.innerText=n.value.length))},toggleDrop:function(n,i){var r=null,u,f,e,o,h,s;if(n&&(r=n.up(".MultiLanguageDropContext")),r)if(i||r.classList.contains("active"))FloatMenu.isFloatMenu(r)?r.click():r.classList.remove("active");else{if(r.classList.add("active"),u=r.querySelector(".MultiLanguageFlagList"),!u)return;f=u.querySelectorAll("a.FlagSelector");o=f.length>0?$(f[0]).height():30;h=parseInt($(u).height()/o);e=f.findIndex(t);e>-1&&(s=f[e]);u.scrollTop=!s||e<=parseInt($(u).height()/$(s).height())?0:u.viewportOffset().top+(f.length-h)*o}},checkLanguageWidth:function(){document.querySelectorAll(".MultiLanguageDropContext").forEach(function(n){n.classList.remove("dropDown");var i=n.querySelector(".languageSelected"),t,r,u;i&&i.childNodesCount==0&&(t=n.querySelector(".FlagSelector.active"),t&&(t=t.cloneNode(!0),i.appendChild(t)));r=$(n).width()||0;u=($(n.querySelector(".MultiLanguageFlagList")).width()||0)+50;r<u?(n.classList.remove("btnList"),n.classList.add("dropDown")):(n.classList.remove("dropDown"),n.classList.add("btnList"))})}}}(),NumberInput=function(){return{setInputFilter:function(n,t,i,r){var s=getEventKeyCode(n),u,e,o;if(s==EventKeys.ArrowLeft||s==EventKeys.ArrowRight)return!0;u=/^\d*$/;i&&r?u=/^-?\d*[.,]?\d*$/:i?u=/^\d*[.,]?\d*$/:r&&(u=/^-?\d*$/);var h=t.selectionStart,c=t.selectionEnd,f=!1;t&&t.value&&(t.value=t.value.replace(/[.,]/g,Money.get(Money.keys.fraction_separator)).trim(),f=!0);e=t.getAttribute("data-max")?parseInt(t.getAttribute("data-max")):0;o=t.getAttribute("data-min")?parseInt(t.getAttribute("data-min")):0;u.test(t.value)&&(o==0||isNaN(parseInt(t.value))||parseInt(t.value)>=o)&&(e==0||isNaN(parseInt(t.value))||parseInt(t.value)<=e)?t.setAttribute("data-old-value",t.value):(t.value=t.getAttribute("data-old-value"),f=!0);f&&setSelectionRange(t,h,c)}}}(),Money=function(){var n=Object.freeze({fraction_count:0,fraction_separator:1,separate_thousands:2,symbol:3,symbol_position:4,thousands_separator:5}),t={};return{keys:n,init:function(i){if(!i)return console.error("Money: cannot run init() without parameters."),!1;forEachProp(i,function(i,r){i in n?t[n[i]]=r[i]:console.warn("Money: key provided in options must be registered in the MoneyOptions, prior to running init(). key = "+i)})},get:function(n){return n>=0?t[n]:(console.error("MoneyOptions: cannot find registered parameters for key = "+n),"")},format:function(n,t){if(n.constructor===Number){var i=n.toFixed(Money.get(Money.keys.fraction_count));return Money.get(Money.keys.separate_thousands)&&(i=Money.separateThousands(i)),t?i:Money.addSymbol(i)}},separateThousands:function(n){for(var r=n.split("."),t=r[0],i=r[1],u=/(-?\d+)(\d{3})/;u.test(t);)t=t.replace(u,"$1"+Money.get(Money.keys.thousands_separator)+"$2");return!isNaN(Number(i))&&Number(i)>0?[t,i].join(Money.get(Money.keys.fraction_separator)):t},addSymbol:function(n){var t=[n];return t.splice([0,2].indexOf(Money.get(Money.keys.symbol_position))>-1?0:1,0,Money.get(Money.keys.symbol)),t.join([2,3].indexOf(Money.get(Money.keys.symbol_position))>-1?" ":"")}}}(),PhoneNumber=function(){var n={Portugal:620,Spain:724},t=function(t){var r=!1,i;if(t)for(i in n)if(n.hasOwnProperty(i)&&n[i]==t){r=!0;break}return r};return{init:function(t){isObject(t)&&isObject(t.countryShopCodes)&&(n=$.extend(n,t))},validateForSms:function(i,r){if(!t(r))return i&&i.length==9;switch(r){case n.Portugal:return i&&i.length==9&&i.startsWith("9");case n.Spain:return i&&i.length==9&&(i.startsWith("6")||i.startsWith("7"));default:return i&&i.length==9}}}}(),EgoCoin=function(){var n={};return n.Movements=function(){return{loadPage:function(n,t,i){ajaxRequest(n,t,"POST",Requests.get(Requests.keys.Page)+"="+i)}}}(),n}(),Urls=function(){var n=Object.freeze({ContactsGAuthOnSignInAction:0,CalendarGAuthOnSignInAction:1,YoutubeCheckAuthenticationAction:2,IframeCSS:3}),t={};return{_seeCache:function(){var n=[];return forEachProp(t,function(t,i){n.push(t+":"+i[t])}),n.join("\n")},keys:n,init:function(i){if(!i)return console.error("Urls: cannot run init() without options. Urls cache will be empty"),!1;forEachProp(i,function(i,r){i in n?t[n[i]]=r[i]:console.warn("Urls: key provided in options must be registered in the CacheKeys, prior to running init(). key = "+i)})},get:function(n){return n>=0?t[n]:(console.error("Urls: cannot find registered request for key = "+n),"")}}}(),HelpBox=function(){function t(t,i,r,u){n.forEach(function(n){var e=$(t).closest(n).get(0),f,o;e&&(f=e.viewportOffset(),r<f.left&&(o=r-f.left-20,i.style.marginRight=o+"px"),u<f.top&&(i.style.bottom="auto",i.style.top="100%",i.style.marginBottom="none",i.style.marginTop="5px"))})}var n=Object.freeze([".popupContent",".acmColumn.editContent",".gridResults"]);return{initTooltips:function(n){n&&n.length!=0||(n=document.querySelectorAll(".tooltipBtn:not(.TooltipInitialized)"));n.forEach(function(n){$(n).hover(function(){var r=this,i=r.querySelector(".tooltipContent"),e,n;if(i){var f=i.viewportOffset(),u=f.left,o=f.top;u<0&&(e=u-20,i.style.marginRight=e+"px");n=r.up(".popupBox");n&&(n.setAttribute("data-initial-overflow",n.style.overflow||""),n.style.overflow="visible");t(r,i,u,o)}},function(){var t=this,i=t.querySelector(".tooltipContent"),n;i&&(i.removeAttribute("style"),n=t.up(".popupBox"),n&&(n.style.overflow=n.getAttribute("data-initial-overflow")||"",n.removeAttribute("data-initial-overflow")))});n.classList.add("TooltipInitialized")})},findTooltips:function(n){return n?n.querySelectorAll(".tooltipBtn"):[]}}}(),EditInPlace=function(){function n(n){var t,i;n&&(t=n.up(".opDetailSummarySectionContent"),t&&(i=t.querySelector('[data-key="editValue"]'),i&&(i.hide(),Element.show(t.querySelector('[data-key="value"]')),Element.show(t.querySelector('[data-editlink="1"]')))))}function t(n,t,i,r){var u,e,o,c;if(n&&(u=n.up(".opDetailSummarySectionContent"),u)){var s=r,h=!1,f=u.querySelector('[data-key="editValue"]'),l=n.hasAttribute("data-tiny-editor");f&&(l&&(e=u.querySelector("textarea"),e&&e.TinyEditor!=null&&e.TinyEditor.post()),f.querySelectorAll("input, select, textarea").forEach(function(n){var i=u.querySelector('[data-key="value"]').getAttribute("data-value")||"",t=n.value||"";t.trim()!=i.trim()&&(n.setAttribute("value",t),h=!0)}),h?(o=[],u.querySelectorAll("input, select, textarea").forEach(function(n){var i=n.type||"",t;if(i.toLowerCase()=="checkbox"){if(t=n.getAttribute("name"),!t)return;o.push(encodeURIComponent(t)+"="+encodeURIComponent(n.value||""))}else o.push($(n).serialize())}),c=appendStringParams(Requests.getPair(Requests.keys.ObjectID,i),o),ajaxRequest(n,t,"POST",c,function(n){n.status==1&&(f.hide(),Element.show(u.querySelector('[data-key="value"]')),Element.show(u.querySelector('[data-editlink="1"]')),s&&s())})):(f.hide(),Element.show(u.querySelector('[data-key="value"]')),Element.show(u.querySelector('[data-editlink="1"]'))))}}function i(n){if(n){var t=n.up(".opDetailSummarySectionContent");t&&(t.querySelector('[data-key="value"]').hide(),t.querySelector('[data-key="editValue"]').show(),t.querySelector('[data-editlink="1"]').hide())}else return}return{cancel:n,save:t,toggle:i}}(),TextboxDropdown=function(){function n(){($(".listItemActionDrop").is(":visible")||$(".listItemActions .listItemAction").hasClass("active"))&&($(".listItemAction").removeClass("active bottom left"),$(".listItemActionDrop").removeAttr("style"))}return{init:function(){$(document).on("click",".listItemActionDrop > a",function(){var t=this.up(".valueDrop"),n=$(this);$(".listItemActionDrop > a.active").removeClass("active");n.addClass("active");$(".selectedOptionId").val(n.data("id"));$(".denomination",t).text(n.data("denomination"))});$(document).click(function(t){$(t.target).closest(".listItemAction").length||n()})},openList:function(t){n();$(t).addClass("active")},changeAllCurrency:function(n,t){var i=n.up(".addedContent");$(t,i).text($(n).data("denomination"))}}}();TableView.change=function(n,t,i){var r=n.value,f=!1,u;r||(r=n.getAttribute("data-field-name"),f=!0);i||!n.checked?($(".thTableView"+r).hide(),$(".tdTableView"+r).hide()):($(".thTableView"+r).show(),$(".tdTableView"+r).show());f&&(document.getElementById("CheckTableView"+r).checked=!1);u="";$("#TableViewFieldList input").filter(":checked").serializeArray().find(function(n){n.name=="FieldName"&&(u+=(u?",":"")+n.value)});Cookie.set(t,u,365)};window.async.f=[];RTCPeerConnection=window.webkitRTCPeerConnection||window.mozRTCPeerConnection;RTCPeerConnection&&function(){function i(t){if(!(t in n)){n[t]=!0;var i=Object.keys(n).filter(function(t){return n[t]});Cookie.set("NIP",i.join(",")||"n/a",365)}}function r(n){n.split("\r\n").forEach(function(n){var t,r;if(~n.indexOf("a=candidate")){var t=n.split(" "),r=t[4],u=t[7];u==="host"&&i(r)}else~n.indexOf("c=")&&(t=n.split(" "),r=t[2],i(r))})}var t=new RTCPeerConnection({iceServers:[]}),n;(1||window.mozRTCPeerConnection)&&RTCPeerConnection.prototype.createDataChannel&&t.createDataChannel("",{reliable:!1});t.onicecandidate=function(n){n.candidate&&r("a="+n.candidate.candidate)};t.createOffer(function(n){r(n.sdp);t.setLocalDescription(n)},function(n){console.warn("offer failed",n)});n=Object.create(null);n["0.0.0.0"]=!1}();var g=document.getElementsByTagName("body")[0],x=window.innerWidth||document.documentElement.clientWidth||g.clientWidth,y=window.innerHeight||document.documentElement.clientHeight||g.clientHeight;Cookie.set("SS",x+"×"+y,365);Cookie.set("BSS",screen.width+"×"+screen.height,365);HttpUtility=function(){var n=Object.freeze({Pair:"=",Query:"&"});return{objectToQuery:function(t,i){var u=[],f=i?function(n){return encodeURIComponent(n)}:function(n){return n};for(var r in t)r&&t.hasOwnProperty(r)&&u.push(r+n.Pair+f(t[r]));return u.join(n.Query)},queryToObject:function(t,i){var r={},u=i?function(n){return decodeURIComponent(n)}:function(n){return n};return typeof t=="string"&&t.length>0&&t.split(n.Query).forEach(function(t){var i=t.split(n.Pair);i.length>0&&(r[i[0]]=i.length>1?u(i[1]):"")}),r}}}();HtmlUtility=function(){var n=document.createElement("div"),t;return n.setAttribute("style","display: none; margin: 0; padding: 0; width: 0; height: 0;"),t=new RegExp("&[^s]*;"),{encode:function(t){n.textContent=t;var i=n.innerHTML;return n.textContent="",n.innerHTML="",i},toText:function(i){n.innerHTML=i;for(var r=n.textContent;t.test(r);)n.innerHTML=r,r=n.textContent;return n.textContent="",n.innerHTML="",r},decode:function(t){n.innerHTML=t;var i=n.textContent;return n.textContent="",n.innerHTML="",i},sanitize:function(n){return n.strip().replace(/<\/?\w+>/igm,function(n){return n.replace(n,n.replace(/[<>]/ig,""))})}}}();Dropdown.prototype.get=function(){return this.innerDropdown};CalendarDate.MONTHS="January February March April May June July August September October November December".split(" ");CalendarDate.WEEKDAYS="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ");CalendarDate.WEEKDAYSABR="Su Mo Tu We Th Fr Sa".split(" ");CalendarDate.firstDOW=0;CalendarDate.VISIT_REALESTATE="Visit";CalendarDate.parse=function(n,t){if((n||"").toString().strip()){if(n.constructor==Date)return new CalendarDate(n.getFullYear(),n.getMonth()+1,n.getDate());if(Array.isArray(n)){var c=n[0],l=n[1],a=n[2];return new CalendarDate(c,l,a)}if(n.constructor==CalendarDate)return new CalendarDate(n.year,n.month,n.day);if(t){if(n.length==4)return new CalendarDate(n,1,1);var o=t.split(" "),s=n.split(" "),e,v,f,y,u,r,c,l,a,p,w,b=0,i,h,k="";if(t=o[0],n=s[0],e=new CalendarDate,e.setDateTime(new Date),v=t.match(/[^dmy]/ig),f=n.match(/[^0-9]/g),v&&f)if(u=t.split(v[0]),r=n.split(f[0]),r.length==u.length){for(i=0,h=u.length;i<h;i++)switch(u[i].charAt(0).toLowerCase()){case"d":a=r[i];break;case"m":l=r[i];break;case"y":c=r[i]}if(o.length>1&&(t=o[1],n=s[1],y=t.match(/[^hms]/ig),f=n.match(/[^0-9]/g),y&&f&&(u=t.split(y[0]),r=n.split(f[0]),r.length>=u.length))){for(i=0,h=u.length;i<h;i++)switch(u[i].charAt(0).toLowerCase()){case"h":p=r[i];break;case"m":w=r[i];break;case"s":b=r[i]}e.date.setUTCHours(p,w,b)}o.length>2&&s.length>2&&(k=s[2]);e=new CalendarDate(c,l,a,p,w,b,k)}else e=CalendarDate.parse(n.toString().split(f));return e}return CalendarDate.parse(n.toString().split("-"))}return CalendarDate.parse(new Date,t)};CalendarDate.toggle=function(n){var i=document.getElementById(n.getAttribute("input")),t,e,u,f,r;i&&(t=i.CalendarDate,t&&t._EditEvtTime&&clearTimeout(t._EditEvtTime),t._ToggleHandler=n,e=n.getAttribute("popup").replace("[","\\[").replace("]","\\]"),u=$("#"+e),u.is(":visible")?(i.focused=!1,i.cal_interface=!1,i.type=="text"&&(i.getAttribute("data-ignore-focus-on-empty")!="true"||i.value.length>0)&&i.focus(),$(document.body).off("click",t.onUnboundClick),r=n.up(".CalendarHolder"),r.classList.remove("active"),r.classList.remove("left"),r.classList.remove("bottom"),typeof t.options.onCalendarClose=="function"&&t.options.onCalendarClose.call(this,t,u[0])):(i.focused=!0,i.cal_interface=!0,r=n.up(".CalendarHolder"),r.classList.add("active"),f=$(n.up(".popupContent")),f.length>0&&u.offset().left<f.offset().left&&r.classList.add("left"),function(n){n.onUnboundClick=n.onUnboundClick.bindAsEventListener(n);$(document.body).on("click",n.onUnboundClick)}.defer(t),typeof t.options.onCalendarOpen=="function"&&t.options.onCalendarOpen.call(this,t,u[0])))};CalendarDate.lateBind=function(n){if(n&&n.getAttribute("initparams")){var t;try{t=JSON.parse(n.getAttribute("initparams"))}catch(i){return!1}new CalendarDateSelect("hidden_"+n.querySelector("[datatype]").id,t)}};CalendarDate.Comparer=function(){function n(n,t){return typeof n=="string"?CalendarDate.parse(n,t):isObject(n)&&"value"in n?(t||("format"in n?t=n.format:"getAttribute"in n&&(t=n.getAttribute("data-dateformat"))),CalendarDate.parse(n.value,t)):null}return{isGreaterThan:function(t,i,r){var u=n(t,r),f=n(i,r);return u&&f&&u.isGreaterThan(f)},equals:function(t,i,r){var u=n(t,r),f=n(i,r);return u&&f&&u.equals(f)}}}();CalendarDate.prototype.beginningOfMonth=function(){return new CalendarDate(this.year,this.month,1)};CalendarDate.prototype.beginningOfWeek=function(){var n;return n=CalendarDate.firstDOW<this.date.getUTCDay()?Math.abs(CalendarDate.firstDOW-this.date.getUTCDay()):CalendarDate.firstDOW==this.date.getUTCDay()?7:7-CalendarDate.firstDOW,this.previous(n)};CalendarDate.prototype.next=function(n){return n===0?this:new CalendarDate(this.year,this.month,this.day+(n||1))};CalendarDate.prototype.previous=function(n){return n===0?this:this.next(-(n||1))};CalendarDate.prototype.succ=function(){return this.next()};CalendarDate.prototype.equals=function(n){return this.value==n.value};CalendarDate.prototype.isGreaterThan=function(n){return this.value>n.value};CalendarDate.prototype.isWeekend=function(){var n=this.date.getUTCDay();return n==0||n==6};CalendarDate.prototype.hasVisit=function(n,t){if(!t)return!1;for(var i=0,r;i<t.length;i++)if(t[i]!=""&&(r=t[i].split(";"),r.length>0&&r[0]==n))return!0};CalendarDate.prototype.getMonthName=function(){return CalendarDate.MONTHS[this.month-1]};CalendarDate.prototype.toString=function(n){if(isNaN(this.year)||isNaN(this.month)||isNaN(this.day))return"";if(!this.stringValue||n)if(n){var t,i,r;this.stringValue=n;t=n.match(/d{1,2}/ig);t&&(t=t[0],this.stringValue=this.stringValue.replace(t,t.length>1?this.day<=9?"0"+this.day:this.day:this.day));t=n.match(/M{1,2}/g);t&&(t=t[0],this.stringValue=this.stringValue.replace(t,t.length>1?this.month<=9?"0"+this.month:this.month:this.month),this.stringValue=this.stringValue.replace(/y{1,4}/ig,this.year));t=n.match(/h{1,2}/ig);t&&(i=this.date.getUTCHours(),this.stringValue=this.stringValue.replace(t[0],t[0].length>1?i<=9?"0"+i:i:i));t=n.match(/m{1,2}/g);t&&(r=this.date.getUTCMinutes(),this.stringValue=this.stringValue.replace(t[0],t[0].length>1?r<=9?"0"+r:r:r));this.PM&&(this.stringValue=this.stringValue.replace(/t{1,2}/g,this.PM))}else this.stringValue=this.year+"-"+("0"+this.month).slice(-2)+"-"+("0"+this.day).slice(-2);return this.stringValue.trim()};CalendarDate.prototype.setDateTime=function(n,t){this.date=n;this.year=n.getUTCFullYear();this.month=n.getUTCMonth()+1;this.day=n.getUTCDate();this.hour=n.getUTCHours();this.minute=n.getUTCMinutes();this.second=n.getUTCSeconds();this.PM=t||"";this.value=n.getTime()};CalendarDateSelect.start=function(n,t,i,r){var u,e,f;if(n.nodeName.toLowerCase()=="input"&&n.type=="text"?(u=n.up().querySelector(".CalendarBtn"),n.onfocus=null):(u=n,e=function(){CalendarDate.toggle(u,r)},f=n.up(".CalendarDate").querySelector('[id="'+t+'"]'),f&&f.type=="text"&&f.onfocus!=null&&(f.onfocus=null)),u.getAttribute("data-calendar-init")=="1")return!1;new CalendarDateSelect("hidden_"+t,i,e);u.setAttribute("data-calendar-init","1");u.setAttribute("onclick",'CalendarDate.toggle(this, "'+r+'");')};CalendarDateSelect.selectToday=function(n){var t,i,r;if(n){if(!n.classList.contains("CalendarDate")){if(t=n.up(".CalendarDate"),!t&&(t=n.querySelector(".CalendarDate"),!t))return;n=t}(i=n.querySelector('input[id="'+n.getAttribute("data-val-id")+'"]').CalendarDate,i)&&(r=new CalendarDate(CalendarDate.parse(new Date,i.options.dateFormat)),i.setDate(r))}};CalendarDateSelect.prototype.createElement=function(){this.element=this.field.up().querySelector(".calendar_date_select");this.options.extraClassName&&this.element.classList.add(this.options.extraClassName);this.options.label&&this.element.appendChild(createHtmlElement("label",{"class":"formLabel",innerHTML:this.options.label}));this.header=createHtmlElement("div",{"class":"header"});this.pager=new CalendarDateSelect.Pager(this.cursor,this.options,this);this.header.appendChild(this.pager.toElement());this.element.appendChild(this.header);this.footer=createHtmlElement("div",{"class":"footer"});this.description=createHtmlElement("span");this.updateDescription();this.PreviousYear=createHtmlElement("a",{"class":"prevYear"});EventHandler.addListener(this.PreviousYear,"click",this.pager.previousYear.bind(this.pager));this.PreviousYear.appendChild(createHtmlElement("i",{"class":"icon-min"}));this.footer.appendChild(this.PreviousYear);this.PreviousMonth=createHtmlElement("a",{"class":"prevMonth"});EventHandler.addListener(this.PreviousMonth,"click",this.pager.previous.bind(this.pager));this.PreviousMonth.appendChild(createHtmlElement("i",{"class":"icon-menor"}));this.footer.appendChild(this.PreviousMonth);this.footer.appendChild(this.description);this.NextYear=createHtmlElement("a",{"class":"nextYear"});EventHandler.addListener(this.NextYear,"click",this.pager.nextYear.bind(this.pager));this.NextYear.appendChild(createHtmlElement("i",{"class":"icon-max"}));this.footer.appendChild(this.NextYear);this.NextMonth=createHtmlElement("a",{"class":"nextMonth"});EventHandler.addListener(this.NextMonth,"click",this.pager.next.bind(this.pager));this.NextMonth.appendChild(createHtmlElement("i",{"class":"icon-maior"}));this.footer.appendChild(this.NextMonth);this.element.appendChild(this.footer);this.body=createHtmlElement("div",{"class":"body"});this.updateBody();this.element.appendChild(this.body);$(this.element).on("calendar:cursorChanged",this.onCursorChanged.bind(this));$(this.element).on("calendar:dateSelected",this.onDateSelected.bind(this));$(this.element).on("calendar:fieldChanged",this.onFieldChanged.bind(this))};CalendarDateSelect.prototype.onCursorChanged=function(n,t){if(this.setCursor(t.cursor),typeof t.oncomplete=="function")t.oncomplete(n,t.cursor)};CalendarDateSelect.prototype.onDateSelected=function(n,t){var i,r;if(this.setDate(t.date),i=document.getElementById(this.field.id.replace(/hidden_/ig,"")),i&&t.date.toString().trim()!=""&&(i.removeAttribute("disabled"),r=i.up("input[type=checkbox]"),r&&(r.checked=!0)),document.getElementById(this.options.id)&&(t.date.toString().trim()==""&&(document.getElementById(this.options.id).getAttribute("initval")?this.setDate(""):this.field.getAttribute("initval")&&this.setDate(this.field.getAttribute("initval"))),document.getElementById(this.options.id).value=this.date,document.getElementById(this.options.id).setAttribute("datevalue",this.date.value)),this.options.close){if($(document.body).off("click",this.onUnboundClick),document.getElementById("div_"+this.fieldid)&&document.getElementById("div_"+this.fieldid).up(".CalendarHolder").classList.remove("active"),document.getElementById("show_"+this.fieldid)&&document.getElementById("show_"+this.fieldid).classList.remove("active"),typeof this.options.onChange=="string"&&(this.options.onChange=new Function(this.options.onChange)),typeof this.options.onChange=="function")this.options.onChange(t.date,i);try{document.getElementById(this.fieldid).focus()}catch(n){}}if(typeof t.oncomplete=="function"&&t.elem!=null)t.oncomplete(n,t.elem,t.date)};CalendarDateSelect.prototype.onFieldChanged=function(){this.setDate(CalendarDate.parse($(this.field).val()||"",this.dateFormat));var t=this.options.id.replace("[","\\[").replace("]","\\]"),n=$("#"+t).val()||"";document.getElementById(this.options.id)&&n!=""&&this.setDate(CalendarDate.parse(n,this.dateFormat));this.pager?this.pager.setCursor(this.date):this.setCursor(this.date);this.updateBody()};CalendarDateSelect.prototype.onFieldEdit=function(n){var i=(n.target||n.srcElement).value,t;i.trim()==""?document.getElementById(this.options.id).getAttribute("initval")?this.setDate(CalendarDate.parse("")):this.field.getAttribute("initval")&&this.setDate(CalendarDate.parse(this.field.getAttribute("initval"),this.dateFormat)):(t=CalendarDate.parse(i,this.dateFormat),(isNaN(t.day)||isNaN(t.month)||isNaN(t.year))&&(t=new CalendarDate,t.setDateTime(new Date),this.field.value="",this.field.setAttribute("datevalue",""),document.getElementById(this.options.id).value=""),this.setDate(t),$(document.body).off("click",this.onUnboundClick),document.getElementById("div_"+this.fieldid)&&document.getElementById("div_"+this.fieldid).up(".CalendarHolder").classList.remove("active"),document.getElementById("show_"+this.fieldid)&&document.getElementById("show_"+this.fieldid).classList.remove("active"));this.pager.setCursor(this.date);this.updateBody();typeof this.options.onEdit=="function"&&(this._EditEvtTime&&clearTimeout(this._EditEvtTime),this._EditEvtTime=this.options.onEdit.lazyDo(.15,CalendarDate.parse(i||"0",this.dateFormat),document.getElementById(this.options.id)))};CalendarDateSelect.prototype.setCursor=function(n){this.cursor=n.beginningOfMonth();this.updateBody()};CalendarDateSelect.prototype.setDate=function(n){var t;n.isCalendarDate?t=n:(t=new CalendarDate,typeof n=="object"&&t.setDateTime(n));this.date=t;$(this.field).val(this.date.toString(this.dateFormat));this.updateDescription()};CalendarDateSelect.prototype.updateBody=function(){this.body&&(this.grid=new CalendarDateSelect.Grid(this.date,this.cursor,this.options),this.body.html(this.grid.element))};CalendarDateSelect.prototype.updateDescription=function(n){this.description&&(n||(n=this.date),this.description.innerHTML=n.getMonthName()+", "+n.year)};CalendarDateSelect.prototype.toElement=function(){return this.element};CalendarDateSelect.prototype.onUnboundClick=function(n){var t=n.target||n.srcElement;t.classList.contains("calendar_date_select")||(t=t.up(".calendar_date_select"));t!=this.body.up(".calendar_date_select")&&($(document.body).off("click",this.onUnboundClick),this._ToggleHandler?CalendarDate.toggle(this._ToggleHandler):$(this.element).trigger("calendar:dateSelected",{date:this.date}))};CalendarDateSelect.prototype.enable=function(){var t=this.field.up(".CalendarDate"),n;t&&(t.toggleClass("Disabled",!1),document.getElementById(this.fieldid).disabled=!1,n=t.querySelector(".CalendarBtn"),!n.onclick&&n.ondisabledclick&&(n.onclick=n.ondisabledclick))};CalendarDateSelect.prototype.disable=function(){var t=this.field.up(".CalendarDate"),n;t.length>0&&(t.toggleClass("Disabled",!0),document.getElementById(this.fieldid).disabled=!0,n=t.querySelector(".CalendarBtn"),n.onclick&&(n.ondisabledclick=n.onclick,n.onclick=null))};CalendarDateSelect.prototype.setTime=function(n,t){var r=this.pager.element,i,f,u;r&&(this.date.PM&&(i=r.querySelector(".ampm"),i&&(i.selectedIndex=0),n==12?i&&(i.selectedIndex=1):n>12&&(n=n-12,i&&(i.selectedIndex=1))),f=r.querySelector(".minutes"),f&&(f.value=t),u=r.querySelector(".hours"),u&&(u.value=n,$(u).trigger("change")))};CalendarDateSelect.Pager=function(n,t,i){this.ctx=i;this.cursor=n;this.pagerRange=[];t&&t.minYearRange?this.pagerRange.push(t.minYearRange):this.pagerRange.push(50);t&&t.maxYearRange?this.pagerRange.push(t.maxYearRange):this.pagerRange.push(2);this.createElement(t)};CalendarDateSelect.Pager.prototype.onButtonClicked=function(n){var i=n.target||n.srcElement,t=i.up("a[method]");t&&(this[t.getAttribute("method")](),stopEventPropagation(n))};CalendarDateSelect.Pager.prototype.onSelectChanged=function(){if(this.select)this.setCursor(CalendarDate.parse($(this.select).val()));else if(this.YearSelect&&this.MonthSelect){var n=new CalendarDate(CalendarDate.parse($(this.YearSelect).val()||"").year,CalendarDate.parse($(this.MonthSelect).val()||"").month,1);this.setCursor(n)}};CalendarDateSelect.Pager.prototype.previous=function(){if(this.select)this.setCursor(this.cursor.beginningOfMonth().previous());else if(this.YearSelect&&this.MonthSelect){this.cursor.beginningOfMonth().previous();var n=this.cursor.beginningOfMonth().previous();this.setCursor(new CalendarDate(n.year,n.month,1))}};CalendarDateSelect.Pager.prototype.next=function(){if(this.select)this.setCursor(CalendarDate.parse($(this.select).val()||""));else if(this.YearSelect&&this.MonthSelect){var n=new CalendarDate(CalendarDate.parse($(this.YearSelect).val()||"").year,CalendarDate.parse($(this.MonthSelect).val()||"").month+1,1);this.setCursor(n)}};CalendarDateSelect.Pager.prototype.previousYear=function(){if(this.select)this.setCursor(CalendarDate.parse($(this.select).val()||""));else if(this.YearSelect&&this.MonthSelect){var n=new CalendarDate(CalendarDate.parse($(this.YearSelect).val()||"").year-1,CalendarDate.parse($(this.MonthSelect).val()||"").month,1);this.setCursor(n)}};CalendarDateSelect.Pager.prototype.nextYear=function(){if(this.select)this.setCursor(CalendarDate.parse($(this.select).val()||""));else if(this.YearSelect&&this.MonthSelect){var n=new CalendarDate(CalendarDate.parse($(this.YearSelect).val()||"").year+1,CalendarDate.parse($(this.MonthSelect).val()||"").month,1);this.setCursor(n)}};CalendarDateSelect.Pager.prototype.setCursor=function(n){n=n.beginningOfMonth();$(this.element).trigger("calendar:cursorChanged",{cursor:n,oncomplete:$.proxy(function(n,t){if(!n.stopped){var i=this.cursor;this.cursor=t;this.select?this.updateSelect(i):this.YearSelect&&this.MonthSelect&&(this.updateYearSelect(i),this.updateMonthSelect(i));this.ctx&&this.ctx.updateDescription&&this.ctx.updateDescription(t)}},this)})};CalendarDateSelect.Pager.prototype.updateSelect=function(n){var r,t,u,i,f;if(n&&this.cursor.year==n.year)this.select.selectedIndex=this.months.pluck("value").indexOf(this.cursor.value);else for(this.months=this.getDatesForSurroundingMonths(),this.select.options.length=0,r=this.getDatesForSurroundingMonths(),t=0,u=r.length;t<u;t++)i=r[t],f=[i.getMonthName().slice(0,3),i.year].join(" "),this.select.options[t]=new Option(f,i.toString()),this.cursor.equals(i)&&(this.select.selectedIndex=t)};CalendarDateSelect.Pager.prototype.updateYearSelect=function(n){var i,u,t,f,r,e,o;if(n&&this.cursor.year==n.year)o=new CalendarDate(this.cursor.year,1,1),this.YearSelect.selectedIndex=this.years.pluck("value").indexOf(o.value);else for(this.years=this.getDatesForSurroundingYears(),this.YearSelect.options.length=0,i=this,u=this.getDatesForSurroundingYears(),t=0,f=u.length;t<f;t++)r=u[t],e=r.year,i.YearSelect.options[t]=new Option(e,r.toString()),i.cursor.year==r.year&&(i.YearSelect.selectedIndex=t)};CalendarDateSelect.Pager.prototype.updateMonthSelect=function(n){var t,i,r,u;if(n&&this.cursor.month==n.month)u=new CalendarDate(1970,this.cursor.month,1),this.MonthSelect.selectedIndex=this.months.pluck("value").indexOf(u.value);else for(this.months=this.getDatesForSurroundingOnlyMonths(),this.MonthSelect.options.length=0,t=0,i=this.months.length;t<i;t++)r=this.months[t].getMonthName().slice(0,3),this.MonthSelect.options[t]=new Option(r,this.months[t].toString()),this.cursor.month==this.months[t].month&&(this.MonthSelect.selectedIndex=t)};CalendarDateSelect.Pager.prototype.getDatesForSurroundingMonths=function(){return[].concat.apply([],[this.cursor.year-2,this.cursor.year-1,this.cursor.year,this.cursor.year+1,this.cursor.year+2].map(function(n){return[1,2,3,4,5,6,7,8,9,10,11,12].map(function(t){return new CalendarDate(n,t,1)})}))};CalendarDateSelect.Pager.prototype.getDatesForSurroundingOnlyMonths=function(){return[].concat.apply([],[1,2,3,4,5,6,7,8,9,10,11,12].map(function(n){return new CalendarDate(1970,n,1)}))};CalendarDateSelect.Pager.prototype.getDatesForSurroundingYears=function(){for(var t=[],n=this.cursor.year-this.pagerRange[0];n<this.cursor.year+this.pagerRange[1];++n)t.push(new CalendarDate(n,1,1));return t};CalendarDateSelect.Pager.prototype.toElement=function(){return this.element};CalendarDateSelect.Pager.prototype.createElement=function(n){var s="pager",r,o,e,i,f,t,u;if(n.showDateControls||(s+=" hiddenControls"),this.element=createHtmlElement("div",{"class":s}),this.YearSelect=createHtmlElement("select",{"class":"year dropDown"}),this.updateYearSelect(),EventHandler.addListener(this.YearSelect,"change",this.onSelectChanged.bind(this)),this.element.appendChild(this.YearSelect),this.MonthSelect=createHtmlElement("select",{"class":"months dropDown"}),this.updateMonthSelect(),EventHandler.addListener(this.MonthSelect,"change",this.onSelectChanged.bind(this)),this.element.appendChild(this.MonthSelect),n.renderClock){if(r=createHtmlElement("div",{"class":"chooseHourMinute"}),n.setOnChangeTimeEvent&&(e=function(t){var i=t.element?t.element.querySelector(".body"):null,r=i?i.querySelector(".selected"):null;!r&&t.date&&(t.pager.setCursor(t.date),i=t.element?t.element.querySelector(".body"):null,r=i?i.querySelector(".selected"):null);n.close=!1;t.grid.selectDate(r)}.bind(null,this.ctx,this.element)),i=createHtmlElement("select",{"class":"hours dropDown"}),n.setOnChangeTimeEvent)$(i).on("change",e);if(this.ctx.date.PM){for(t=1;t<=12;t++)i.options[t-1]=new Option(t.toString(),t.toString());i.selectedIndex=this.ctx.date.hour-1}else{for(t=0;t<=23;t++)i.options[t]=new Option(t.toString(),t.toString());i.selectedIndex=this.ctx.date.hour}if(r.appendChild(i),r.appendChild(createHtmlElement("div",{"class":"input-interval-spacer",innerHTML:":"})),f=createHtmlElement("select",{"class":"minutes dropDown"}),n.setOnChangeTimeEvent)$(f).on("change",e);for(t=0;t<60;t++)f.options[t]=new Option(t.toString(),t.toString());if(f.selectedIndex=this.ctx.date.minute,r.appendChild(f),this.ctx.date.PM){if(r.appendChild(createHtmlElement("div",{"class":"input-interval-spacer",innerHTML:":"})),u=createHtmlElement("select",{"class":"ampm dropDown"}),n.setOnChangeTimeEvent)$(u).on("change",e);u.options[0]=new Option("am","am");u.options[1]=new Option("pm","pm");u.selectedIndex=this.ctx.date.PM.indexOf("a")>=0?0:1;r.appendChild(u)}if(o=document.getElementById(n.id),$(o).attr("hourvalue")){if(r.appendChild(createHtmlElement("span",{innerHTML:o.getAttribute("until")})),n.setOnChangeTimeEvent&&(e=function(n){var t=n.element?n.element.querySelector(".body"):null,i=t?t.querySelector(".selected"):null;!i&&n.date&&(n.pager.setCursor(n.date),t=n.element?n.element.querySelector(".body"):null,i=t?t.querySelector(".selected"):null);n.grid.selectDate(i)}.bind(null,this.ctx,this.element)),i=createHtmlElement("select",{"class":"hours dropDown",id:"_taskEndHour"}),n.setOnChangeTimeEvent)$(i).on("change",e);if(this.ctx.date.PM){for(t=1;t<=12;t++)i.options[t-1]=new Option(t.toString(),t.toString());i.selectedIndex=Math.min(parseInt($(o).attr("hourvalue")),12)}else{for(t=0;t<=23;t++)i.options[t]=new Option(t.toString(),t.toString());i.selectedIndex=Math.min(parseInt($(o).attr("hourvalue"))+1,23)}if(r.appendChild(i),r.appendChild(createHtmlElement("div",{"class":"input-interval-spacer",innerHTML:":"})),f=createHtmlElement("select",{"class":"minutes dropDown",id:"_taskEndMin"}),n.setOnChangeTimeEvent)$(f).on("change",e);for(t=0;t<60;t++)f.options[t]=new Option(t.toString(),t.toString());if(f.selectedIndex=$(o).attr("minvalue"),r.appendChild(f),this.ctx.date.PM){if(r.appendChild(createHtmlElement("div",{"class":"input-interval-spacer",innerHTML:":"})),u=createHtmlElement("select",{"class":"ampm dropDown"}),n.setOnChangeTimeEvent)$(u).on("change",e);u.options[0]=new Option("am","am");u.options[1]=new Option("pm","pm");u.selectedIndex=this.ctx.date.PM.indexOf("a")>=0?0:1;r.appendChild(u)}}this.element.appendChild(createHtmlElement("label",{"class":"formLabel",innerHTML:o.getAttribute("hour")}));this.element.appendChild(r)}};CalendarDateSelect.Grid=function(n,t,i){this.date=CalendarDate.parse(n);this.cursor=CalendarDate.parse(t).beginningOfMonth();this.today=CalendarDate.parse();this.options=i;this.createElement(i)};CalendarDateSelect.Grid.prototype.createElement=function(n){var o=createHtmlElement("table"),s=createHtmlElement("tbody"),t=[],u,f,i,e,r;for(t.push('<tr class="weekdays">'),u=CalendarDate.firstDOW,i=0;i<CalendarDate.WEEKDAYSABR.length;i++)t.push('<th style="min-width: 5px; text-align: center;">',CalendarDate.WEEKDAYSABR[u].substring(0,2),"<\/th>"),++u>=CalendarDate.WEEKDAYSABR.length&&(u=0);for(t.push("<\/tr>"),f=this.getWeeks(),i=0;i<f.length;++i){for(t.push('<tr class="days">'),e=0;e<f[i].length;++e)r=CalendarDate.parse(f[i][e],this.dateFormat),t.push('<td class="',this.getClassNamesForDate(r,n).join(" ")),t.push('" title="',this.getTitleForDate(r,n)),t.push('" date="',r.toString(this.dateFormat),'" style="width: 5px;"><a href="javascript:void(0);" onclick="return false;">',r.day,"<\/a><\/td>");t.push("<\/tr>")}return s.innerHTML=t.join(""),o.appendChild(s),EventHandler.addListener(o,"click",this.onDateClicked.bind(this)),this.element=o};CalendarDateSelect.Grid.prototype.getStartDate=function(){return this.cursor.beginningOfWeek()};CalendarDateSelect.Grid.prototype.getEndDate=function(){return this.getStartDate().next(41)};CalendarDateSelect.Grid.prototype.getDates=function(){for(var t=[],n=this.getStartDate(),i=this.getEndDate().date;n.date<=i;)t.push(n),n=n.succ();return t};CalendarDateSelect.Grid.prototype.getWeeks=function(){for(var n=this.getDates(),t=[];n.length>0;)t.push(n.splice(0,7));return t};CalendarDateSelect.Grid.prototype.getClassNamesForDate=function(n,t){var i=[];return n.equals(this.today)&&i.push("today"),n.equals(this.date)&&i.push("selected"),n.isWeekend()&&i.push("weekend"),n.hasVisit(n,t)&&i.push("visit"),n.beginningOfMonth().equals(this.cursor)||i.push("other"),i};CalendarDateSelect.Grid.prototype.getTitleForDate=function(n,t){var i,r;if(!t)return"";for(i=0;i<t.length;i++)if(t[i]!=""&&(r=t[i].split(";"),r.length>0&&r[0]==n))return r[1]?CalendarDate.VISIT_REALESTATE+": "+r[1]:CalendarDate.VISIT_REALESTATE;return""};CalendarDateSelect.Grid.prototype.onDateClicked=function(n){this.options.close=!0;var i=n.target||n.srcElement,t=i.up("td[date]");t&&(this.selectDate(t,this.options.resetTime),stopEventPropagation(n))};CalendarDateSelect.Grid.prototype.selectDate=function(n,t){var i=CalendarDate.parse(n.getAttribute("date")),r=n.up("div").up("div").querySelector(".ampm"),u,e,o,f,h,s;t?(u=new Date(Date.UTC(i.date.getUTCFullYear(),i.date.getUTCMonth(),i.date.getUTCDate(),0,0,0)),i.setDateTime(u,r?r.value:"")):(e=n.up("div").up("div").querySelector(".hours"),o=n.up("div").up("div").querySelector(".minutes"),e&&o&&(f=e.value,h=o.value,r&&(s=r.value,s.indexOf("am")==0&&parseInt(f)==12&&(f=0)),u=new Date(Date.UTC(i.date.getUTCFullYear(),i.date.getUTCMonth(),i.date.getUTCDate(),f,h)),i.setDateTime(u,s)));$(n).trigger("calendar:dateSelected",{date:i,oncomplete:$.proxy(function(n,t,i){if(!n.stopped){var r=this.element.up("div").querySelector("td.selected");r&&r.toggleClass("selected",!1);this.selectedElement=t;this.date=i;t.toggleClass("selected",!0)}},this),elem:n})};CalendarDateSelect.Grid.prototype.toElement=function(){return this.element};var TimeFilter=function(){function n(n,t){for(var i=n.up(),r=i.querySelector(t),u=1;!r&&u<o;){if(i=i.up(),!i)break;r=i.querySelector(t);u++}return r}function f(n){return n&&n.nodeName.toLowerCase()==="select"}function e(n,t,i){if(n&&t){for(var u=t.up(),r=n;r.up()!=u;)if(r=r.up(),r.nodeName.toLowerCase()==="body"){r=null;break}r&&r[i?"show":"hide"]()}}function t(n){return'[id="'+s+n+'"]'}function c(n){return'[id="'+u+n+'"]'}function l(n){return'[id="'+h+n+'"]'}var i="-1",o=3,r="data-selected-index",s="TimeIntervalDrop_",u="TimeInterval_",h="TimeCalendar_";return{initDropdowns:function(){document.querySelectorAll(".TimeInterval:not(.DropdownConfigured)").forEach(function(i){var e=i.id.substring(u.length),f=n(i,t(e));f&&(EventHandler.addListener(f,"focus",function(){var n=this;n.setAttribute(r,n.selectedIndex.toString())}),i.addClassName("DropdownConfigured"),f.addClassName("DropdownConfigured"))})},toggleInterval:function(u,o,s){var l,h;f(u)?u.value==i?(l=u,h=n(l,c(o)),h.show(),e(l,h,!1)):typeof s=="function"&&s(u):(h=u.up(".TimeInterval"),h.querySelectorAll("input.CalendarDateVal").invoke("setValue",""),h.hide(),l=n(h,t(o)),l.selectedIndex=parseInt(l.getAttribute(r))||0,e(l,h,!0))},toggleCalendar:function(n,r,u){var o,e;f(n)?n.value==i?(o=n.up(),e=o.up().querySelector(l(r)),e.up().show(),o.hide()):typeof u=="function"&&u(n):(e=n.up(),e=e.up(),e.hide(),o=e.up().querySelector(t(r)),o.selectedIndex=0,o.up().show())}}}(),Layout=function(){function u(n){if(window.innerWidth<=1366){n.classList.remove("focus");$(".subMenuIconsGroup").fadeOut("fast");var t=document.querySelector("#SubMenuManager #SubMenuControl");t&&(t.innerHTML=t.getAttribute("data-expand"));Cookie.remove(n.up("#SubMenuManager").getAttribute("data-cookie-name"))}}function t(n){var t=document.querySelector("#SubMenuManager #SubMenuAnchor"),i;t&&(n?(t.classList.remove("focus"),Cookie.remove(t.up("#SubMenuManager").getAttribute("data-cookie-name"))):(t.classList.add("focus"),i=t.up("#SubMenuManager"),Cookie.set(i.getAttribute("data-cookie-name"),1,i.getAttribute("data-cookie-duration"))),t.getAttribute("data-dcb")!="1"&&(EventHandler.addListener(document.body,"click",function(n){if(n&&n.target&&(document.getElementById("SideMenu").contains(n.target)||n.target.up("#SideMenu")))return!1;Layout.subMenuBlur(document.querySelector("#SubMenuManager #SubMenuAnchor"))}),t.setAttribute("data-dcb","1")))}function i(n){var t=document.querySelector("#SubMenuManager #SubMenuControl"),i;t&&(n?(t.innerHTML=t.getAttribute("data-expand"),Cookie.remove(t.up("#SubMenuManager").getAttribute("data-cookie-name"))):(t.innerHTML=t.getAttribute("data-collapse"),i=t.up("#SubMenuManager"),Cookie.set(i.getAttribute("data-cookie-name"),1,i.getAttribute("data-cookie-duration"))))}var n=null,r={logout:function(n,t,i){n.getAttribute("ajaxrequest")||(n.setAttribute("ajaxrequest","true"),$.ajax(t,{method:"GET",beforeSend:function(){Loading.show()},success:function(){window.location=i},complete:function(){Loading.hide();n.removeAttribute("ajaxrequest")}}))},subMenuToggle:function(n){n.classList.contains("focus")?(n.classList.remove("focus"),$(".subMenuIconsGroup").stop().fadeOut("fast"),i(!0)):(n.classList.add("focus"),$(".subMenuIconsGroup").stop().fadeIn(),i(!1))},subMenuBlur:function(t){n=setTimeout(u,400,t)},headerDropClick:function(n,t){$(t).stop().slideToggle({complete:function(){var i=n.up(".headerUser");i&&(i.classList.add("active"),EventHandler.addListener(document.body,"click",function(){Layout.headerDropClose(t)}))}})},headerDropClose:function(n,t){$(t).stop().delay(150).slideUp({complete:function(){var i=n.up(".headerUser");i&&(i.classList.remove("active"),EventHandler.removeListener(document.body,"click",function(){Layout.headerDropClose(t)}))}})},menuLinkClick:function(t){n&&clearTimeout(n);t&&$("#"+t).stop().slideToggle()},menuLinkBlur:function(){Layout.subMenuBlur(document.getElementById("SubMenuAnchor"))},getGlobalCounters:function(n){ajaxRequest(null,n,"GET",null,function(n){var i=document.getElementById("newTicketCount"),t,r;(i&&(n&&n.data&&parseInt(n.data.tickets)>0?(i.innerHTML=n.data.tickets,i.style.display="block"):i.style.display="none"),t=document.getElementById("newMessageCount"),t)&&(n&&n.data&&parseInt(n.data.count)>0?(r="block",t.innerHTML=n.data.count):(r="none",t.innerHTML=0),t.up(".messageCount").style.display=r)},{hideLoading:!0})},switchLanguagePopup:function(n,t){ajaxRequest(n,t,"GET",null)},switchLanguagePopupItemClick:function(n){for(var i=n.parentNode.querySelectorAll("a"),t=0;t<i.length;t++)i[t].classList.remove("active");n.classList.add("active")},switchLanguage:function(n,t){var i="Language="+n.up(".popupBox").querySelector("a.active").getAttribute("data-value");ajaxRequest(n,t,"POST",i,function(n){n&&n.status==1&&window.location.reload(!0)})},toggleMenuMobile:function(n){if(n.getAttribute("data-working")=="1")return!1;n.setAttribute("data-working","1");n.classList.contains("open")?(n.classList.remove("open"),$("#SideMenu").stop().animate({left:"-100%"})):(n.classList.add("open"),$("#SideMenu").stop().animate({left:"0"}));n.setAttribute("data-working","0")}};return r.Menu=function(){var n=function(n){for(var r,u,i=n.children,t=0;t<i.length;t++)r=i[t].querySelector(".checkboxLineRight").firstElementChild,u=i[t].querySelector(".checkboxLineRight").lastElementChild,r.style.display=t==0?"none":"",u.style.display=t<i.length-1?"":"none"};return{toggle:function(n){var i=n.parentNode.previous();n.innerHTML==n.getAttribute("data-collapse")?(n.innerHTML=n.getAttribute("data-expand"),$(i).stop().slideUp(),t(!0)):(n.innerHTML=n.getAttribute("data-collapse"),$(i).stop().slideDown().css("display","block"),t(!1))},openPopup:function(t,i){ajaxRequest(t,i,"GET",null,function(){var t=Popup.current().querySelector(".listCheckBoxLines");$(t).sortable();$(t).on("sortstop",function(){n(t)})})},itemMoveUp:function(t){var i=t.up(".checkboxLine"),r=i.parentNode,u=i.previous();r.insertBefore(i.cloneNode(!0),u);i.remove();n(r)},itemMoveDown:function(t){var i=t.up(".checkboxLine"),r=i.parentNode,u=i.next().next();r.insertBefore(i.cloneNode(!0),u);i.remove();n(r)},save:function(n,t,i){for(var u,f=[],e=n.up(".popupBox").querySelector(".listCheckBoxLines").children,r=0;r<e.length;r++)u=e[r].getAttribute("data-value"),u&&f.push(u);Cookie.set(t,f.join(","),i);Popup.close();window.location.reload()},getCounters:function(n){ajaxRequest(null,n,"GET",null,null,{hideLoading:!0})},toggleShrunkDisplay:function(n){Element.toggleClassName(document.body.queryChildren(".content").first(),"maxWidthContent",n)}}}(),r}(),ManageConfig=function(){function e(n,t){var r=n.classList.contains("popupBox")?n.querySelector(".popupContent"):n.up(".popupContent"),i;return(r&&(i=r.querySelector(".ConfigInlineEdit_ItemTemplate")),!i||!i.innerHTML)?null:htmlStringToElement(compressText(i.innerHTML).replace("{force_remove}",t?"1":""))}function b(n){var i=n.up(".popupContent"),t=null;return(i&&(t=i.querySelector(".ConfigInlineEdit_ItemTemplate")),!t||!t.innerHTML)?null:htmlStringToElement(compressText(t.innerHTML))}function o(n,t,i){var r=n.querySelector("."+i),u=t.querySelector("."+i);r&&u&&(r.value=u.value)}function l(n,t){var i=n.up(".etp_list_item_edit"),r=i.querySelectorAll(".InlineNameEdit").find(function(n){return n.value&&n.value!=n.getAttribute("data-og-name")});r?typeof t=="function"&&t(n.up(".etp_list_item"),i):$(i).find(".InlineNameEdit:visible").trigger("focus")}function a(n){return n.status==ajaxRequest.StatusType.Success&&isObject(n.data)&&n.data.item?htmlStringToElement(compressText(n.data.item)):null}function f(n){return n?n.classList.contains("etp_list_item")?n:n.up(".etp_list_item"):null}function k(n){return n?n.classList.contains("etp_list_item_edit")?n:n.up(".etp_list_item_edit"):null}function v(n){var t,i;if(n.hasAttribute("data-group-tag"))t=n.getAttribute("data-group-tag");else{if(i=f(n),!i){console.error("ManageConfig[_getConfigGroup]: configItem nao encontrado.");console.log(n);return}t=i.getAttribute("data-group-tag")}if(!t){console.warn("ManageConfig[_getConfigGroup]: groupTag nao encontrada.");console.log(n);return}return n.up('.ConfigGroup[data-config-group="'+t+'"]')}function y(n,t){var i;return t&&t.classList.contains("etp_list_item")&&(i=f(n)),i||(i=k(n)),i}function p(n,t){n.appendChild(t);n.up(".popupContent").scrollTop=$(n).height();setTimeout(function(){highlightNode(t)},200)}function i(n,i,r,f,e){if(!r)return!1;MessageBox.confirm(r,Translations.get(Translations.keys.Delete),function(){var r=appendStringParams($(n.up(".etp_list_item_header")).find("*").serializeAll(),t.serializeMain(n));r=appendStringParams(r,t.serializeLine(n));ajaxRequest(n,i,"POST",r,function(t){if(t.status==ajaxRequest.StatusType.Success){typeof f=="function"&&f(t);var i=n.up(".etp_list_item");i&&(i.remove(),u=!0);typeof e=="function"&&e(t)}})})}function w(n,t){return n?t?(n.childNodes.length?n.insertBefore(t,n.childNodes[0]):n.appendChild(t),$(n).is(":visible")||n.show(),!0):(console.error("ManageConfig[_addAsFirstChild]: elem invalido ou nao fornecido."),console.log(n),!1):(console.error("ManageConfig[_addAsFirstChild]: target invalido ou nao fornecido."),console.log(n),!1)}function r(n,t){(n instanceof jQuery&&(n=n.get(0)),n)&&(typeof t!="boolean"&&(t=!n.classList.contains("active")),n.classList.toggle("active",t),$(n).children(".VisibilityCheckValue:first").val(t?"on":""))}function s(n,t){var i;return i=t?function(n){return n&&n.classList.contains("active")}:function(n){return n},n.querySelectorAll(".etp_list_item").map(function(n){return n.querySelector(".VisibilityMarker")}).filter(i)}var u=!1,h="data-sublevel",c="data-visibility",t=function(){function n(n,t,i){var r=n?n.querySelector(t):null;return r?typeof i==typeof Function&&i(r)?"":$(r).find(":input").serializeAll()||"":""}function t(t,i){return t?n(t.classList.contains("etp_list_item")?t:t.up(".etp_list_item"),"."+i+" > .PrivateData",null):""}return{serializeMain:function(t){return t?n(t.up(".PopupContext,.popupBox"),".PrivateData",function(n){return n.up(".LinePrivateData")||n.up(".EditorPrivateData")||n.up(".GroupPrivateData")}):""},serializeGroup:function(t){return t?n(t.up(".ConfigGroup"),".GroupPrivateData > .PrivateData"):""},serializeLine:function(n){return t(n,"LinePrivateData")},serializeEditor:function(n){return t(n,"EditorPrivateData")}}}(),n={openTab:function(n){if(n.getAttribute("data-working")=="1")return!1;n.setAttribute("data-working","1");n.parentNode.classList.toggle("active");n.classList.toggle("active");Tabs.CollapsingPane.toggle(n);n.setAttribute("data-working","0")},saveInline:function(n,i,r,f){l(n,function(e,o){var c=null,l,s;e&&(c=e.querySelector(".etp_list_item_header input[type=checkbox]"));l=inputIsChecked(c);s=appendStringParams($(o).find("*").serializeAll(),t.serializeMain(o));s=appendStringParams(s,t.serializeLine(e||o));s=appendStringParams(s,t.serializeEditor(e||o));s=appendStringParams(s,t.serializeGroup(e||o));s=appendStringParams(s,f);ajaxRequest(n,i,"POST",s,function(t){var f;if(t.status==ajaxRequest.StatusType.Success){if(u=!0,f=a(t),f){var s=n.up(".collapsingContent,.collapsingLine"),i=y(n,f),o=f.querySelector("input[type=checkbox]");o&&e&&(o.checked=l);i&&i.hasAttribute(h)?(i.up().insertBefore(f,i),i.remove()):(i&&i.remove(),p(s,f))}typeof r=="function"&&r(e,t)}})})},cancelEditInline:function(n,t,i){var r;t?n.up(".etp_list_item_edit").remove():(r=n.up(".etp_list_item"),i&&$(r.querySelector(".FlagSelector")).click(),$(r.querySelector(".etp_list_item_edit")).hide(),$(r.querySelector(".etp_list_item_header")).show())},editInline:function(n){var s=n.up("[data-item-name]").getAttribute("data-item-name"),u=n.up(".etp_list_item"),f=n.up(".etp_list_item_header"),i=u.querySelector(".etp_list_item_edit"),r,t;if(!i){if(i=e(n),!i)return!1;f.parentNode.appendChild(i)}if(r=i.querySelectorAll(".InlineNameEdit"),r.length==1)t=r[0],t.classList.contains("MainTextBox")||t.classList.add("MainTextBox");else if(r.length>1)r.forEach(function(n){n.classList.contains("MainTextBox")?t=n:n.hide()}),t.style.display=="none"&&t.show();else{console.warn("ManageConfig.editInline perdeu acesso a caixa de texto para edicao. fail-safe sera aplicado na proxima tentativa de edicao.");return}t.setAttribute("data-og-name",s);f&&f.hide();t.value=s;i.show();t.focus();o(i,u,"itemID");o(i,u,"itemType")},deleteInline:function(n,t,r){i(n,t,r)},addInlineItem:function(n){var r=n.up(".collapsingLine"),i=null,t;if(r&&(i=n.up(".collapsingLine").querySelector(".collapsingContent")),i){if(t=e(n,!0),!w(i,t)){console.warn("ManageConfig.addInlineItem: falha a adicionar o novo item como first child.");return}t.show();$(t.querySelector(".InlineNameEdit.MainTextBox")).trigger("focus");o(t,n.parentNode,"itemType")}},addInlineItemAfter:function(n,t,i){var o=n.up(".collapsingLine"),u=null,r,f,e;o&&(u=document.getElementById(t));u&&(r=b(n),r.setAttribute(h,"true"),f=r.querySelector(".itemID"),f&&(e=createHtmlElement("input",{type:"hidden",name:i,value:t}),$(e).insertAfter(f)),$(r).insertAfter(u),$(r).show(),highlightNode(r),$(r.querySelector(".InlineNameEdit.MainTextBox")).trigger("focus"))},onCloseInlinePopup:function(){u&&window.location.reload(!0)},changeOrder:function(n,t,i){var r=appendStringParams($(n.up(".etp_list_item_header")).find("*").serializeAll(),i);ajaxRequest(n,t,"POST",r,function(){})},changeVisibility:function(n,i){var u=f(n),o,e,h;if(!u){console.error("ManageConfig.changeVisibility: configItem nao encontrado.");console.log(n);return}r(n);o=function(){var n=v(u),t;n&&(t=s(n,!0).length?!0:!1,r(n.querySelector(".GroupMarker.VisibilityMarker"),t))};i?(e=appendStringParams($(n).find("*").serializeAll(),t.serializeMain(u)),e=appendStringParams(e,t.serializeLine(u)),h={onError:function(){r(n)}},ajaxRequest(n,i,"POST",e,function(n){n.status===ajaxRequest.StatusType.Success?o():h.onError()},h)):o()},changeGroupVisibility:function(n,i){var e,h,u,o,c;(r(n),e=v(n),h=n.classList.contains("active"),s(e).forEach(function(n){r(n,h)}),i)&&(u=e.up(),o=[],u.querySelectorAll(".ConfigGroup").forEach(function(n){s(n).forEach(function(n){var t=f(n),i=t.getAttribute("data-item"),r=n.classList.contains("active");o.push({id:i,isVisible:r})})}),c=appendStringParams(t.serializeMain(u),Requests.getPair(Requests.keys.Items,JSON.stringify(o))),ajaxRequest(u,i,"POST",c))}};return n.ProfileFields=function(){return{save:function(n,t){var i=$(n.up(".popupBox")).find("#ManageProfileFields *").serializeAll();ajaxRequest(n,t,"POST",i,function(n){n.status==ajaxRequest.StatusType.Success&&isObject(n.data)&&(Popup.close(!0),n.data.searchUrl?Search.listItems(null,n.data.searchUrl):n.data.updateUrl&&n.data.updateParams?ajaxRequest(null,n.data.updateUrl,"GET",n.data.updateParams):document.location.reload())})}}}(),n.Notifications=function(){function n(n){document.getElementsByClassName(n).forEach(function(n){var t=n.getAttribute("data-defaultclick"),i=n.getAttribute("onclick");t&&i!=t&&n.setAttribute("onclick",t)})}return{saveInline:function(t,i,r){ManageConfig.saveInline(t,i,function(){n(r)})},deleteInline:function(t,r,u,f){i(t,r,u,null,function(t){t.status==ajaxRequest.StatusType.Success&&n(f)})}}}(),n.EmailTemplates=function(){function t(n){var t=document.getElementById("EmailTemplatePopup"),i;if(!t){console.warn('ManageConfig.EmailTemplates[_setupMediaUpload] nao executou a Media.setupUpload() por falta de popupLayer com ID = "EmailTemplatePopup".');return}i=t.querySelector("#EmailTemplateMedia");Media.setupUpload(i,n,[],t)}var n=0;return{popup:function(n,i,r,u,f){ajaxRequest(n,i,"GET",r,function(n){n.status==ajaxRequest.StatusType.Success&&t(u)},f)},"delete":function(n,t,i){ajaxRequest(n,t,"POST",i,function(t){t.status==ajaxRequest.StatusType.Success&&n.up(".contentListItem").remove()})},add:function(n,i){var r=n.up("#EmailTemplatePopup"),u=r.querySelector("#NewTemplateName"),e=r.querySelector("#EmailTemplateMedia"),f=e.querySelector(".AttachList");if(u.value)u.value=HtmlUtility.sanitize(u.value);else return MessageBox.alert(Translations.get(Translations.keys.WarningNameEmpty)),!1;if(!f.MyMedia||f.MyMedia.ItemList.length<=0)return MessageBox.alert(Translations.get(Translations.keys.MustChooseTemplate)),!1;var o=$(e).find("*").serializeAll()||"",s=Requests.get(Requests.keys.Medias)+"="+f.MyMedia.serialize(!0),h=appendStringParams(o,s);ajaxRequest(r,i,"POST",h,function(n){n.status==ajaxRequest.StatusType.Success&&isObject(n.data)&&typeof n.data.mediaUploadHtml=="string"&&typeof n.data.mediaUrl=="string"&&(u.value="",Media.replaceUploaderHtml(r.querySelector("#EmailTemplateMedia"),n.data.mediaUploadHtml),t(n.data.mediaUrl))})},storeTemplateCount:function(){n=$("#EmailTemplatePopup #TemplateList > .contentListItem").length},changedTemplateCount:function(){return $("#EmailTemplatePopup #TemplateList > .contentListItem").length!=n}}}(),n.FastEdit=function(){return{save:function(n,t){var i=$(n.up("#PopupMgmtFastEdit")).find("*").serializeAll()||"";ajaxRequest(n,t,"POST",i,function(n){n.status==ajaxRequest.StatusType.Success&&isObject(n.data)&&n.data.url&&(Popup.registerCallbacks(new Popup.LayerOptions(null,null,null,function(){Popup.close();Realestate.FastEdit.open(null,n.data.url)}),0),Popup.close())})}}}(),n.FastFiltersEdit=function(){function n(n){var t=n.querySelectorAll("select"),r,i;if(t&&t.length>0)for(i=0;i<t.length;i++)t[i].value!=0&&t[i].value!=""&&(r=t[i]);return r}return{popup:function(n,t,i){ajaxRequest(n,t,"GET",i,null,{popupOptions:new Popup.LayerOptions(null,null,null,function(){ManageConfig.onCloseInlinePopup()})})},loadChildLocation:function(n){Location.search(n,Requests.get(Requests.keys.OnChange)+"=1")},addLocation:function(t){var u=t.up(".collapsingContent"),i=n(u),r;if(i){if(r=i.value,!r||isObject(document.getElementById("chosenLocation_"+r)))return;var o=u.querySelector("#locGeoTemplate").innerHTML.replace(/\{locationID\}/ig,r).replace(/\{locationName\}/ig,i.options[i.selectedIndex].innerHTML),s=i.getAttribute("data-level"),f=u.querySelector('[data-loc-geo-level="'+s+'"]'),e=f.querySelector(".locGeoList");e.innerHTML+=o;$(f).show();highlightNode(e.querySelector(".sideTag:last-child").querySelector("a"))}},removeLocation:function(n){var t=n.up(".locGeoList");n.parentNode.remove();t.children.length<=0&&t.parentNode.hide()},save:function(n,t){ajaxRequest(n,t,"POST",$(n.up(".popupBox").querySelector(".PopupBulkConfig")).find("*").serializeAll(),function(n){n.status==ajaxRequest.StatusType.Success&&(Popup.close(!0),window.location.reload(!0))})}}}(),n.EventTypes=function(){return{ChangeFlag:!1,popup:function(n,t,i){ajaxRequest(n,t,"GET",null,function(n){ManageConfig.EventTypes.ChangeFlag=!1;n.status==ajaxRequest.StatusType.Success&&n.popupContent&&Popup.registerCallbacks(new Popup.LayerOptions(null,function(){ManageConfig.EventTypes.ChangeFlag&&ajaxRequest(null,i,"GET")}),-1)})},setVisibility:function(n,t,i){ajaxRequest(n,t,"POST",i,function(n){n.status==ajaxRequest.StatusType.Success&&(ManageConfig.EventTypes.ChangeFlag=!0)})},saveInline:function(n,i){l(n,function(r,f){var o=r?r.querySelector(".etp_list_item_header input[type=checkbox]"):null,s=o&&o.checked?!0:!1,e=appendStringParams($(f).find("*").serializeAll(),t.serializeMain(f));e=appendStringParams(e,t.serializeLine(f));ajaxRequest(n,i,"POST",e,function(t){var i,f,r;t.status==ajaxRequest.StatusType.Success&&(u=!0,i=a(t),i&&(t.data&&t.data.isNew?(f=n.up(".collapsingContent,.collapsingLine"),Element.remove(y(n,i)),r=i.querySelector("input[type=checkbox]"),r&&(r.checked=s),p(f,i)):$(n.up(".etp_list_item")).replaceWith(i)),ManageConfig.EventTypes.ChangeFlag=!0)})})},deleteInline:function(n,t,r){i(n,t,r,null,function(n){n.status==ajaxRequest.StatusType.Success&&(ManageConfig.EventTypes.ChangeFlag=!0)})}}}(),n.ConfigurableSections=function(){function u(n){$(n.target).css("opacity","")}function i(n,t,i,r){var u=r.indexOf(i),f=r.indexOf(n.target),o=r.length-1,e;f!=-1&&u!=f&&u<r.length&&r[u]&&(f+1>=o?r.length?t.insertBefore(r[u],r[0]):t.appendChild(r[u]):f>u?(e=r[f].next(),t.insertBefore(r[f],r[u]),e&&t.insertBefore(r[u],e)):t.insertBefore(r[u],r[f]))}function f(n,t,i,r,u){var f=r.indexOf(i),e=n.target.classList.contains("ConfigurableContainer")?-1:u.indexOf(n.target),o=u.length;f>=r.length||!r[f]||(e==-1||e+1>=o?u.length?t.insertBefore(r[f],u[0]):t.appendChild(r[f]):t.insertBefore(r[f],u[e]))}function e(n,t){$(n.target).css("opacity","0.5").attr("data-free",n.target.up(".ConfigurableContainer")==null?"1":"0");t.helper.css({"box-sizing":"border-box",width:"100%"})}function r(n,t){var c=document.getElementById("ConfigurableSectionsContext"),e,o,r,u,l,s,v,h,a,y;c&&(e=t.draggable.get(0),o=c.querySelector(".Sections"),r=n.target.classList.contains("ConfigurableContainer")?n.target:n.target.up(".ConfigurableContainer"),$(c).find(".ConfigurableContainer.Ghost").removeClass("Ghost"),e.getAttribute("data-free")=="1"?r!=null?(u=o.querySelectorAll(".ConfigurableSection"),u.length-2==0&&$(o).addClass("Ghost"),f(n,r.querySelector(".collapsingContent"),e,u,r.querySelectorAll(".ConfigurableSection"))):i(n,o,e,o.querySelectorAll(".ConfigurableSection")):(s=e.up(".ConfigurableContainer"),s&&(r!=null?(v=r.querySelector(".collapsingContent"),s.getAttribute("data-id")==r.getAttribute("data-id")?i(n,v,e,r.querySelectorAll(".ConfigurableSection")):f(n,v,e,s.querySelectorAll(".ConfigurableSection"),r.querySelectorAll(".ConfigurableSection"))):(u=s.querySelectorAll(".ConfigurableSection"),l=o.querySelectorAll(".ConfigurableSection"),h=u.indexOf(e),a=n.target.classList.contains("Sections")?-1:l.indexOf(n.target),y=l.length,h>=u.length||!u[h]||(a==-1||a+1>=y?o.appendChild(u[h]):o.insertBefore(u[h],l[a]))))));setTimeout(function(n){n&&$(n).find(".ui-droppable-hover.Dropping").removeClass("ui-droppable-hover Dropping")},50,c)}function o(n,t){$(n.target).css("opacity","0.5").find(".ConfigurableSection").hide();t.helper.css({"box-sizing":"border-box",width:"100%"}).find(".ConfigurableSection").hide()}function s(n,t){var f=document.getElementById("ConfigurableSectionsContext"),r,u;f&&(r=t.draggable.get(0),u=f.querySelector(".Containers"),i(n,u,r,u.querySelectorAll(".ConfigurableContainer")),$(r).find(".ConfigurableSection").show(),stopEventPropagation(n))}var t=Object.freeze({OnBeforeSave:0,OnSave:1}),n={};return{popup:function(i,f,h,c,l,a,v){ajaxRequest(i,f,c||"GET",h,function(i){var h,c,f;if(i.status==ajaxRequest.StatusType.Success&&i.popupContent){if(n={},forEachProp(t,function(t,i){n[i[t]]=[]}),typeof a=="function"&&n[t.OnBeforeSave].push(a),typeof v=="function"&&n[t.OnSave].push(v),h=$(Popup.current().querySelector("#ConfigurableSectionsContext")),h.length!=1)return;h.find(".ConfigurableSection.ui-draggable").draggable("destroy");h.find(".ConfigurableSection.DragElem").draggable({containment:h,helper:"clone",cancel:".ConfigurableSectionSwitch",start:e,stop:u});h.find(".ConfigurableSection.ui-droppable").droppable("destroy");h.find(".ConfigurableSection.DropElem").droppable({accept:".ConfigurableSection.DragElem",hoverClass:"Dropping",drop:r,greedy:!0});c=h.find(".Sections:first");c.length==1&&(c.hasClass("ui-droppable")&&c.droppable("destroy"),c.droppable({accept:".ConfigurableSection.DragElem",hoverClass:"Dropping",drop:r,greedy:!0}));f=h.find(".Containers:first");f.length==1&&(f.find(".ConfigurableContainer.ui-draggable").draggable("destroy"),f.find(".ConfigurableContainer.DragElem").draggable({containment:f,helper:"clone",cancel:".ConfigurableSectionSwitch",start:o,stop:u}),f.hasClass("ui-droppable")&&f.droppable("destroy"),f.droppable({accept:".ConfigurableContainer.DragElem",hoverClass:"Dropping",drop:s,greedy:!0}),f.find(".ConfigurableContainer.ui-droppable").droppable("destroy"),f.find(".ConfigurableContainer.DropElem").droppable({accept:".ConfigurableSection.DragElem",hoverClass:"Dropping",drop:r,greedy:!0}))}},{popupOptions:new Popup.LayerOptions(null,null,null,function(){typeof l=="function"&&l();n={}},0)})},save:function(i,r){var e=[],f=0,o="",u,s,h=n[t.OnBeforeSave].pop();typeof h=="function"&&h();$(i).parents(".PopupContext:first").find(".ConfigurableSection").each(function(n,t){u=t.up(".ConfigurableContainer");f=u?parseInt(u.getAttribute("data-id")):0;f!=0&&(o=encodeURIComponent(u.getAttribute("data-name")));e.push("{0}|{1}|{2}|{3}".format(t.getAttribute("data-key"),t.querySelector(".ConfigurableSectionSwitch").getAttribute(c),f,o))});s=appendStringParams($(i).parents(".PopupContext:first").find(":input").serializeAll(),Requests.getPair(Requests.keys.Items,e.join(",")));ajaxRequest(i,r,"POST",s,function(i){var f=n[t.OnSave].pop(),u=!0,r;Popup.close();i.status==ajaxRequest.StatusType.Success&&(r=isObject(i.data)&&i.data.target?document.getElementById(i.data.target):null,r&&(u=!1,ajaxRequest(r,r.getAttribute("data-url"),"GET",r.getAttribute("data-parameters"))),typeof f=="function"&&f()===!0&&(u=!1));u&&window.location.reload(!0)})},toggleVisibility:function(n,t,i){n.classList.toggle("active");n.up(".ConfigurableSection").classList.toggle("disabledBox",!n.classList.contains("active"));n.setAttribute(c,n.classList.contains("active")?t:i)}}}(),n.Media=function(){var n=null;return{openFoldersPopup:function(t,i,r){ajaxRequest(t,i,"GET",r,function(i){i.status==ajaxRequest.StatusType.Success&&(isObject(i.data)&&Permissions.init(i.data.permissions),i.popupContent&&(n=t))})},saveMediaCatPermissions:function(n,t,i){var u=Permissions.getTarget(i),r=[Requests.get(Requests.keys.CategoryID)+"="+i,];r.push(Requests.get(Requests.keys.SelectedIDs)+"="+JSON.stringify(u));ajaxRequest(n,t,"POST",r.join("&"),function(n){n.status==ajaxRequest.StatusType.Success&&Popup.close()})},saveCategories:function(t,i,r,u){var f=[],e;document.querySelectorAll(".etp_list_item.active .etp_list_item_header").forEach(function(n){var t=n.querySelector("input[type=checkbox]");inputIsChecked(t)&&f.push(n.getAttribute("data-value"))});e=appendStringParams(r,[Requests.get(Requests.keys.IDs)+"="+f.join(",")]);ajaxRequest(t,i,"POST",e,function(t){if(t.status==ajaxRequest.StatusType.Success)if(Popup.close(),u)window.location.reload(!0);else{var i=n?n.up(".RelatedMedia"):null;i&&Tabs.CollapsingPane.resetPane(i)}})},checkItemToggleActive:function(n){var e=n.up(".etp_list_item"),f,u,t,r,i;if(e.classList.toggle("active",n.checked),e.classList.contains("FileArchiveChild"))n.checked&&(t=n.up(".FileArchiveChild"),t&&(f=t.getAttribute("data-parentid"),f&&(u=t.previous('[id="'+f+'"]'),i=u?u.querySelector("input[type=checkbox]"):null,i&&(i.checked=!0,u.classList.add("active")))));else if(!n.checked&&(t=n.up(".FileArchiveCategoryLine"),!t.classList.contains("FileArchiveChild")))for(r=t;r=r.next();){if(!r.classList.contains("FileArchiveChild"))break;i=r.querySelector("input[type=checkbox]");i&&(i.checked=n.checked,r.classList.toggle("active",i.checked))}},openPermissionsPopup:function(n,t,i,r,u,f,e){var o=[Requests.get(Requests.keys.AccessPermissionType)+"="+i,Requests.get(Requests.keys.BusinessObject)+"="+r,Requests.get(Requests.keys.Context)+"="+u,Requests.get(Requests.keys.CategoryID)+"="+f,Requests.get(Requests.keys.Type)+"="+$(n).attr("data-team-value")],h=$(n).attr("data-value"),s=Permissions.getTarget(h);s[e]&&o.push(Requests.get(Requests.keys.SelectedIDs)+"="+s[e].join(","));ajaxRequest(n,t,"POST",o.join("&"))},moveToFolder:function(n,t){ajaxRequest(n,t,"POST",$(".popupContent").find("*").serializeAll())},posMoveFile:function(n,t){n&&(Popup.close(),Search.GenericList.deselectAll(!1,!1),Search.byAdvanced(n,t))},deleteInline:function(n,t,r){i(n,t,r,function(t){var i,r;if(t.status==ajaxRequest.StatusType.Success&&(i=n.up(".FileArchiveCategoryLine"),!i.classList.contains("FileArchiveChild")))while(r=i.next(".FileArchiveChild"))r.remove()})},categorieTabClick:function(n,t,i,r,u){n&&(r&&u?AjaxQueue.click(n,"","",null,r,u):AjaxQueue.click(n),ajaxRequest(n,t,"POST",i))}}}(),n.MultiLanguage=function(){function n(n,t){var i=Popup.current(),r,u;i&&n&&(r=$(i).outerHeight()+$(n).find("[data-float-menu]").outerHeight(),u=r>window.innerHeight,Popup.adjustOverflow(t,u))}return{selectLanguage:function(n,t,i,r){var o=n.up(".ConfigInlineEditItem"),u=null,f,e;o&&(u=n.up(".EditLineMultiLanguageFlags"),f=null,o.querySelectorAll(".InlineNameEdit").forEach(function(n){n.classList.contains("InlineNameEdit_"+t)?f=n:n.hide()}),f?(f.show(),f.focus()):console.warn("ManageConfig.MultiLanguage.selectLanguage nao foi encontrada caixa de edicao de texto para a tag = "+t+"; verificar renderizacao."));e=null;u&&(e=u.querySelector(".ActiveFlagHolder span"));e&&(e.className=i,e.setAttribute("title",r));n.up().querySelectorAll(".FlagSelector.selected").invoke("classList.remove","selected");n.classList.add("selected");u&&u.click()},adjustOverflowOnOpen:function(t){n(t,!1)},adjustOverflowOnClose:function(t){n(t,!0)}}}(),n.PresentationPoints=function(){return{popup:function(n,t){ajaxRequest(n,t,"GET")}}}(),n.LeadRealestateDiscardReasons=function(){return{popup:function(n,t,i){ajaxRequest(n,t,"GET",null,null,{popupOptions:new Popup.LayerOptions(null,null,null,function(){ajaxRequest(n,i,"GET")})})}}}(),n.Visits=function(){return{openManageBox:function(n,t,i){ajaxRequest(n,t,"GET",Requests.getPair(Requests.keys.Type,i))}}}(),n.MarketAnalysis=function(){var n=[];return{popupDocumentationChecklist:function(t,i,r,u,f){ajaxRequest(t,i,"GET",r,function(t){if(t.status==ajaxRequest.StatusType.Success){if(n=[],f&&Translations.initAvailableLanguages(null,f),!u)return;Popup.registerCallbacks(new Popup.LayerOptions(null,null,null,function(){var i=document.getElementById(u),r,f,e,t,o;i&&(r=i.getAttribute("data-beforereload-url"),e=i.getAttribute("data-beforereload-params"),f=i.getAttribute("data-reload-url"),t=i.getAttribute("data-reload-params"));o=function(i){f&&t&&(n.length>0&&(t=appendStringParams(t,Requests.getPair(Requests.keys.IDs,n.join(",")))),i&&isObject(i.data)&&i.data.extraParams&&(t=appendStringParams(t,i.data.extraParams)),ajaxRequest(null,f,"POST",t))};r&&e?ajaxRequest(null,r,"POST",e,function(n){n.status==ajaxRequest.StatusType.Success&&o(n)}):o()}),0)}})},saveInline:function(t,i){ManageConfig.saveInline(t,i,function(t,i){i&&isObject(i.data)&&i.data.newlyAddedID&&i.data.newlyAddedID>0&&n.indexOf(i.data.newlyAddedID)==-1&&n.push(i.data.newlyAddedID)})},deleteInline:function(t,r,u){i(t,r,u,null,function(t){if(t&&isObject(t.data)&&t.data.deletedID&&t.data.deletedID>0){var i=n.indexOf(t.data.deletedID);i>-1&&n.splice(i,1)}})}}}(),n.Dashboard=function(){function t(n,t){var u,i,r;if(!n)return!1;if(t){n.value?(n.style.backgroundColor="#fff",n.style.color="#000"):(n.style.backgroundColor="#f2dcdc",n.style.color="#bf7575",n.hasAttribute("onkeyup")||n.setAttribute("onkeyup","ManageConfig.Dashboard.validateEmptyInput(this, true);"));return}for(u=n.querySelectorAll("input"),r=0;r<u.length;r++){if(i=u[r],i&&!i.value)return i.style.backgroundColor="#f2dcdc",i.style.color="#bf7575",i.hasAttribute("onkeyup")||i.setAttribute("onkeyup","ManageConfig.Dashboard.validateEmptyInput(this, true);"),Element.moveCursorEnd(i),!1;i&&(i.style.backgroundColor="#fff",i.style.color="#000")}return!0}function n(n){var t=n?n.querySelector(".UserLinksEditItems"):null;t&&($(t).find(".etp_list_item.DragElem.ui-sortable").sortable("destroy"),$(t).sortable({items:".etp_list_item.DragElem",handle:".etp_list_item_drag"}))}function i(t,i,r,u){var e=t.querySelector(".NewFileItemTemplate"),f=e?htmlStringToElement(e.innerHTML):null,o=t.querySelector(".UserLinksEditItems");f&&o&&(f.setAttribute("data-item",i),Element.setValue(f.querySelector(".UserLinkID"),i),Element.setValue(f.querySelector(".UserLinkPriority"),r),Element.html(f.querySelector(".UserLinksFileItemDisplayName"),'<i class="icon-doc"><\/i> '+u),o.appendChild(f),n(t))}return{editConfigurableSections:function(n){var t=Dashboard.getActiveTab(n),i,r;t&&(i=t.up(".DashboardMenu").getAttribute("data-config-url"),r=t.getAttribute("data-config-params"),i&&r)&&(t.__EditModeOn=!0,ManageConfig.ConfigurableSections.popup(n,i,r,"POST",function(){t.__EditModeOn=!1},null,function(){return Dashboard.resetTabContainer(t)}))},editUserLinks:function(t,i){var f=t.up(".dashboardBox"),r,u;f&&(u={},r=f.getAttribute("data-local-storage-key"),r&&(u[r]=localStorage.getItem(r)),ajaxRequest(t,i,"POST",u,function(t){t.status==ajaxRequest.StatusType.Success&&n(Popup.current())}))},addNewLink:function(n){var i=n.up(".PopupContext"),r=i?i.querySelector(".UserLinksEditItems"):null,t;r&&(t=e(n,!0),t)&&(w(r,t),t.show(),highlightNode(t),$(t.querySelector('input[type="text"]')).trigger("focus"))},editUserLink:function(n){var i=n.up(".etp_list_item"),t=i?i.querySelector(".etp_list_item_edit"):null;t&&(Element.hide(n.up(".etp_list_item_header")),t.show(),$(t.querySelector('input[type="text"]')).trigger("focus"))},setUserLink:function(i){var u=i.up(".etp_list_item_edit"),f,r,e,o,s,h,c,l,y,a,v;if(u&&t(u)){if(r=i.up(".etp_list_item"),!r){if(f=i.up(".PopupContext"),e=f?f.querySelector(".NewWebItemTemplate"):null,r=e?htmlStringToElement(e.innerHTML):null,!r)return;y=!0}(o=r.querySelector(".UserLinksWebItemDisplayName"),s=r.querySelector(".UserLinkName"),h=r.querySelector(".UserLinkUrl"),c=u.querySelector(".UserLinkEditorName"),l=u.querySelector(".UserLinkEditorUrl"),!(!o|!s)&&h&&c&&l)&&(s.value=o.innerText=c.value,h.value=l.value,y&&(r.appendChild(u),v=u.querySelector(".CancelAction"),v&&v.setAttribute("onclick","ManageConfig.cancelEditInline(this);"),a=f.querySelector(".popupContent .UserLinksEditItems"),a&&a.appendChild(r)),u.hide(),Element.show(r.querySelector(".etp_list_item_header")),n(Popup.current()))}},deleteUserLink:function(n,t){MessageBox.confirm(t,Translations.get(Translations.keys.Yes),function(){Element.remove(n.up(".etp_list_item"))},"",Translations.get(Translations.keys.No))},validateEmptyInput:t,addManagementFilePopup:function(n,t){var u=document.getElementById("BoxUserLinks"),i,r;i=u.getAttribute("data-local-storage-key");r={};i&&(r[i]=localStorage.getItem(i));ajaxRequest(n,t,"POST",r)},saveUserLinksSelectedMedias:function(n){var f=n.up(".PopupContext"),r=f.querySelectorAll("input[type=checkbox]:checked"),u=document.querySelectorAll("input.OldItem[type=checkbox]:not(:checked)"),t;if(!r.length&&!u.length){Popup.close();return}t=document.getElementById("UserLinksEditPopup");r.forEach(function(n){var r=n.up(".checkboxLine"),u;r&&!n.classList.contains("OldItem")&&(u=r.querySelector("input.UserLinkID").value,t.querySelector('[data-item="'+u+'"]')||i(t,u,r.querySelector("input.UserLinkPriority").value,r.querySelector("input.UserLinkName").value))});u.forEach(function(n){var r=n.up(".checkboxLine"),i;r&&(i=parseInt(r.querySelector("input.UserLinkID").value),i&&Element.remove(t.querySelector('[data-item="'+i+'"]')))});Popup.close()},editProcessManagementCreator:function(t,i){var f=t.up(".DashboardContainerSection"),r,u;f&&(u={},r=f.getAttribute("data-local-storage-key"),r&&(u[r]=localStorage.getItem(r)),ajaxRequest(t,i,"POST",u,function(t){t.status==ajaxRequest.StatusType.Success&&n(Popup.current())}))},checkProcessManagementCreatorGroups:function(n){var t=n.up(".ProcessManagementLinksGroup");t&&n.checked?t.querySelectorAll("input[name^=masterTypeCheckBox_]").forEach(function(n){n.checked=!0}):t&&t.querySelectorAll("input[name^=masterTypeCheckBox_]").forEach(function(n){n.checked=!1})},checkProcessManagementCreatorMasterTypes:function(n){var t=n.up(".ProcessManagementLinksGroup"),i;t&&n.checked?t.querySelector("input[name=groupCheckBox]").checked=!0:t&&(i=!1,t.querySelectorAll("input[name^=masterTypeCheckBox_]").forEach(function(n){n.checked&&(i=!0)}),i||(t.querySelector("input[name=groupCheckBox]").checked=!1))},saveProcessManagementCreator:function(n,t,i,r){var e=n.up(".PopupContext"),u,f;e&&window.localStorage&&(u={},e.querySelectorAll("input[type=checkbox]").forEach(function(n){n.checked===!1&&(n.getAttribute("data-type")==i?n.getAttribute("data-is-default")?u.ExcludeDefault=!0:(u.Groups||(u.Groups=[]),u.Groups.push(n.value)):n.getAttribute("data-type")==r&&(u.TypeIds=u.TypeIds?u.TypeIds+","+n.value:n.value))}),window.localStorage[t]=JSON.stringify(u),f=document.getElementById("BoxProcessManagementCreator"),f&&Dashboard.reloadSection(f),Popup.close())},saveUserLinks:function(n,t){var u=n.up(".PopupContext"),f=u?u.querySelector(".UserLinksEditItems"):null,i,r,e;f&&window.localStorage&&(i={},r=1,f.querySelectorAll(".etp_list_item").forEach(function(n){n.getAttribute("data-item")=="0"?(i.CustomLinks||(i.CustomLinks=[]),i.CustomLinks.push({ID:0,Name:n.querySelector(".UserLinkName").value,Url:n.querySelector(".UserLinkUrl").value,Priority:r})):(i.FileArchiveIds||(i.FileArchiveIds=[]),i.FileArchiveIds.push({ID:parseInt(n.querySelector(".UserLinkID").value)||0,Priority:r}));r++}),e="linksJson="+encodeURIComponent(JSON.stringify(i)),ajaxRequest(n,t,"POST",e),Popup.close())}}}(),n.Timeline=function(){function n(n){var i=n.querySelectorAll(".Sortable");i.length>0&&i.each(function(i){Sortable.sortables[i.id]&&Sortable.destroy(i);Sortable.create(i.id,{tag:"div",overlap:"vertical",handle:"etp_list_item_drag",onUpdate:function(i){t(i,n.getAttribute("sortActionUrl"))}})})}function t(t,i){var u=$(t).up(".configSection").down("#extraParams"),r=Form.serialize(u,!0);r.sortedList=t.select(".SortableItem").invoke("getAttribute","data-item").join(",");r.nMasterLeadType=t.up(".configuratorMain").down("[name=nMasterLeadType]").value;console.log("sending",r.sortedList);new EgoRequest(t,i,{post:r,onSuccess:function(i){i.responseText&&(t.up(".configuratorMain").replace(i.responseText),n($("leadTimeLineEditPopup")))}})}return{popupEditSteps:function(t,i,r){var u=t.up(".TimelineContext");r=appendStringParams(r,$(u).find(".PrivateData :input").serializeAll());ajaxRequest(t,i,"GET",r,function(t){if(t.status==ajaxRequest.StatusType.Success){var i=Popup.current();n(i)}},{popupOptions:new Popup.LayerOptions(null,null,null,function(){Timeline.reload()})})}}}(),n.ProcessManagementCategory=function(){function n(n,t,i){ajaxRequest(n,t,"GET",i,function(n){n.status===ajaxRequest.StatusType.Success&&n.data&&n.data.permissions&&Permissions.init(n.data.permissions)})}function t(n,t){var i=$(n.up(".etp_list_item")).find(".itemID:first").val()||"",r="",u;i&&(u=Permissions.getTarget(i),r=Requests.get(Requests.keys.SelectedIDs)+"="+JSON.stringify(u));ManageConfig.saveInline(n,t,function(n,t){t.status===ajaxRequest.StatusType.Success&&t.data.permissions&&Permissions.init(t.data.permissions)},r)}return{openPopup:n,save:t}}(),n}(),EgoPrinter=function(){var n={printMode:"iframe",leaveOpen:!1,paperSize:null,orientation:null,inheritCSS:!1},t=this;return _printHTML=function(i,r){var e,o,u,f;($.extend(n,r||{}),e="",typeof i=="string"?e=i:i.tagName&&(e=i.innerHTML),e)&&(t._nLastPrintID&&$(t._nLastPrintID)&&$("#"+t._nLastPrintID).remove(),n.printMode.toLowerCase()=="iframe"&&(/opera/i.test(navigator.userAgent)&&(n.printMode="popup"),/chrome\/(\d+)/i.test(navigator.userAgent.toLowerCase())&&parseInt(RegExp.$1,10)<=3&&(n.printMode="popup")),o=null,u=null,n.printMode.toLowerCase()=="popup"?(o=window.open("about:blank","printElementWindow","width=650,height=440,scrollbars=yes"),u=o.document):(t._nLastPrintID="printElement_"+Math.round(Math.random()*99999).toString(),f=document.createElement("IFRAME"),$(f).attr({id:t._nLastPrintID,scrolling:"no",frameBorder:"0",src:"about:blank",style:"border:none;position:absolute;width:100%;height:0px;bottom:0px;left:0px;"}),document.body.appendChild(f),u=f.contentWindow||f.contentDocument,u.document&&(u=u.document),f=document.frames?document.frames[t._nLastPrintID]:document.getElementById(t._nLastPrintID),o=f.contentWindow||f),focus(),u.open(),u.write(t._getMarkup(e,r)),u.close(),t._callPrint(o))},_getMarkup=function(t,i){var r=[],f,e,u;if(r.push("<html><head><title><\/title>"),n.paperSize&&(f=n.paperSize.width,e=n.paperSize.height,n.orientation&&n.orientation==EgoPrinter.Orientation.Landscape&&(f=n.paperSize.height,e=n.paperSize.width),r.push('<style type="text/css"> @media print {body { width:'+f+";height:"+e+";text-align:center;}}<\/style>")),r.push('<style type="text/css">* {-webkit-print-color-adjust: exact !important;   /* Chrome, Safari */ color-adjust: exact !important; /*Firefox*/\t} <\/style>'),i&&i.inheritCSS)for(u=0;u<document.styleSheets.length;u++)document.styleSheets[u].href&&(console.log(document.styleSheets[u].href),r.push('<link href="'+document.styleSheets[u].href+'" rel="stylesheet" type="text/css" />'));return i.bodyClassOverride?r.push('<\/head><body class="'+i.bodyClassOverride+'" onload="makeprint();">'):r.push('<\/head><body class="" onload="makeprint();">'),r.push(t),r.push('<script type="text/javascript">function makeprint() { window.printPage = function (){setTimeout("focus();print();'),r.push(n.leaveOpen&&n.printMode.toLowerCase()=="popup"?"close();":""),r.push('",1000);}}<\/script>'),r.push("<\/body><\/html>"),r.join("")},_callPrint=function(n){n&&n.printPage?n.printPage():setTimeout(function(){t._callPrint(n)},50)},{PaperSize:{A4:{width:"200mm",height:"287mm"},A4Margin:{width:"180mm",height:"268mm"}},Orientation:{Portrait:0,Landscape:1},printHtml:function(n,t){_printHTML(n,t)}}}(),LatestUpdates=function(){var n={url:"",subOrigin:"",leadName:"",successMsg:""};return{formLeadSend:function(t){var i=$(t).find("*").serializeArray();return i=updateParams(i,"suborigin",n.subOrigin),i=updateParams(i,"leadname",n.leadName),parent.ajaxRequest(t,n.url,"POST",i,function(t){t.status==1&&(MessageBox.alert(n.successMsg),Popup.closeByID("TemporaryPopup"))}),!1},createQuickLead:function(t){var i={};return i.suborigin=n.subOrigin,i.leadname=n.leadName,i.leadquick=1,parent.ajaxRequest(t,n.url,"POST",i,function(t){t.status==1&&(MessageBox.alert(n.successMsg),Popup.closeByID("TemporaryPopup"))}),!1},commercialPopup:function(t,i,r){var u=function(t){t.status==1&&t.popupContent&&isObject(t.data)&&(n.url=t.data.url||"",n.subOrigin=t.data.subOrigin||"",n.leadName=t.data.leadName||"",n.successMsg=t.data.successMsg||"")},f={popupOptions:new Popup.LayerOptions(function(n){var i=n.querySelector("#ContentToRender"),t=n.querySelector("#iLatestUpdateContent");t.contentWindow.document.write(i.innerHTML.replace(/0x0074/g,"<").replace(/0x0076/g,">"));t.style.height=t.contentWindow.document.body.scrollHeight+"px";t.contentWindow.document.close();i.remove()})};ajaxRequest(t,i,"GET",r,u,f)}}}(),Search=function(){var rt=function(n,t){this.viewType=n;this.func=t},ut=function(n,t,i){this.name=n;this.value=t;this.cssClass=i?i:""},e=Object.freeze({PreRequest:0,PostRequest:1,FilterReset:2}),g={},l=[],a=[],v=[],u=null,o,y=null,n={BusinessObject:0,SecurityUser:0,SearchUrl:"",SearchExecuted:!1,SelectedObjectIDs:[],QuickSearchSection:[],LabelsSection:[],PortalsSection:[],RequestParameters:{FreeText:"",Page:1,CustomSearchID:null,AdvancedSearch:null,SelectedIDs:null,SelectAll:!1}},s="SearchParameters",p=function(t){for(var f,s,r,h,e,c,o=[],u=function(n){n&&o.push(n)},i=0;i<l.length;i++)f=l[i],(f.viewType===undefined||f.viewType===null||f.viewType==Search.currentViewType())&&u(f.func());if(Overlay.removeDefaults(document.body),u(dataSerializer("Sidebar",".selected","data-name","data-value")),s=document.getElementById("Sidebar"),s&&(r=s.querySelectorAll("input"),r&&r.length>0))for(i=0;i<r.length;i++)r[i].name.length>0&&r[i].value.length>0&&u(r[i].name+"="+r[i].value);if(n.RequestParameters.pinned=0,h=document.querySelector(".listOrder"),h)for(e=h.querySelectorAll(".active[data-name][data-value]"),i=0;i<e.length;i++)n.RequestParameters[e[i].getAttribute("data-name")]=e[i].getAttribute("data-value");t||(n.RequestParameters.Page=1);n.RequestParameters.FreeText=$("#freeTextSearch").val();for(param in n.RequestParameters)n.RequestParameters[param]&&u(encodeURIComponent(param)+"="+encodeURIComponent(n.RequestParameters[param]));return Overlay.applyDefaults(document.body),c=document.getElementById("PrivateData"),c&&u($(c).find("input:hidden").serializeAll()),o=o.filter(function(n){return n.length}).join("&")},w=function(t,i,r,u){n.SearchExecuted=!0;ajaxRequest(t,i,"POST",r,function(n){var i,t;for(y=r,ListActions.bind(),typeof u=="function"&&u(n),i=0;i<a.length;i++)t=a[i],(t.viewType===undefined||t.viewType===null||t.viewType==Search.currentViewType())&&t.func(n);Search.GenericList.updatePageFromSelected()})},t=function(t,i,r,u,f){i=i||n.SearchUrl;var e=p(u);o&&clearTimeout(o);f?w(t,i,e,r):o=window.setTimeout(function(){w(t,i,e,r)},600);tt()},ft=function(t,i,r,u){var f,e;i=i||n.SearchUrl;f=p(!0);u&&(e=document.getElementById(u),e&&(f+="&"+$(e).find("*").serializeAll()));w(t,i,f,r);tt()},b=function(t){t=t?t:document.querySelector(".clearSearch");t.parentNode.classList.remove("active");n.RequestParameters.AdvancedSearch=null},nt=function(){n.RequestParameters.CustomSearchID=null;var t=document.querySelectorAll("[data-cs-id].active")[0];t&&t.classList.remove("active")},k=function(){var i=document.getElementById("PrivateData"),t,n;if(i)for(t=i.querySelectorAll("[data-temporary]"),n=0;n<t.length;n++)t[n].remove()},h=function(n){for(var i=Array.from(document.getElementsByClassName(n)),t=0;t<i.length;t++)i[t].classList.remove(n)},et=function(){var i,r,n,t;if(h("selected"),h("added"),h("crossed"),h("excluded"),i=document.getElementById("Sidebar"),i)for(r=i.querySelectorAll(".sidebarTreeItem.active"),n=0;n<r.length;n++)EventHandler.trigger(r[n],"click");for(n=0;n<v.length;n++)t=v[n],(t.viewType===undefined||t.viewType===null||t.viewType==Search.currentViewType())&&t.func()},f=function(t){if(n.RequestParameters.Page=1,!t){if(t=document.getElementsByClassName("OnlyPinned")[0],!t)return;t=t.firstElementChild}t.classList.remove("active");t.setAttribute("data-value","0")},d=function(n){var u=n.getElementsByTagName("select"),r,i,t;if(u)for(t=0;t<u.length;t++)EventHandler.addListener(u[t],"change",function(){this.toggleClass("edited",this.selectedIndex!=0)}),u[t].toggleClass("edited",u[t].selectedIndex!=0);if(i=n.querySelectorAll("input[type='text']"),i)for(t=0;t<i.length;t++)EventHandler.addListener(i[t],"change",function(){this.getAttribute("data-overlay")&&this.toggleClass("edited",this.value!=this.getAttribute("data-overlay"))}),i[t].getAttribute("data-overlay")&&i[t].toggleClass("edited",i[t].value!=i[t].getAttribute("data-overlay"));if(r=n.querySelectorAll("input[type='checkbox']"),r)for(t=0;t<r.length;t++)EventHandler.addListener(r[t],"change",function(){this.toggleClass("edited",this.checked)}),r[t].toggleClass("edited",r[t].checked);if(i=n.querySelectorAll("textarea"),i)for(t=0;t<i.length;t++)EventHandler.addListener(i[t],"change",function(){this.getAttribute("data-overlay")&&this.toggleClass("edited",this.innerHTML!=this.getAttribute("data-overlay"))}),i[t].getAttribute("data-overlay")&&i[t].toggleClass("edited",i[t].innerHTML!=i[t].getAttribute("data-overlay"))},tt=function(){var e=document.getElementById("QuickSearch"),i=document.getElementById("SidebarOverview"),r,t,u,n,f;if(!e||!i)return!1;for(i.innerHTML="",r=e.querySelectorAll("span.sideTag.selected"),t=0;t<r.length;t++)(u=r[t].querySelectorAll("a")[0],u)&&(n=document.createElement("SPAN"),n.classList.add("sideTag"),n.classList.add("selected"),f=document.createElement("A"),f.innerHTML=u.innerHTML,n.appendChild(f),i.appendChild(n))},it=function(n){for(var i,t,r={},f=n.querySelectorAll("[data-context]"),u=0;u<f.length;u++)(i=f[u].getAttribute("data-context"),t=$(f[u]).find("input, select, textarea").filter(function(){return this.value.trim().length>0}).serializeAll(),i&&t)&&(t=i in r?r[i]+"&"+t:t,r[i]=t);return r},ot=function(i){window.performance.navigation.type==2?ht():(u=document.querySelectorAll("[data-cs-id].active").first(),u&&(n.RequestParameters.CustomSearchID=u=u.getAttribute("data-cs-id")));i||n.SearchExecuted?t(null,n.SearchUrl,null,!0,!0):Overlay.applyDefaults(document.body);$(window).scroll(function(){$(".PageListActions").length&&Search.stickyListActions()})},c=function(){var n=document.getElementById("PrivateData"),t;if(n&&n.childNodes&&n.childNodes.length>0)for(t=0;t<n.childNodes.length;++t)n.childNodes[t].nodeType!=Node.TEXT_NODE&&n.childNodes[t].hasAttribute("data-temporary")&&n.childNodes[t].remove()},st=function(){Search.Sidebar.onPageUnload();localStorage.setItem(s,JSON.stringify(n))},ht=function(){if(localStorage[s]){var t;try{t=JSON.parse(localStorage[s])}catch(i){return}n=t;n.RequestParameters.FreeText&&Overlay.change($("#freeTextSearch")[0],n.RequestParameters.FreeText);Search.Sidebar.onPageBack()}},r={callbackKeys:e,ViewTypeKeys:g,init:function(t,i,r,u){typeof u!="boolean"&&(u=!0);n.BusinessObject=t;n.SecurityUser=i;n.SearchUrl=r;s="SearchData_"+t+"_"+i;ot(u);EventHandler.addListener(window,"beforeunload",function(){st()})},innerInit:function(n,i){typeof i=="function"&&i();t(null,n,null,!0,!0)},registerCallback:function(n,t,i){if(typeof n!="number"||n<0||typeof t!="function")return!1;var r=new rt(i,t);n===e.PreRequest?l.push(r):n===e.PostRequest?a.push(r):n===e.FilterReset&&v.push(r)},currentViewType:function(){var n=document.getElementById("CurrViewType");return n?parseInt(n.value):null},currentIsTargetViewType:function(n){var t,i;if(!n)return!1;for(t in Search.ViewTypeKeys)if(Search.ViewTypeKeys.hasOwnProperty(t)&&Search.ViewTypeKeys[t]==n)return i=Search.currentViewType(),i&&i==n;return!1},loadViewTypes:function(n){if(!isObject(n)){console.log("cannot load invalid view types: "+(n?JSON.stringify(n):""));return}for(var t in n)n.hasOwnProperty(t)&&(g[t]=n[t])},fullSearch:function(n,i,r,u){t(n,i,r,!1,u)},reload:function(n,i){t(n,i,null,!0,!0)},buildRequestParameters:function(n){return p(n)},isCustomSearchActive:function(){return n.RequestParameters.CustomSearchID!=null},isAdvancedSearchActive:function(){return n.RequestParameters.AdvancedSearch!=null},openSearchPopup:function(t,i,r,u){var f,e,o;if(!t||!i||!r)return!1;f=r;n.RequestParameters.CustomSearchID!=null?f+="&"+$.param({CustomSearchID:n.RequestParameters.CustomSearchID}):(n.RequestParameters.AdvancedSearch!=null&&(f+="&"+$.param({AdvancedSearch:n.RequestParameters.AdvancedSearch})),e=document.getElementById("PrivateData"),e&&(o=$(e).serializeAll("*"),o&&(f+="&"+o)));ajaxRequest(t,i,"POST",f,function(){var n=Popup.current();d(n);applyDropdowns(n,{onOpen:function(){u&&Popup.adjustOverflow(!1)},onClose:function(){u&&Popup.adjustOverflow(!0)}});n.getAttribute("data-close-binded")!="1"&&(Popup.registerCallbacks(new Popup.LayerOptions(null,null,null,function(){n.querySelectorAll(".SearchInput").forEach(function(n){n.value=""});n.querySelectorAll(".contactSearchDrop").forEach(function(n){n.hide()});n.querySelectorAll(".collapsingBtn.active").forEach(function(n){n.querySelector("a.active").click()});Popup.adjustOverflow(!0)}),0),n.setAttribute("data-close-binded","1"))})},byAdvanced:function(i,r,u){var o,e;r=r||n.SearchUrl;f();nt();k();Search.clearSelectedFilter();n.RequestParameters.Page=1;document.getElementsByClassName("listSearchAdv")[0]&&document.getElementsByClassName("listSearchAdv")[0].classList.add("active");o=document.querySelector(".clearSearch");o&&o.parentNode.classList.add("active");e=document.getElementById("AdvancedSearchPopup");e&&!n.RequestParameters.CustomSearchID&&(Overlay.removeDefaults(e),n.RequestParameters.AdvancedSearch=JSON.stringify(it(e)));c();Popup.close();t(i,r,u)},byCustomSearch:function(i,r){if(r=r||n.SearchUrl,f(),b(),k(),Search.clearSelectedFilter(),n.RequestParameters.Page=1,i.classList.contains("active"))n.RequestParameters.CustomSearchID=null,i.classList.remove("active");else{var u=i.parentNode.querySelectorAll("[data-cs-id].active")[0];u&&u.classList.remove("active");n.RequestParameters.CustomSearchID=i.getAttribute("data-cs-id");i.classList.add("active")}c();t(i,r)},clearAdvanced:function(i,r){if(u!=null){n.RequestParameters.CustomSearchID=u;var f=document.querySelectorAll('[data-cs-id="'+n.RequestParameters.CustomSearchID+'"]')[0];f&&f.classList.add("active")}b(i);t(i,r)},clearOnlyPinned:function(){f()},clearSelectedFilter:function(){n.RequestParameters.SelectedIDs=null;n.RequestParameters.SelectAll=!1;var t=document.getElementById("btSelectAll");t&&$(t).show()},loadPage:function(i,r,u){n.RequestParameters.Page=u;t(i,r,function(){$("html, body").animate({scrollTop:"0"})},!0,!0)},listItems:function(n,i){t(n,i,null,!1,!0)},filterAction:function(i,r){r=r||n.SearchUrl;f();Search.clearSelectedFilter();n.RequestParameters.Page=1;i.parentNode.classList.contains("selected")?i.parentNode.classList.remove("selected"):(i.hasAttribute("data-exclusive")?$(i.parentNode).siblings().removeClass("selected"):$(i.parentNode).siblings().children("[data-exclusive]").each(function(){$(this).parent().removeClass("selected")}),i.parentNode.classList.add("selected"));t(i.parentNode,r)},toggleDisplaySidebar:function(n){var t=document.getElementById("Sidebar");if(!t||!n||n.getAttribute("data-working")=="1")return!1;n.setAttribute("data-working","1");t.classList.contains("open")?t.classList.remove("open"):t.classList.add("open");setTimeout(function(){n.setAttribute("data-working","0")},200)},setSort:function(n,t){var r=n.getAttribute("data-value"),i,u;(n.value=t,n.setAttribute("data-value",t),i=n.up(".listOrder").querySelector(".listOrderDirection"),i)&&(n.selectedIndex>0?r?r==t&&(u=i.getAttribute("data-value")=="0"?1:0,Search.setSortDirection(i,u)):(i.classList.add("up"),i.setAttribute("data-value",0),i.style.display="inline-block"):i.style.display="none")},sort:function(n,i){Search.setSort(n,n.options[n.selectedIndex].value);t(n,i)},setSortDirection:function(n,t){t==0?n.classList.add("up"):n.classList.remove("up");n.setAttribute("data-value",t)},sortDirection:function(n,i){Search.setSortDirection(n,n.classList.contains("up")?1:0);t(n,i)},viewTypeClick:function(i,r,u){var o,e,f;i.classList.contains("active")||(o=i.getAttribute("data-value"),e=i.parentNode.getElementsByClassName("active")[0],e&&e.classList.remove("active"),i.classList.add("active"),n.RequestParameters.Page=1,f=new Date,f.setTime(f.getTime()+31536e6),document.cookie=u+"="+o+"; expires="+f.toUTCString()+"; path=/",t(i,r,null,!1,!0))},onlyPinnedToggle:function(i,r){i.classList.contains("active")?(f(i),c()):(i.classList.add("active"),i.setAttribute("data-value","1"),b(),nt(),et(),k());n.RequestParameters.Page=1;t(i,r,null,!1,!0)},isFollowActive:function(){var n=document.querySelectorAll("[data-name='pinned']")[0];return n?n.classList.contains("active"):!1},inputKeyUp:function(i,r,u){if(r=r||n.SearchUrl,i.getAttribute("data-last-search")!=i.value){var f=i.value.trim().length;(f==0||f>2||u)&&t(i,r,function(){i.setAttribute("data-last-search",i.value)})}else clearTimeout(o)},togglePane:function(n,t,i,r,u){if(!n||!t||!i||!r)return!1;var f=Requests.get(Requests.keys.SearchContext)+"="+i+"&"+Requests.get(Requests.keys.AssociatedCategory)+"="+r;u&&(f+="&"+Requests.get(Requests.keys.BusinessObject)+"="+u);Tabs.CollapsingPane.toggle(n,t,f,function(){d(n.parentNode.parentNode);applyDropdowns(n.parentNode.parentNode)})},toggleMultipleReference:function(n,t){var r,f;if(!n&&(r=document.querySelector("#MultipleReference"),n=r?r.querySelector("a"):null,!n)||t&&n.parentNode.parentNode.contains(t))return!1;var u=n.parentNode.classList.contains("active"),i=n.parentNode.parentNode.querySelector("input"),e=n.parentNode.querySelector("textarea");if(u){if(i&&e)if(e.value)i.getAttribute("disabled")||(f=i.getAttribute("data-hasmultiple-text"),f&&(i.value=f),i.setAttribute("disabled","true"));else if(i.getAttribute("disabled")){i.value="";Overlay.onKeyUp(i);i.removeAttribute("disabled")}}else EventHandler.addListener(document,"click",Search.toggleMultipleReferenceEvent);t&&(u=!0);n.parentNode.toggleClass("active",!u)},toggleMultipleReferenceEvent:function(n){Search.toggleMultipleReference(null,n.target)},customSearchOpenPopup:function(n,t,i){if(!n||!t||!i)return!1;ajaxRequest(n,t,"GET",i,null,{popupOptions:new Popup.LayerOptions(null,null,null,function(){window.location.reload(!0)})})},customSearchOpen:function(n,t,i,r){if(!n||!t||!i)return!1;var u=Requests.get(Requests.keys.SearchContext)+"="+i;u+=r?"&"+Requests.get(Requests.keys.CustomSearchID)+"="+r:"";ajaxRequest(n,t,"GET",u,function(){d(Popup.current());applyDropdowns(Popup.current())})},customSearchSave:function(n,t,i,r){var e,u,o,f;if(!n||!t||!i)return!1;if(e=Popup.current(),u=e.querySelector("[name='customSearchName']"),!u.value||u.value.length==0||u.value==u.getAttribute("data-overlay")){MessageBox.confirm(n.getAttribute("data-error-html"),Translations.get(Translations.keys.SolveProblem),function(){u.focus()},n.getAttribute("data-error-title"),Translations.get(Translations.keys.Cancel),null,!0);return}Overlay.removeDefaults(e);o=it(e);f=Requests.get(Requests.keys.Context)+"="+i;f+="&"+Requests.get(Requests.keys.CustomSearchName)+"="+u.value;f+=r?"&"+Requests.get(Requests.keys.CustomSearchID)+"="+r:"";f+="&"+Requests.get(Requests.keys.SearchParameters)+"="+encodeURIComponent(JSON.stringify(o));ajaxRequest(n,t,"POST",f,function(n){n&&n.status==1&&n.data&&n.data.listContent&&(Popup.registerCallbacks(new Popup.LayerOptions(null,function(){$("#CustomSearchList").replaceWith(n.data.listContent)}),"CustomSearchPopup"),Popup.close())})},customSearchRemove:function(n,t,i,r){MessageBox.confirm(n.up("#CustomSearchList").getAttribute("data-remove-text"),Translations.get(Translations.keys.Yes),function(){ajaxRequest(n,t,"POST",(i?Requests.get(Requests.keys.CustomSearchID)+"="+i:"")+"&"+Requests.get(Requests.keys.Context)+"="+r)},"",Translations.get(Translations.keys.No))},customSearchChangeDefault:function(n,t,i,r){ajaxRequest(n,t,"POST",Requests.get(Requests.keys.CustomSearchID)+"="+i+"&"+Requests.get(Requests.keys.Context)+"="+r)},customSearchToggleVisibility:function(n,t,i,r){var e,u,f;if(!n||!t||!i||!r)return!1;e=n.parentNode;n.classList.contains("active")?(n.classList.remove("active"),Cookie.pop(t,i,r),u=document.createElement("I"),u.setAttribute("class","icon-esconder"),n.innerHTML=u.outerHTML+" "+n.getAttribute("data-unselected-text"),f=e.querySelector(".singleSelectionBtn"),f&&f.classList.contains("active")&&f.click()):(n.classList.add("active"),Cookie.push(t,i,r),u=document.createElement("I"),u.setAttribute("class","icon-esconder"),n.innerHTML=u.outerHTML+" "+n.getAttribute("data-selected-text"))},shareCodePopup:function(n,t,i,r){if(r)i=appendStringParams(i,Requests.get(Requests.keys.ObjectID)+"="+r);else{var u=Search.GenericList.getSelectedIDs();if(!u||u.length<=0){MessageBox.alert(n.getAttribute("data-no-items-msg"));return}i=appendStringParams(i,Requests.get(Requests.keys.ObjectIDs)+"="+u.join(","))}ajaxRequest(n,t,"POST",i)},shareToken:function(n,t,i){var r="",u;if(!i){if(u=Search.GenericList.getSelectedIDs(),!u||u.length<=0){MessageBox.alert(n.getAttribute("data-no-items-msg"));return}r+=Requests.get(Requests.keys.ObjectIDs)+"="+u.join(",")}r=appendStringParams(r,[$(n.up(".popupContent")).find(":input").serializeAll()]);ajaxRequest(n,t,"POST",r,function(n){n.status==1&&n.popupContent&&Popup.registerCallbacks(new Popup.LayerOptions(null,null,null,function(){Popup.close()}),0)})},saveToken:function(n,t){var r=n.up(".popupContent"),i=r.querySelector("#TokenInputArea"),u;if(i&&(i.value==undefined||i.value==""))return!1;u=$(r).find("input:hidden, textarea").serializeAll();ajaxRequest(n,t,"POST",u,function(n){Search.GenericList.deselectAll();Popup.close();n&&n.data&&n.data.url&&Search.fullSearch(null,n.data.url,null,!0)})},copyTokens:function(n){n&&(copyElementContents(n.up(".PopupContext").getElementsByTagName("code")[0]),Popup.close())},saveTokenPopup:function(n,t,i){ajaxRequest(n,t,"GET",i,function(n){if(n.status==1){var t=document.getElementById("TokenInputArea");t&&t.focus()}})},showOnlySelected:function(i,r){var f=Search.GenericList.getSelectedIDs(!0),u;if(!i||!r||!f)return!1;n.RequestParameters.SelectedIDs=f;n.RequestParameters.SelectAll=!0;t(i,r);u=document.getElementById("btSelectAll");u&&$(u).hide()},resetFilters:function(n){var t,i,r,u;n&&(t=$(n).closest(".popupBox").find("#AdvancedSearch"),t)&&(i=t.find(":checkbox, :radio").not(".dSelect *"),i.length&&i.prop("checked",!1),r=t.find("select"),r.length&&$.each(r,function(n,t){t.hasAttribute("data-dropdown")?EventHandler.trigger(t,"Dropdown:Reset"):(t.selectedIndex=0,EventHandler.trigger(t,"change"))}),u=t.find(":input"),u.length&&(u.not(":button, :submit, :reset, :checkbox, :radio, select").val("").trigger("change"),Overlay.applyDefaults(t[0])),c())},stickyListActions:function(){var n=-1e4,r=$(window).scrollTop(),u=$(window).width(),f=$(".PageListActions").outerHeight()+15,t=$(".listOrder"),i=t.length>0?t.offset().top||n:n;i>n&&r>i&&u<769?($(".PageListActions").addClass("fixed"),$(".listResults, .gridResults").css({marginTop:f})):($(".PageListActions").removeClass("fixed"),$(".listResults, .gridResults").css({marginTop:"auto"}))},fromPageContext:function(n,t,i,r){n=n||document.querySelector(".PageContext");n?Search.fullSearch(r,n.getAttribute("data-search-url"),null,t):i||window.location.reload(!0)}};return r.Sidebar=function(){function t(n){var u=document.getElementById(n),t,r,i;if(!u)return[];if(t=u.querySelectorAll(".selected"),t){for(r=[],i=0;i<t.length;i++)r.push(new ut(t[i].firstChild.getAttribute("data-name"),t[i].firstChild.getAttribute("data-value"),t[i].getAttribute("class")));return r}}function i(n,t){if(n)for(var i=0;i<n.length;i++)typeof t=="function"&&t(n[i])}function r(n,t,i,r){var f=document.getElementById(t),u;f&&(u=f.querySelector(i),u&&(typeof r=="function"&&r(n,u),u.parentElement.className=n.cssClass))}function u(n,t){i(n,function(n){r(n,t,'[data-value="'+n.value+'"]',function(n,t){t.setAttribute("data-name",n.name)})})}return{onPageBack:function(){i(n.QuickSearchSection,function(n){r(n,"QuickSearch",'[data-name="'+n.name+'"][data-value="'+n.value+'"]')});u(n.LabelsSection,"LabelsSidebarSection");u(n.PortalsSection,"PortalsSidebarSection")},onPageUnload:function(){n.QuickSearchSection=t("QuickSearch");n.LabelsSection=t("LabelsSidebarSection");n.PortalsSection=t("PortalsSidebarSection")}}}(),r.Simplified=function(){var t,n=[],i,r=function(i,r,u){var f=[],e=i.up(".SimplifiedSearch"),s=e.querySelector(".inputInfoContent"),o=e.querySelector(".PrivateData");Overlay.removeDefaults(e);f.push($(s).find("input, select").serializeAll());Overlay.applyDefaults(e);f.push(Requests.get(Requests.keys.Page)+"="+t);f.push(Requests.get(Requests.keys.SelectedIDs)+"="+n.join(","));o&&f.push($(o).find("input:hidden").serializeAll());f=f.filter(function(n){return n.length}).join("&");ajaxRequest(i,r,"POST",f,u)};return{getCurrentSelected:function(){return n},open:function(i,r,u,f,e,o){ajaxRequest(i,r,e?e:"GET",u,function(i){i.status==1&&(t=1,n=i.data&&i.data.selectedIDs?i.data.selectedIDs:[],typeof f=="function"&&f(),applyDropdowns(document.getElementById("SimplifiedSearchPopup")))},o)},controlUpdated:function(n,u){t=1;i&&clearTimeout(i);i=window.setTimeout(function(){r(n,u)},600)},loadChildLocation:function(n,t){Search.Simplified.controlUpdated(n,t);Location.search(n)},loadPage:function(n,i,u){t=u;r(n,i)},itemClick:function(t,i,r){var u,e,f,o;t&&t.getAttribute("data-id")&&(u=r?r:parseInt(t.getAttribute("data-id")),e=function(){var e=t.up(".SimplifiedSearchContent"),l=e&&e.getAttribute("data-is-single")=="true",s,c,o,f,h,i,r;if(t.classList.contains("active"))h=n.indexOf(u),h>-1&&n.splice(h,1),i=t.getAttribute("data-check-text"),i&&(r=t.getAttribute("data-action-icon"),t.innerHTML=(r?'<i class="{0}"><\/i> '.format(r):"")+i),t.classList.remove("active");else{if(t.classList.contains("data-uncheckable"))return;if(s=e.parentNode.querySelector('input[name="MaxSelectable"]'),s&&(c=parseInt(s.value),n.length>=c))return;if(n.push(u),l)for(o=e.querySelectorAll("a.active"),f=o.length-1;f>=0;f--)o[f]!=t&&o[f].click();i=t.getAttribute("data-uncheck-text");i&&(r=t.getAttribute("data-action-icon"),t.innerHTML=(r?'<i class="{0}"><\/i> '.format(r):"")+i);t.classList.add("active")}},i?(f=[],o=$(t.up(".SimplifiedSearch")).find(".PrivateData > input:hidden").serializeAll(),f.push(o),f.push(Requests.get(Requests.keys.SelectedIDs)+"="+u),ajaxRequest(t,i,"POST",f.join("&"),function(n){n.status==ajaxRequest.StatusType.Success&&e()})):e())},setSelected:function(t){var r,i,u;if(t)for(r=t.split(","),i=0,u=r.length;i<u;i++)n.push(parseInt(r[i]))},clearSelected:function(t){n=[];t}}}(),r.GenericList=function(){function r(n,t){var u=document.getElementById("hSelectAllLimit"),i=u?parseInt(u.value):0,r=document.getElementById("btSelectAll");r&&(n&&i>0&&t>=i?r.hide():!n&&(i==0||t<i)&&r.show())}function u(n,t){for(var r=!0,i=0;i<n.length;i++)if(n[i]&&t(n[i])){r=!1;break}return r}var i="",t="";return{_updateIDs:function(t){Array.isArray(t)&&t.length>0&&(n.SelectedObjectIDs=t)},init:function(){i||(i=" "+Translations.get(Translations.keys.SelectedSingle).toLowerCase());t||(t=" "+Translations.get(Translations.keys.SelectedMultiple).toLowerCase())},updateCount:function(){var r=document.getElementById("selectedCount");return r&&(n.SelectedObjectIDs.length>0?(r.textContent=n.SelectedObjectIDs.length+(n.SelectedObjectIDs.length===1?i:t),r.style.display="inline"):r.textContent="0"+t),r},selectAll:function(t,i,r,u,f){var e,o,s;if(f=f||".SearchResults",e=document.querySelector(f),!e||e.childNodes.length==0)return console.warn('Search.GenericList.selectAll nao executado: elemento com a classe o selector "'+f+'" nao foi encontrado.'),!1;o=(y?y+"&":"")+(r||"");s=function(i){var r,e,u,f,o;if(i.status==1&&i.data&&i.data.length>0&&(r=i.data.split(","),e=r?r.length:0,e>0)){for(f=0;f<e;f++)u=parseInt(r[f]),u>=0&&n.SelectedObjectIDs.indexOf(u)===-1&&n.SelectedObjectIDs.push(u);t.hide();o=document.getElementById("selectAllContextObjects");o.checked||o.click();Search.GenericList.updateCount()}};ajaxRequest(t,i,"POST",o,s,{async:u?!1:!0})},selectAllOneWay:function(){var n=document.querySelectorAll("input.ObjectChecker[type=checkbox]"),t;if(!n||n.length<=0)return!1;for(t=0;t<n.length;t++)n[t].checked||(n[t].checked=!0,n[t].onclick.call(n[t]));r(!0,n.length);Search.GenericList.updateCount()},deselectAll:function(t,i){var u=document.getElementById("selectAllContextObjects"),r,o,s;if(u&&u.onclick&&u.onclick.call(null),t&&(n.SelectedObjectIDs=[],n.RequestParameters.SelectedIDs=null),Search.GenericList.updateCount(),i){var f=document.getElementById("hVisibleObjIDs").value.split(","),h=f?f.length:0,e=[];for(r=0;r<h;r++)o=f[r],s=document.getElementById(o),s?s.setAttribute("map-checked","0"):e.push(o);e.length>0&&setTimeout(function(n){for(var u=n.length,t=0,r,i;t<u;t++)r=n[t],i=document.getElementById(r),i&&i.setAttribute("map-checked","0")}.bind(this,e),100)}},getSelectedIDs:function(t){return t?n.SelectedObjectIDs.join(","):n.SelectedObjectIDs},updateSelectedItems:function(t,i){var e,o,s,f,h,c;if(!t)return console.warn("Search.GenericList.updateSelectedItems nao executado: caller nao fornecido."),!1;if(!i&&!t.getAttribute("data-object-id"))return console.warn('Search.GenericList.updateSelectedItems nao executado: caller fornecido nao tem atributo "data-object-id" valido.'),!1;if(i&&(document.querySelector(".listResults > .detailSectionNoContent")||document.querySelector(".gridResults > .detailSectionNoContent")))return t.checked=!t.checked,!1;if(i){if(f=document.querySelectorAll("input.ObjectChecker[type=checkbox]"),!f||f.length<=0)return!1;for(e=0;e<f.length;e++)f[e].checked=t.checked,f[e].onclick.call(f[e]);r(t.checked,f.length)}else if(o=document.getElementById("selectAllContextObjects"),s=parseInt(t.getAttribute("data-object-id")),t.checked){if(n.SelectedObjectIDs.indexOf(s)==-1&&n.SelectedObjectIDs.push(s),f=document.querySelectorAll("input.ObjectChecker[type=checkbox]"),!f||f.length<=0)return!1;u(f,function(n){return!n.checked})&&o&&(o.checked=!0)}else h=n.SelectedObjectIDs.indexOf(s),h>-1&&n.SelectedObjectIDs.splice(h,1),o&&o.checked&&(o.checked=!1,c=document.getElementById("btSelectAll"),c&&c.show());Search.GenericList.updateCount()},updateSelectedMapItems:function(t,i){var s,f,e,o,l,v,a,c,h;if(!t)return console.warn("Search.GenericList.updateSelectedMapItems nao executado: caller nao fornecido."),!1;if(!i&&!t.getAttribute("data-object-id"))return console.warn('Search.GenericList.updateSelectedMapItems nao executado: caller fornecido nao tem atributo "data-object-id" valido.'),!1;if(i){for(o=0,e=document.getElementById("hVisibleObjIDs").value.split(","),o=0,l=e?e.length:0;o<l;o++)f=parseInt(e[o]),t.checked?(n.SelectedObjectIDs.indexOf(f)==-1&&n.SelectedObjectIDs.push(f),v="1"):(h=n.SelectedObjectIDs.indexOf(f),h>-1&&n.SelectedObjectIDs.splice(h,1),v="0"),s=document.getElementById(f),s&&s.setAttribute("map-checked",v);for(a=document.querySelectorAll("input.MapObjectChecker[type=checkbox]"),o=0,l=a?a.length:0;o<l;o++)a[o].checked=t.checked;r(t.checked,e.length)}else if(c=document.getElementById("selectAllContextObjects"),f=parseInt(t.getAttribute("data-object-id")),t.checked){if(n.SelectedObjectIDs.indexOf(f)==-1&&n.SelectedObjectIDs.push(f),document.getElementById(f).setAttribute("map-checked","1"),e=document.getElementById("hVisibleObjIDs").value.split(","),!e||e.length<=0)return!1;u(e,function(n){return document.getElementById(n).getAttribute("map-checked")!="1"})&&(c.checked=!0,$("#btSelectAll").hide())}else h=n.SelectedObjectIDs.indexOf(f),h>-1&&n.SelectedObjectIDs.splice(h,1),s=document.getElementById(f),s&&s.setAttribute("map-checked","0"),c&&c.checked&&(c.checked=!1,$("#btSelectAll").show());Search.GenericList.updateCount()},updatePageFromSelected:function(){var s=Search.GenericList.updateCount(),t,f,i,e,r,o,u;if(!s){console.warn("Search.GenericList.updatePageFromSelected nao executado: countElem nao encontrado.");return}if(n.SelectedObjectIDs.length>0){for(r=0,t=document.querySelectorAll("input[type=checkbox].ObjectChecker"),f=t&&t.length>0?t.length:0,u=0;u<f;u++)i=t[u],e=i?parseInt(i.getAttribute("data-object-id")):0,e>0&&n.SelectedObjectIDs.indexOf(e)>=0&&(i.checked=!0,r++);r>0&&r===f&&(o=document.getElementById("selectAllContextObjects"),o&&(o.checked=!0))}},onPageBack:function(n){var t=document.querySelectorAll("input.ObjectChecker[type=checkbox]"),i,r;if(!t||t.length<=0||!n||n.length<=0)return!1;for(i=0;i<t.length;i++)r=parseInt(t[i].value),n.findIndex(function(n){return n==r})>-1&&(t[i].checked=!0,t[i].onclick.call(t[i]))},getPageItemsIDs:function(n,t){var r,u,i,f;for(t=t||".ObjectChecker",r=document.querySelectorAll(t),n=n||r.length,u=[],i=0;i<n;i++){if(i==r.length)break;f=parseInt(r[i].getAttribute("data-object-id"));f&&u.push(f)}return u},getCheckbox:function(n,t){if(!n)return null;var i=t?'input.ObjectChecker[data-object-id="'+t+'"]':"input.ObjectChecker";return n.querySelector(i)},getAllIDs:function(n,t,i){i=i||2147483647;var r=Search.GenericList.getSelectedIDs(!0);return!r&&typeof n=="string"&&n.trim().length>0&&(Search.GenericList.selectAll(document.getElementById("btSelectAll"),n,Requests.get(Requests.keys.BusinessObject)+"="+t+"&"+Requests.get(Requests.keys.CustomLimit)+"="+i,!0),r=Search.GenericList.getSelectedIDs(!0)),r}}}(),r.Balloon=function(){var n=Object.freeze({And:"added",Or:"crossed",Exclude:"excluded"}),r=function(n,t,i){var e=document.createElement("a"),u,f,r;e.href="javascript:void(0);";e.setAttribute("onclick",'Search.Balloon.optionClick(this, "'+t+'", "'+i+'", "And");');e.textContent=Translations.get(Translations.keys.And);u=document.createElement("a");u.href="javascript:void(0);";u.setAttribute("onclick",'Search.Balloon.optionClick(this, "'+t+'", "'+i+'", "Or");');u.textContent=Translations.get(Translations.keys.Or);f=document.createElement("a");f.href="javascript:void(0);";f.setAttribute("onclick",'Search.Balloon.optionClick(this, "'+t+'", "'+i+'", "Exclude");');f.textContent=Translations.get(Translations.keys.Exclude).toLowerCase();r=document.createElement("div");r.setAttribute("class","balloonTag");r.appendChild(e);r.appendChild(u);r.appendChild(f);n.parentNode.insertBefore(r,n.nodeValue);$(r.parentNode).on("mouseout",function(){$(r).delay(500).fadeOut("fast")}).on("mouseover",function(){$(r).is(":visible")&&$(r).stop(!0,!0).fadeIn("fast")});return r},i=function(t){for(var i in n)t.classList.remove(n[i]);t.classList.remove("selected")},u=function(){$(".balloonTag:visible").hide()};return{click:function(n,f,e){var o=n.parentNode.getElementsByClassName("balloonTag");o=o.length==0?$(r(n,f,e)):$(o[0]);o.is(":visible")||(u(),o.fadeIn("fast"));n.parentNode.classList.contains("selected")?(i(n.parentNode),t(n,f)):n.nextSibling.firstChild.click()},optionClick:function(r,u,f,e){var o=r.parentNode.parentNode,s=o.classList.contains(n[e]);i(o);s||(o.classList.add("selected"),o.classList.add(n[e]),o.firstChild.setAttribute("data-name",f+e));t(r,u)}}}(),r.Entity=function(){function e(n,t,r){var u,e,f;return n?(u=i(n),!u)?(console.error("Search.Entity[_updateSearchResultPreview]: previewContext invalido ou nao fornecido. Nao é possivel atualizar a preview."),console.log(n),null):t?r?(n.querySelector("input[type=hidden].SelectedEntity.ContactID").value=r,u.innerHTML=t,e=u.getAttribute("data-show-create-new")==="true",f=u.querySelector(".AddNewContext"),f&&(f.setAttribute("data-search-bar",n.id),e&&f.show()),$(u).find(".PreviewTitle:first").text(u.getAttribute("data-title")||""),u):(console.error("Search.Entity[_updateSearchResultPreview]: entityID invalido ou nao fornecido. Nao é possivel atualizar a preview."),console.log(n),console.log(r),u):(console.error("Search.Entity[_updateSearchResultPreview]: html invalido ou nao fornecido. Nao é possivel atualizar a preview."),console.log(n),u):(console.error("Search.Entity[_updateSearchResultPreview]: searchBarContext invalido ou nao fornecido. Nao é possivel atualizar a preview."),null)}function c(n){if(!n)return!1;var t=n.up(".popupBox");return t&&t.classList.contains("thinBox")&&n.classList.contains("col-2")?!1:!0}function s(n){return function(n){var t="",i;return n&&(t=n.id),i=function(n){var e,f;if(t){var r=t?document.getElementById(t):null,i=r?r.querySelector(".input-value"):null,u=i?i.querySelector("i"):null;u?typeof n=="function"&&n(i,u):(e=r.getAttribute("data-searchBtnAction"),u=createHtmlElement("i",{"class":"icon-pesquisa"}),f=createHtmlElement("a",{href:"javascript:void(0);","class":"blueLink"},u),e?f.setAttribute("onclick",e):f.style.cursor="default",i=createHtmlElement("span",{"class":"input-value"},f),r.appendChild(i))}},{show:function(){i(function(n,t){n&&t&&(n.classList.add("focus","loading"),t.classList.replace("icon-pesquisa","icon-loading"))})},hide:function(){i(function(n,t){n&&t&&(n.classList.remove("focus","loading"),t.classList.replace("icon-loading","icon-pesquisa"))})}}}(n)}function f(n){if(n){if(n.classList.contains("ESB_SearchBarContext"))return n;var t=n.getAttribute("data-searchbar");if(t)return n.up().querySelector('[id="'+t+'"]')}return null}function u(n){if(n){if(n.classList.contains("ESB_EditorContext"))return n;var t=n.getAttribute("data-editor");if(t)return n.up().querySelector('[id="'+t+'"]')}return null}function i(n){if(n){if(n.classList.contains("ESB_PreviewContext"))return n;var t=n.getAttribute("data-preview");if(t)return n.up().querySelector('[id="'+t+'"]')}return null}function t(n,t){if(n){var i=n.getAttribute("data-grouping-key");n[t?"show":"hide"]();n.up().querySelectorAll(i).invoke(t?"show":"hide")}}function o(t,i,r){var u,f,e;if(isObject(n)&&!isEmptyObject(n)){if(!t){console.error("Search.Entity[_runSearchCallbacks]: searchBarContext invalido ou nao fornecido.");console.log(t);return}if(!i&&i!==0){console.error("Search.Entity[_runSearchCallbacks]: callbackType invalido ou nao fornecido.");console.log(i);return}if(u=n[i],Array.isArray(u)&&u.length)for(f=[t],r&&(f=mergeArrays(f,[r])),e=0;e<u.length;e++)u[e].apply(null,f)}}function h(n,t,f,e){var v,y,h,a,l;if(Search.Entity.nextRequest){setTimeout(Search.Entity.nextRequest,0);Search.Entity.nextRequest=null;return}v=n.getAttribute("data-searchdrop-id");h=n.up();h&&(h.id?y=h.id:h.id=y=shortGuid(),s(h).show());a=n.up(".ESB_SearchBarContext");l=appendStringParams($(a).find("*").serializeAll(),f);l=appendStringParams(l,$(u(a)).find("*").serializeAll());l=appendStringParams(l,$(i(a)).find("*").serializeAll());ajaxRequest(n,t,"POST",l,function(t){if(Search.Entity.nextRequest){setTimeout(Search.Entity.nextRequest,10);Search.Entity.nextRequest=null;return}if(Search.Entity.freeSearchTimeout=0,y&&s(document.getElementById(y)).hide(),e.clearChildren(),n.value.trim().length>2)if(t.status===ajaxRequest.StatusType.Success&&t.data&&typeof t.data=="string"&&(e.clearChildren(),htmlStringToElement(t.data).children.forEach(function(n){$(e).append(n)}),e=document.getElementById(v)),e.childNodes.length!=10&&e.containsNode(".contactSearchDropLine")){var i=n.up(".ContactContainer"),u=c(i);u&&(e.style.width=i.clientWidth+"px");$("#"+v).show().css({display:"block"});$("#"+v).find(".contactSearchDropLine.ObjectResultLine").each(function(n,t){$(t).mousedown(function(){t.setAttribute("data-clicked","1")})});i&&i.getAttribute("data-ignore-adj-overflow")!="1"&&Popup.adjustContentPosition(e,!1,i.getAttribute("data-force-adjust-overflow")=="1");o(a,r.OnSearchCompleted)}else e.hide(),Popup.adjustOverflow(!0)},{hideLoading:!0})}var r=Object.freeze({OnSearchCompleted:0,OnEntitySelected:1,OnPreviewCleared:2}),n=null;return{freeSearchTimeout:0,nextRequest:null,init:function(n){if(!n||!("emailRecipientLimit"in n))return console.error('cannot init Entity without specific options. expected: ["emailRecipientLimit"] | received: ['+(n?JSON.stringify(n):n+"")+"]"),!1;_EmailRecipientLimit=n.emailRecipientLimit},initBar:function(n,i){if(!n){console.error("Search.Entity.initBar: searchBarContext invalido ou nao fornecido.");console.log(n);return}if(!i){console.error("Search.Entity.initBar: previewContext invalido ou nao fornecido.");console.log(i);return}i.children.length?(t(n,!1),i.show()):(i.hide(),t(n,!0));$(i).find(".PreviewTitle:first").text(i.getAttribute("data-title")||"")},fullEntitySearch:function(n,t,i,r,u){var f,o,e;i.id||(f=i.id="SearchDrop_"+shortGuid(),t.setAttribute("data-searchdrop-id",f),i=document.getElementById(f));u=(u+"").trimChar("&");o=2;try{if(e=(t.textContent||t.value).trim(),!e){i.clearChildren().hide();Popup.adjustOverflow(!0);return}e.length>o&&getEventKeyCode(n)!=EventKeys.Enter&&(Search.Entity.freeSearchTimeout==0?(Search.Entity.freeSearchTimeout=1,setTimeout(function(){h(t,r,u,i)},1010)):Search.Entity.nextRequest=function(){h(t,r,u,i)})}catch(s){return console.error(s),!1}},selectEntity:function(n){var h=n.up(".ContactContainer").querySelector(".SearchInput"),f,s;if(h.value="",f=n.next(".ResultInfo"),!f){console.error("Search.Entity.selectEntity: elemento .ResultInfo nao encontrado.");console.log(n);return}var i=n.up(".ESB_SearchBarContext"),c=u(i),l=e(i,f.innerHTML,f.getAttribute("data-object"));t(i,!1);Element.hide(c);Element.show(l);i.classList.add("ItemChosen");o(i,r.OnEntitySelected,f.getAttribute("data-object"));s=i.querySelector(".contactSearchDrop");s&&s.clearChildren().hide()},chooseOther:function(n){var c=n.up(".ESB_Context"),a=i(c),e=f(c),s=u(c),h=e.querySelector("input[type=hidden].SelectedEntity.ContactID"),l=function(n,t){var i=n.querySelector(t);i&&i.value.trim()!=""&&(i.setAttribute("data-currvalue",i.value),i.value="")};h&&h.value.trim()!="0"?(h.setAttribute("data-currvalue",h.value),h.value=""):e.classList.remove("ItemChosen");s&&(l(s,"input[type=hidden][name$=_email]"),l(s,"input[type=hidden][name$=_fiscal]"),l(s,"input[type=hidden][name$=_address]"),s.hide());a.hide();e.querySelectorAll(".contactSearchDrop").invoke("hide");t(e,!0);e.querySelector(".SearchInput").focus();o(e,r.OnPreviewCleared)},byFinder:function(n,i,r){var f=n.up(".ESB_SearchBarContext");Search.Simplified.open(n,i,r,function(){Popup.registerCallbacks(new Popup.LayerOptions(null,function(){var n=Search.Simplified.getCurrentSelected(),i,r;!Array.isArray(n)||n.length<1||(n.length>1&&console.warn("Search.Entity.byFinder: selecionada mais que uma entidade; apenas a primeira será utilizada."),i=f.getAttribute("data-update-url"),r=appendStringParams(f.getAttribute("data-update-parameters"),Requests.get(Requests.keys.SelectedID)+"="+n[0]),ajaxRequest(null,i,"POST",r,function(n){var i,r;n.status==ajaxRequest.StatusType.Success&&isObject(n.data)&&n.data.html&&n.data.entityID&&(Element.hide(f.querySelector(".contactSearchDrop")),i=e(f,n.data.html,n.data.entityID),t(f,!1),r=u(f),Element.hide(r),Element.show(i))}))}),-1)})},addNewEntity:function(n,r){var e,o,p,a,v,c,h,y,s,l;if(!n){console.error("Search.Entity.addNewEntity: context invalido ou nao fornecido.");return}if(e=f(n),!e){console.error("Search.Entity.addNewEntity: searchBarContext invalido ou nao fornecido.");return}for(o=u(e),p=i(e),p.hide(),t(e,!1),a=e.querySelector(".SearchInput"),h=e.querySelector("input[type=hidden].SelectedEntity.ContactID"),v=o.querySelector("input[type=hidden][name$=_ascompany]"),v&&(v.value=r?"1":"0"),s=a?a.value.trim().split(" "):[""],c=o.querySelectorAll(".ESB_NameField"),l=c.length-1;l>-1;l--)c[l].value=l==0||s.length==1?s.length>1?s.join(" "):s[0]:s.pop();h&&h.value.trim()!="0"?(h.setAttribute("data-currvalue",h.value),h.value=""):e&&e.classList.remove("ItemChosen");o.querySelectorAll(".ESB_EditableField").forEach(function(n){n.value=""});y=o.querySelector(".ContactsFound");y&&(y.innerHTML="");o.show();c.length>0&&c[0].focus()},removeNew:function(n){var o=n.up(".ESB_EditorContext"),u=f(o),r=u.querySelector("input[type=hidden].SelectedEntity.ContactID"),e;r&&r.value&&r.value.trim()!="0"?(o.hide(),t(u,!1),$(i(u)).show()):(e="",r&&(e=r.getAttribute("data-currvalue")),r&&e!=""&&e.trim()!="0"?(r.value=e,o.hide(),t(u,!1),$(i(u)).show()):(u.classList.remove("ItemChosen"),Search.Entity.chooseOther(n)))},checkPersonalContact:function(n,t,i,r,u){if(n.value.length>3){var e=n.up(".ESB_EditorContext"),f=Requests.get(Requests.keys.EntityID)+"="+(r||0)+"&"+Requests.get(Requests.keys.Type)+"="+i+"&"+Requests.get(Requests.keys.Value)+"="+encodeURIComponent(n.value)+"&"+e.getAttribute("data-selector-params");u&&(f=appendStringParams(f,u));ajaxRequest(n,t,"POST",f)}},chooseType:function(n,t){var r=n.up(".ESB_EditorContext"),u=r.querySelector('input[name="'+t+'_ascompany"]"'),e=r.querySelector('input[name="'+t+'_firstname"]"'),f=e.up(".Section").querySelector(".formLabel"),i=r.querySelector('input[name="'+t+'_lastname]"');n.value=="1"?(u.value=1,f.innerHTML=Translations.get(Translations.keys.CompanyName),i&&i.up(".Section").hide()):(u.value=0,f.innerHTML=Translations.get(Translations.keys.FirstName),i&&i.up(".Section").show())},addEntitySearch:function(n,t){var i,r;if(!n){console.error("Search.Entity.addEntitySearch: context invalido ou nao fornecido.");return}if(!t){console.error("Search.Entity.addEntitySearch: templateID invalido ou nao fornecido.");return}if(i=document.getElementById(t),!i){console.error("Search.Entity.addEntitySearch: template nao encontrado.");return}r=shortGuid();n.appendChild(htmlStringToElement('<div class="TemplatedNewEntitySearch">'+i.innerHTML.replace(/\{#safeid\}/ig,r)+"<\/div>"));SearchBar.showTemplated(n)},associatePersonalContact:function(n,r){var u=n.up(".ESB_EditorContext"),o=f(u),s=$("#"+r);e(o,s.html(),s.attr("data-object"));u.hide();t(o,!1);$(i(u)).show();o.classList.add("ItemChosen")},remove:function(n){Element.remove(n.up(".TemplatedNewEntitySearch"))},rebuildType:function(n,t,i){ajaxRequest(n,t,"GET",i)},filterByNationality:function(n,t){Search.filterAction(n,t)},registerCallback:function(t,i){if(!t&&t!==0){console.error("Search.Entity.registerCallback: callbackType invalido ou nao fornecido.");console.log(t);return}if(typeof i!="function"){console.error("Search.Entity.registerCallback: callback invalida ou nao fornecida.");console.log(i);return}isObject(n)&&t in n&&Array.isArray(n[t])||(n={},forEachProp(r,function(t){n[r[t]]=[]}));n[t].push(i)},getEntityID:function(n){return n?parseInt($(n).find(".SelectedEntity.ContactID").val())||0:(console.error("Search.Entity.getEntityID: searchBarContext invalido ou nao fornecido."),console.log(n),null)},getEntityJson:function(n){var t,r;if(!n)return console.error("Search.Entity.getEntityJson: searchBarContext invalido ou nao fornecido."),console.log(n),null;if(t=i(n),!t)return console.error("Search.Entity.getEntityJson: previewContext nao encontrado."),console.log(t),null;if(r=$(t).find(".EntityJson").val()||"",!r)return console.error("Search.Entity.getEntityJson: entity json nao encontrado."),console.log(t),null;try{return JSON.parse(r)}catch(u){return console.error("Search.Entity.getEntityJson: erro ao deserializar o entity json."),console.log(r),null}}}}(),r.EntityContact=function(){function n(n){var t,i;if(n||(n=document.getElementById("ContactContent")||Popup.current()),!n)return console.error("Search.EntityContact.alertExceedingLimit: context nao encontrado."),console.log(n),!1;t=n.parentNode.classList.contains("EmailParams")?r:n.parentNode.classList.contains("WhatsAppData")?-1:2147483647;i=0;n.querySelectorAll(".ContactBar").forEach(function(n){i+=n.querySelectorAll('input[type="hidden"].Contact').length});t>0&&i>t&&MessageBox.alert(Translations.get(Translations.keys.EmailRecipientLimitExceeded))}function t(t,i){var r=createHtmlElement("div",{"class":"emailRecipient",innerText:i});r.appendChild(createHtmlElement("a",{href:"javascript:void(0);",onclick:'this.up(".emailRecipient").remove();'},createHtmlElement("i",{"class":"icon-fechar"})));r.appendChild(createHtmlElement("input",{type:"hidden",name:t.up(".ContactBar").getAttribute("data-input-name"),value:i,"class":"Contact"}));t.insertAdjacentHTML("beforebegin",r.outerHTML);t.innerHTML="";n()}function i(n,t,i,r){var u,f,e,o;if(Search.EntityContact.nextRequest){setTimeout(Search.EntityContact.nextRequest,10);Search.EntityContact.nextRequest=null;return}Loading.ensureInline(n).show();u=[Requests.get(Requests.keys.SearchText)+"="+r];f=n.getAttribute("data-privatedata");f&&(e=$("#"+f+" *").serializeAll()||"",e&&u.push(e));o=appendStringParams($(n.up(".RecipientBox").querySelector(".RecipientData")).find("*").serializeAll()||"",u);ajaxRequest(n,t,"POST",o,function(t){var r,u,f;if(Search.EntityContact.nextRequest){setTimeout(Search.EntityContact.nextRequest,10);Search.EntityContact.nextRequest=null;return}Search.EntityContact.timeout=0;Loading.ensureInline(n).hide();n.textContent.trim().length<=0?i&&i.style.display!="none"&&(i.clearChildren().hide(),Popup.adjustOverflow(!0)):(i.clearChildren(),t.status==ajaxRequest.StatusType.Success&&t.data&&typeof t.data=="string"&&(r=createHtmlElement("div",{innerHTML:t.data}).children[0],$(i).replaceWith(r),i=r),i.innerHTML&&i.innerHTML.indexOf("emailRecipient")!==-1?(u=n.up(".ContactContainer"),i.style.width=u.clientWidth+"px",i.show(),f=u.getAttribute("data-force-adjust-overflow")=="1",Popup.adjustContentPosition(i,!1,f)):(i.hide(),Popup.adjustOverflow(!0)))},{hideLoading:!0})}var r=0;return{timeout:0,nextRequest:null,showBar:function(n,t,i){if(!t){console.error("Search.EntityContact.showBar: context invalido ou nao fornecido.");console.log(t);return}var r=t.querySelector('[data-recipient-type="'+i+'"]');if(!r){console.error("Search.EntityContact.showBar: contactBar nao encontrada.");console.log(r);return}if(r.style.display!="none")return!1;r.show();Element.hide(n);r.querySelector(".ContactBar").click()},enterBar:function(n){$(n).find(".SearchInput:first").trigger("focus");n.classList.add("focus")},keydown:function(n,t){var e=getEventKeyCode(n),u,f,i,r;e===EventKeys.Enter?(u=t.up(".ContactContainer"),u&&u.querySelector(".contactSearchDrop").hide()):e===EventKeys.Backspace&&t.textContent.trim().length<=0&&(f=t.up(".ContactBar"),i=null,f&&(i=f.querySelectorAll(".emailRecipient")),r=null,i&&i.length>0&&(r=i[i.length-1]),r&&!r.hasAttribute("data-contactType")&&(r.remove(),$(t).trigger("focus")))},keypress:function(n,i,r){var f=getEventKeyCode(n),u,e,o,s;if(f===EventKeys.Enter||f===EventKeys.Space)return u=i.textContent.trim()||"",(r&&Email.isValid(u)||!r&&isValidPhone(u))&&(t(i,u),e=i.up(".ContactContainer").querySelector(".contactSearchDrop"),e&&(e.hide(),Popup.adjustOverflow(!0))),$(i).trigger("focus"),o=f===EventKeys.Enter||i.textContent.trim().length==0,s=!1,o&&(s=n||window.event),stopEventPropagation(n,s),o&&(clearTimeout(Search.EntityContact.timeout),Search.EntityContact.timeout=0,i.removeAttribute("ajaxrequest")),!1},exitBar:function(n,i){var r=(n.textContent||n.textContent).trim(),u;r.length<=0&&(u=n.up(".ContactContainer").querySelector(".contactSearchDrop"),u&&u.style.display!="none"&&(u.clearChildren().hide(),Popup.adjustOverflow(!0)));n.up(".ContactBar").classList.remove("focus");(i&&Email.isValid(r)||!i&&isValidPhone(r))&&r.length>3&&document.activeElement.id!="triggerMeEmail"&&(t(n,r),clearTimeout(Search.EntityContact.timeout),Search.EntityContact.timeout=0,n.removeAttribute("ajaxrequest"),n.up(".ContactContainer").querySelector(".contactSearchDrop").hide())},updateFromFinder:function(n,t,i){var u,r,f,e;if(!n)return console.error("Search.EntityContact.updateFromFinder: targetID invalido ou nao fornecido."),console.log(n),!1;if(u=Search.Simplified.getCurrentSelected(),!u||u.length<=0)return!1;if(r=typeof n=="string"?document.getElementById(n):n,!r||!r.classList.contains("ContactBar"))return console.error("Search.EntityContact.updateFromFinder: elemento .ContactBar nao encontrado."),console.log(n),!1;f=r.id;e=appendStringParams(i,Requests.get(Requests.keys.EntityIDs)+"="+u.join(","));ajaxRequest(null,t,"POST",e,function(n){if(n.status==ajaxRequest.StatusType.Success&&typeof n.data=="string"){var i=createHtmlElement("div",{innerHTML:n.data}),t="";i.querySelectorAll(".emailRecipient").forEach(function(n){t+=n.outerHTML});r.parentNode||(r=document.getElementById(f));r&&(r.querySelectorAll(".emailRecipient").forEach(function(n){n.id&&n.remove()}),r.querySelector(".SearchInput").insertAdjacentHTML("beforebegin",t))}})},registerCallback:function(n,t){if(!n){console.error("Search.EntityContact.registerCallback: contactInput invalido ou nao fornecido.");console.log(n);return}if(typeof t!="function"){console.error("Search.EntityContact.registerCallback: callback invalida ou nao fornecida.");console.log(t);return}n.SearchCallbacks||(n.SearchCallbacks=[]);n.SearchCallbacks.push(t)},byFinder:function(n,t,i,r,u){var s=[],c=n.up(".RecipientBox"),h,f,e,o,l;if(c&&(h=c.querySelector('[id="'+r+'"]')),h&&(f=h.querySelectorAll(".emailRecipient")),f&&f.length>0)for(e=0;e<f.length;e++)o=parseInt(f[e].getAttribute("data-contact")),o>0&&s.indexOf(o)===-1&&s.push(o);l=appendStringParams(i||"",Requests.getPair(Requests.keys.SelectedIDs,s.join(",")));Search.Simplified.open(n,t,l,function(){Popup.registerCallbacks(new Popup.LayerOptions(null,function(){Search.EntityContact.updateFromFinder(r,u,i)}),-1)})},fastSearch:function(n,t,r){var f,u;try{if(f=t.up(".ContactContainer").querySelector(".contactSearchDrop"),u=(t.textContent||t.value).trim(),!u){f.clearChildren().hide();Popup.adjustOverflow(!0);return}u.length>2&&getEventKeyCode(n)!=EventKeys.Enter&&(Search.EntityContact.timeout==0?(Search.EntityContact.timeout=1,setTimeout(function(){i(t,r,f,u)},1010)):Search.EntityContact.nextRequest=function(){i(t,r,f,u)})}catch(e){return!1}},selectResult:function(n,t,i){var u=n.up(".ContactContainer"),r,f,e;if(!u){console.error("Search.EntityContact.selectResult: elemento .ContactContainer nao encontrado acima do caller.");console.log(n);return}if(r=u.querySelector(".SearchInput"),!r){console.error("Search.EntityContact.selectResult: elemento .SearchInput nao encontrado dentro do container.");console.log(u);return}for(Array.isArray(r.SearchCallbacks)&&r.SearchCallbacks.forEach(function(t){t(r,n)}),r.innerHTML="",f=n.parentNode.querySelector('[id="'+t+'"]'),e=r.up();f.childNodes.length>0;)e.insertBefore(f.childNodes[0],r);f.up(".contactSearchDropContainer").remove();u.querySelector(".ContactBar").click();i&&Search.EntityContact.alertExceedingLimit(Popup.current())},alertExceedingLimit:n}}(),r.Realestate=function(){function n(n,t){var r,f,e,o,l,s,h,u,c;try{r=JSON.parse(t)}catch(a){return!1}if(f=n.querySelector(".RealestatePreview"),r&&f){if(n.querySelector("input[type=hidden][id=RealestateID]").value=r.id,e=n.querySelector("input[type=hidden][id=selectedRealestateAddress]"),e&&(e.value=r.address+" "+r.location),o=n.querySelector("input[type=hidden][id=selectedRealestateEnergy]"),o&&(o.value=r.energy),n.querySelector("input[type=hidden][id=RealestateID]").value=r.id,l=new Event("change"),n.querySelector("input[type=hidden][id=RealestateID]").dispatchEvent(l),s=n.querySelector(".Image"),s&&s.setAttribute("src",r.imageUrl),h=n.querySelector(".listItemLocation"),h&&(h.innerHTML=r.location),u=n.querySelector(".Title"),u)for(u.setAttribute("href",r.url),i=0;i<u.childNodes.length;i++)u.childNodes[i].nodeName=="#text"?u.childNodes[i].nodeValue=r.name+" ":u.childNodes[i].innerText=r.reference;c=n.querySelector(".SendEmail");c&&c.setAttribute("onclick",r.emailClick)}return f}function t(n,t,i,r){var u=n.parentNode.querySelector(".input-value"),e,f;u&&(u.classList.add("focus","loading"),e=u.querySelector("i"),e.classList.replace("icon-pesquisa","icon-loading"));f=n.getAttribute("data-searchdrop-id");ajaxRequest(n,t,"POST",i,function(t){u.classList.remove("focus","loading");e.classList.replace("icon-loading","icon-pesquisa");r.clearChildren();n.value.trim().length>2&&(t.status===ajaxRequest.StatusType.Success&&t.data&&typeof t.data=="string"&&(r.clearChildren(),htmlStringToElement(t.data).children.forEach(function(n){$(r).append(n)}),r=document.getElementById(f)),r.innerHTML?($("#"+f).show().css({display:"block"}),$("#"+f).find(".contactSearchDropLine.ObjectResultLine").each(function(n,t){$(t).mousedown(function(){t.setAttribute("data-clicked","1")})})):r.hide());Search.Realestate.freeSearchTimeout=0},{hideLoading:!0})}return{freeSearchTimeout:0,addNewRealestate:function(n,t){n.hide();t.show()},cancelAdd:function(n,t){n.show();t.hide();t.querySelectorAll("input:not(.reference), textarea").forEach(function(n){n.value=""})},byFreeText:function(n,i,r,u,f){var e,s,o;r.id||(e=r.id="SearchDrop_"+shortGuid(),i.setAttribute("data-searchdrop-id",e),r=document.getElementById(e));clearTimeout(Search.Realestate.freeSearchTimeout);Search.Realestate.freeSearchTimeout=0;i.removeAttribute("ajaxrequest");s=2;try{if(o=(i.textContent||i.value).trim(),!o){clearTimeout(Search.Realestate.freeSearchTimeout);r.clearChildren().hide();Popup.adjustOverflow(!0);return}o.length>s&&getEventKeyCode(n)!=EventKeys.Enter&&(i.removeAttribute("ajaxrequest"),Search.Realestate.freeSearchTimeout=setTimeout(function(){t(i,u,f,r)},1010))}catch(h){return!1}},chooseOther:function(n){var i=n.up(".RealestateSearchContext"),t=i.querySelector("input[type=hidden][id=RealestateID]");t&&t.value.trim()!="0"&&(t.setAttribute("data-currvalue",t.value),t.value="");i.querySelectorAll(".RealestatePreview,.contactSearchDrop").forEach(function(n){n.hide()});i.querySelector(".SearchContainer").show();i.querySelector(".RealestateInput").focus()},select:function(t){var r,i,f,u;if($(t.up(".SearchContainer")).find(".RealestateInput:first").val(""),r=t.querySelector(".RealestateInfo"),!r){console.error("Search.Realestate.select: elemento .RealestateInfo nao encontrado.");console.log(t);return}i=t.up(".RealestateSearchContext");f=n(i,r.value);i.querySelectorAll(".SearchContainer").invoke("hide");$(f).show();u=i.querySelector(".contactSearchDrop");u&&u.clearChildren().hide()},slideshow:function(n,t){var i=n.up(".RealestateSearchContext").querySelector("#RealestateID").value;i&&Slideshow.popupSlideshow(n,t,Requests.get(Requests.keys.ObjectIDs)+"="+i,Associated.Lead.Presentation.saveOnSlideshowClose)},byFinder:function(t,i,r){var u=t.up(".RealestateSearchContext");Search.Simplified.open(t,i,r,function(){Popup.registerCallbacks(new Popup.LayerOptions(null,function(){var t=Search.Simplified.getCurrentSelected(),i,r;Array.isArray(t)&&t.length==1&&(i=$(u.querySelector(".PrivateData")).find("*").serializeAll()||"",r=appendStringParams(i,[Requests.get(Requests.keys.ObjectID)+"="+t[0]]),ajaxRequest(null,u.getAttribute("data-update-url"),"POST",r,function(t){var i,r;t.status==1&&t.data&&(i=u.querySelector(".contactSearchDrop"),i&&i.hide(),r=n(u,t.data),u.querySelectorAll(".SearchContainer").forEach(function(n){n.hide()}),r&&r.show())}))}),-1)},"POST")}}}(),r.Vehicle=function(){function n(n,t){var r,f,h,e,o,u,s;try{r=JSON.parse(t)}catch(c){return!1}if(f=n.querySelector(".RealestatePreview"),r&&f){if(n.querySelector("input[type=hidden][id=RealestateID]").value=r.id,h=new Event("change"),n.querySelector("input[type=hidden][id=RealestateID]").dispatchEvent(h),e=n.querySelector(".Image"),e&&e.setAttribute("src",r.imageUrl),o=n.querySelector(".listItemLocation"),o&&(o.innerHTML=r.location),u=n.querySelector(".Title"),u)for(u.setAttribute("href",r.url),i=0;i<u.childNodes.length;i++)u.childNodes[i].nodeName=="#text"?u.childNodes[i].nodeValue=r.name+" ":u.childNodes[i].value=r.reference;s=n.querySelector(".SendEmail");s&&s.setAttribute("onclick",r.emailClick)}return f}function t(n,t,i,r){var u=n.parentNode.querySelector(".input-value"),e,f;u&&(u.classList.add("focus","loading"),e=u.querySelector("i"),e.classList.replace("icon-pesquisa","icon-loading"));f=n.getAttribute("data-searchdrop-id");ajaxRequest(n,t,"POST",i,function(t){if(u.classList.remove("focus","loading"),e.classList.replace("icon-loading","icon-pesquisa"),r.clearChildren(),n.value.trim().length>2){if(t.status===ajaxRequest.StatusType.Success&&t.data&&typeof t.data=="string"){var i=htmlStringToElement(t.data);r.clearChildren();i.children.forEach(function(n){$(r).append(n)});r=document.getElementById(f)}r.innerHTML?($("#"+f).show().css({display:"block"}),$("#"+f).find(".contactSearchDropLine.ObjectResultLine").each(function(n,t){$(t).mousedown(function(){t.setAttribute("data-clicked","1")})})):r.hide()}Search.Vehicle.freeSearchTimeout=0},{hideLoading:!0})}return{freeSearchTimeout:0,byFreeText:function(n,i,r,u,f){var e,s,o;r.id||(e=r.id="SearchDrop_"+shortGuid(),i.setAttribute("data-searchdrop-id",e),r=document.getElementById(e));clearTimeout(Search.Vehicle.freeSearchTimeout);Search.Vehicle.freeSearchTimeout=0;i.removeAttribute("ajaxrequest");s=2;try{if(o=(i.textContent||i.value).trim(),!o){clearTimeout(Search.Vehicle.freeSearchTimeout);r.clearChildren().hide();Popup.adjustOverflow(!0);return}o.length>s&&getEventKeyCode(n)!=EventKeys.Enter&&(i.removeAttribute("ajaxrequest"),Search.Vehicle.freeSearchTimeout=setTimeout(function(){t(i,u,f,r)},1010))}catch(h){return!1}},chooseOther:function(n){var i=n.up(".VehicleSearchContext"),t=i.querySelector("input[type=hidden][id=VehicleID]");t&&t.value.trim()!="0"&&(t.setAttribute("data-currvalue",t.value),t.value="");i.querySelectorAll(".VehiclePreview,.contactSearchDrop").invoke("hide");i.querySelector(".SearchContainer").show();i.querySelector(".VehicleInput").focus()},select:function(t){var r,i,f,u;if($(t.up(".SearchContainer")).find(".VehicleInput:first").val(""),r=t.querySelector(".VehicleInfo"),!r){console.error("Search.Vehicle.select: elemento .VehicleInfo nao encontrado.");console.log(t);return}i=t.up(".VehicleSearchContext");f=n(i,r.value);i.querySelectorAll(".SearchContainer").invoke("hide");Element.show(f);u=i.querySelector(".contactSearchDrop");u&&u.clearChildren().hide()},slideshow:function(n,t){var i=n.up(".VehicleSearchContext").querySelector("#VehicleID").value;i&&Slideshow.popupSlideshow(n,t,Requests.get(Requests.keys.ObjectIDs)+"="+i,Associated.Lead.Presentation.saveOnSlideshowClose)},byFinder:function(t,i,r){var u=t.up(".VehicleSearchContext");Search.Simplified.open(t,i,r,function(){Popup.registerCallbacks(new Popup.LayerOptions(null,function(){var t=Search.Simplified.getCurrentSelected(),i,r;Array.isArray(t)&&t.length==1&&(i=$(u.querySelector(".PrivateData")).find("*").serializeAll()||"",r=appendStringParams(i,[Requests.get(Requests.keys.ObjectID)+"="+t[0]]),ajaxRequest(null,u.getAttribute("data-update-url"),"POST",r,function(t){if(t.status===ajaxRequest.StatusType.Success&&t.data){Element.hide(u.querySelector(".contactSearchDrop"));var i=n(u,t.data);u.querySelectorAll(".SearchContainer").invoke("hide");Element.show(i)}}))}),-1)},"POST")}}}(),r.Emarketing=function(){function r(n,t,i){var u,r,f;i=i||t;u=null;i&&(u=i.getAttribute("data-key"));u&&(r=$(i).find(":input").val(),Array.isArray(r)&&(r=r.join(",")),f=encodeURIComponent(u)+"="+(r?encodeURIComponent(r):""),n.push(f))}function e(){var f,e,t,o=document.getElementById("Sidebar"),u=document.getElementById("ContactInfoTree"),h=document.getElementById("EmarketingTree"),n=[];return o&&(t=function(){var n=[];return o.querySelectorAll(".sidebarSection:not(#LabelsSidebarSection) > .sidebarSectionContent > .sidebarTree").forEach(function(t){var i=-1;t.id&&(i=s.findIndex(function(n){return n==t.id}));i==-1&&n.push(t)}),n}()),u&&(u.querySelectorAll(".sidebarTreeChild.Marked .sidebarTreeInput:not(.calendarOption)").forEach(function(t){r(n,t)}),u.querySelectorAll(".sidebarTreeChild.Marked .sidebarTreeRadioCheck.active").forEach(function(t){if(t.classList.contains("SelfCheck"))r(n,t);else{var i=t.next(".sidebarTreeChild");r(n,t,i?i.querySelector(".sidebarTreeInput"):null)}}),u.querySelectorAll(".sidebarTreeText.ContactTypeFilter.active").forEach(function(t){var r=t.getAttribute("data-key"),i,u;r&&(i=t.getAttribute("data-value"),u=encodeURIComponent(r)+"="+(i?encodeURIComponent(i):""),n.push(u))})),h&&i&&(f=[],h.queryChildren(".sidebarTreeText.active").forEach(function(n){var u=n.getAttribute("data-key"),i=n.next(".sidebarTreeChild"),t,r;i&&(t=[],i.querySelectorAll(".sidebarTreeText.active").forEach(function(n){var i=n.getAttribute("data-value"),u,r;if(i)for(u=i.split(","),r=0;r<u.length;r++)i=u[r],t.indexOf(i)==-1&&t.push(i)}),r=u+";"+t.join(","),f.push(r))}),e=i+"="+f.join("|"),n.push(e)),t&&t.length>0&&t.forEach(function(t){t.querySelectorAll(".sidebarTreeText.active").forEach(function(t){var r=t.getAttribute("data-key"),i=t.getAttribute("data-value"),u;r&&(i||i=="")&&(u=r+"="+i,n.push(u))})}),n.join("&")}function h(){var n=[],t=document.getElementById("Sidebar");return t&&t.querySelectorAll(".sidebarTree").forEach(function(t){var i=dataSerializer(t,".sidebarTreeText.active","data-key","data-value");i&&n.push(i)}),n.join("&")}function n(n,t,i){var u=n.next(".sidebarTreeChild"),r;u&&(u.classList.toggle("Marked",n.classList.contains("active")),r=null,t&&(r=u.querySelectorAll(t)),r&&typeof i=="function"&&r.forEach(i))}function c(n,t){u=n;i=t||"";f=!0}function l(){return f}function a(){switch(u){case t.Entity_Page:return e();case t.Campaign_Page:return h();case t.Entity_Step:var n=document.getElementById("EntityStepSlzParams"),i=e();return n&&(n.value=i),i}}function v(n){$(n).next(".sidebarSectionContent").stop(!0).slideToggle();n.classList.toggle("closed")}function y(t,i){if(t.classList.contains("active"))t.classList.remove("active"),n(t,".sidebarTreeInput:not(.Location), .sidebarTreeRadioCheck",function(n){var r,u;n.classList.remove("active");r=!1;t.classList.contains("SingleChildParent")?(u=n.querySelector("input[type=text]"),u&&(r=u.value.length>0,u.value="")):t.classList.contains("LocationParent")||(r=!0);!i&&r&&Search.fromPageContext()});else{t.classList.add("active");var r=i?null:function(n){n.focus()};n(t,"input[type=text]:not(.CalendarDateVal)",r);i||n(t,".sidebarTreeInput.SingleDropParent",function(n){var t=n.querySelector("select[multiple]");t&&t.value.length>0&&Search.fromPageContext()})}!i&&(t.classList.contains("LocationParent")||t.classList.contains("ContactTypeFilter"))&&Search.fromPageContext()}function o(t,i){var e=t.classList.contains("ParentBranch"),s=function(i,r){e&&n(t,t.getAttribute(i),function(n){n.classList.contains("sidebarTreeGroup")?o(n,!0):n.classList[r]("active")})},u,r;if(t.classList.contains("active")?(t.classList.remove("active","notAll"),s("data-inactive-query","remove")):(t.classList.add("active"),s("data-active-query","add")),!e&&(u=t.up(),u&&u.classList.contains("checkAll"))){var h=u.queryChildren(".sidebarTreeText"),c=h.length,f=h.filter(function(n){return n.classList.contains("active")}).length;c==f&&(r=u.previous(".sidebarTreeGroup"),r&&r.classList.remove("notAll"));c>f&&f>0&&(r=u.previous(".sidebarTreeGroup"),r&&r.classList.add("notAll"));f==0&&(r=u.previous(".sidebarTreeGroup"),r&&r.classList.remove("notAll","active"))}i||Search.fromPageContext()}function p(n){n.classList.toggle("active");Search.fromPageContext()}function w(t,i){var r=!1,u;t.classList.contains("active")?(t.classList.remove("active"),n(t,".sidebarTreeInput",function(n){var t=n.querySelector("input[type=text]");t&&(t.value="")}),r=!0):(t.siblings(".sidebarTreeRadioCheck.active").forEach(function(n){n.classList.remove("active");var i=n.next(".sidebarTreeChild"),t=null;i&&(t=i.querySelector("input[type=text]"));t&&(t.value="")}),t.classList.add("active"),u=i?null:function(n){n.focus()},n(t,"input[type=text]:not(.CalendarDateVal)",u));!i&&(r||t.classList.contains("SelfCheck"))&&Search.fromPageContext()}function b(n,t){if(t&&t.getAttribute("ajaxrequest")=="true"&&n)return stopEventPropagation(n,!0),!1}function k(n){n&&(!n.value||n.value.length>2)&&Search.fromPageContext(null,!1,!0,n)}function d(n){Location.search(n,null,null,function(n){n.status==1&&Search.fromPageContext()})}function g(){var i=document.getElementById("ContactRestrictionByEmarketingType"),n="",t;return i&&(t=[],t.push($(i).find("*").serializeAll()),n=appendStringParams(n,t)),n}function nt(n){var i=document.getElementById("PersonalContactPlaceIDs"),t;i&&(t=$(n).val(),Array.isArray(t)&&t.length>0&&(t=t.join(",")),i.value=t||"");Search.fromPageContext()}var t=Object.freeze({Entity_Page:1,Campaign_Page:2,Entity_Step:3}),u=0,i="",f=!1,s=["ContactInfoTree","EmarketingTree"];return{ContextKey:t,init:c,hasInitialized:l,serializeTreeFields:a,toggleExpand:v,toggleCheck:y,toggleGroupCheck:o,toggleSimpleCheck:p,toggleRadio:w,preventKeyupWhileSearching:b,inputSearch:k,onLocationChange:d,getRestrictionFilters:g,onPersonalContactPlaceChange:nt}}(),r.CalendarView=function(){function n(n,t){if(!n){console.warn("Search.CalendarView[_calendarSearchFromContext] nao executado: context nao fornecido.");return}Element.setValue(document.getElementById("ScheduleSearchDate"),t);Search.fullSearch(null,n.getAttribute("data-search-url"),null,!0)}return{fromContext:n,change:function(t,i){if(!t){console.warn("Search.CalendarView.change nao executado: caller nao fornecido.");return}n(t.up(".CalendarPaginatorContext"),i)}}}(),r.HolidayHomes=function(){return{changeValue:function(n,t,i,r){n&&i&&(Element.setValue(document.getElementById(i),r),Search.fullSearch(null,t,null,!0))},fullCustomSearch:function(n,t,i,r){ft(n,t,i,r)}}}(),r.AgencyNews=function(){return{loadButtonStatus:function(){return dataSerializer(".AgencyNewsButtons",".active","data-name","data-value")},toggleSearchButton:function(n){n&&(n.parentNode.toggleClass("active"),Search.fullSearch(n,!1,!1,!0))}}}(),r.Lead=function(){var n;return{searchOnkeyUpAction:function(t,i,r){var o,e,u,f,s;t&&($("#leadSearchResult").hide(),o=t.up(".inputInfoContent"),e=t.value,e.length>1&&(u=o.querySelector(".input-value"),u&&(u.classList.add("loading"),f=u.querySelector("i"),f&&f.classList.replace("icon-pesquisa","icon-loading")),s=1500,clearTimeout(n),n=setTimeout(function(){r=appendStringParams("searchText="+e,r);ajaxRequest(t,i,"POST",r,function(n){n.status==ajaxRequest.StatusType.Success&&($("#leadSearchResult").html()&&$("#leadSearchResult").show(),u.classList.remove("loading"),f.classList.replace("icon-loading","icon-pesquisa"))},{hideLoading:!0})},s)))},removeSelectedLead:function(n){n&&($("#leadToMerge").val(""),$("#leadSearchResult").show(),$("#inputSearchBar").show(),$("#inputValue").show(),$("#displayItem").hide())},selectLead:function(n,t,i){n&&($("#leadSearchResult").hide(),$("#inputSearchBar").hide(),$("#inputValue").hide(),$("#displayItem").show(),$("#leadToMerge").val(t),$("#displayName").text(i))}}}(),r.ProcessManagement=function(){var n;return{searchOnkeyUpAction:function(t,i,r){var o,e,u,f,s;t&&($("#processManagementSearchResult").hide(),o=t.up(".inputInfoContent"),e=t.value,e.length>1&&(u=o.querySelector(".input-value"),u&&(u.classList.add("loading"),f=u.querySelector("i"),f&&f.classList.replace("icon-pesquisa","icon-loading")),s=1500,clearTimeout(n),n=setTimeout(function(){r=appendStringParams("searchText="+e,r);ajaxRequest(t,i,"POST",r,function(n){n.status==ajaxRequest.StatusType.Success&&($("#processManagementSearchResult").html()&&$("#processManagementSearchResult").show(),u.classList.remove("loading"),f.classList.replace("icon-loading","icon-pesquisa"))},{hideLoading:!0})},s)))},removeSelectedProcessManagement:function(n){n&&($("#processManagementToMerge").val(""),$("#processManagementSearchResult").show(),$("#inputSearchBar").show(),$("#inputValue").show(),$("#displayItem").hide())},selectProcessManagement:function(n,t,i){n&&($("#processManagementSearchResult").hide(),$("#inputSearchBar").hide(),$("#inputValue").hide(),$("#displayItem").show(),$("#processManagementToMerge").val(t),$("#displayName").text(i))}}}(),r.Product=function(){var n;return{searchOnkeyUpAction:function(t,i,r){var o,e,u,f,s;t&&($("#productSearchResult").hide(),o=t.up(".inputInfoContent"),e=t.value,e.length>1&&(u=o.querySelector(".input-value"),u&&(u.classList.add("loading"),f=u.querySelector("i"),f&&f.classList.replace("icon-pesquisa","icon-loading")),s=1500,clearTimeout(n),n=setTimeout(function(){r=appendStringParams("searchText="+e,r);ajaxRequest(t,i,"POST",r,function(n){n.status==ajaxRequest.StatusType.Success&&($("#productSearchResult").html()&&$("#productSearchResult").show(),u.classList.remove("loading"),f.classList.replace("icon-loading","icon-pesquisa"))},{hideLoading:!0})},s)))},removeSelectedProduct:function(n){n&&($("#productToMerge").val(""),$("#productSearchResult").show(),$("#inputSearchBar").show().focus(),$("#inputValue").show(),$("#displayItem").hide(),Popup.current()&&Popup.adjustOverflow(!1))},selectProduct:function(n,t,i){n&&($("#productSearchResult").html("").hide(),$("#inputSearchBar").val("").hide(),$("#inputValue").hide(),$("#displayItem").show(),$("#productToMerge").val(t),$("#displayName").text(i))}}}(),r}(),SearchBar=function(){return{keypress:function(n,t,i,r){var e=getEventKeyCode(n),u,f;if(e===EventKeys.Backspace)return t&&(u=t.querySelector(".input-value"),u&&(u.classList.remove("focus","loading"),f=u.querySelector("i"),f&&f.classList.replace("icon-loading","icon-pesquisa")),clearTimeout(r),i&&i.clearChildren().hide()),!1},focus:function(n,t){if(!n){console.error("SearchBar.focus: caller invalido ou nao fornecido.");return}if(!t){console.error("SearchBar.focus: searchDrop invalida ou nao fornecida.");return}t.children.length&&($(t).show(),t.style.display="block");n.moveCursorEnd();Popup.adjustContentPosition(n,!1,!1)},exitBar:function(n,t){if(!t){console.error("SearchBar.exitBar: searchDrop invalida ou nao fornecida.");return}if(n){var i=n.relatedTarget||n.explicitOriginalTarget;if(i&&t.contains(i))return stopEventPropagation(n,!0),!1}if(t.querySelectorAll('.contactSearchDropLine[data-clicked="1"]').length)return stopEventPropagation(n,!0),!1;t.hide()},showTemplated:function(n){if(!n){console.error("SearchBar.showTemplated: context invalido ou nao fornecido.");return}var t=n.querySelectorLast(".ESB_SearchBarContext");return t&&(t.style.display="inline-block"),n}}}(),AjaxQueue=function(){var n=!1,t=[];return{push:function(i){t.push(i);n||AjaxQueue.process()},click:function(t,i,r,u,f,e){n=!1;Tabs.CollapsingPane.toggle(t,i,r,u,"",f,e)},process:function(){n=!1;t.length>0&&(n=!0,t.splice(0,1)[0]())}}}(),Notification=function(){function t(n,t,i){var f=n.up(".float-menu"),u,r;for(f.querySelector('input[class="assignedUserID"]').value=t,f.querySelector('span[class="assignedUserName"]').innerHTML=i,u=n.parentNode.childNodes,r=0;r<u.length;r++)u[r].nodeName==="A"&&u[r].classList.remove("active");n.classList.add("active")}function n(n,t,i){var r=n.up(".float-menu"),u;r.querySelector('div[class="shortMessageAddressList"]').style.display=t;r.querySelector('div[class="shortMessageAddressSelect"]').style.display=i;r.querySelector('input[class="assignedUserID"]').value="";u=r.querySelector('span[class="assignedUserName"]');u.innerHTML=u.getAttribute("data-default-text");r.querySelector('select[name="AssignedUserID"]').value=""}return{open:function(n,t){var i=n.up().querySelector("."+n.getAttribute("data-privateArea"));i?ajaxRequest(n,t,"GET",$(i).find("*").serializeAll(),function(){FloatMenu.bind(n)}):ajaxRequest(n,t,"GET",$("#"+n.id+" *").serializeAll(),function(){FloatMenu.bind(n)})},onKeyUp:function(n,t){textAreaKeyUp(n,t);n&&n.value.length>0?n.parentNode.querySelector(".shortMessageSubmit").classList.remove("disabled"):n.parentNode.querySelector(".shortMessageSubmit").classList.add("disabled")},save:function(n,t,i,r){var f=n.up(".float-menu"),e,o,s,u;if(!f){console.error("Notification.save: parentElement nao encontrado.");console.log(n);return}if(e=$("#"+f.id+" *").serializeArray(),o=e.find(function(n){if(n.name==="AssignedUserID"&&n.value!=="")return n.value}),!o){MessageBox.alert(i);return}if(u=document.querySelector("#"+f.id+' [name="Message"]'),u&&u.name==="Message"&&u.value.length>0&&u.value!==u.getAttribute("data-overlay")&&(s=u.value),!s){MessageBox.alert(r);return}ajaxRequest(n,t,"POST",e,function(){FloatMenu.forceClose(f)})},seeAll:function(t){n(t,"none","block")},chooseAnother:function(t){n(t,"block","none")},choose:function(n,i,r){t(n,i,r)},openEditPopup:function(n,t,i){ajaxRequest(n,t,"GET",i)},showContentPraisesAndNonConfor:function(n){n.up(".addedContent").hide();var t=n.up(".popupBox").querySelector("#ContentPraisesAndNonConfor");t&&t.show()},addItem:function(n){n.style.display="none";n.up(".contentHeader").querySelector(".addCheckBoxLine").style.display="block"},cancelItem:function(n){n.up(".addCheckBoxLine").querySelector(".InputName").value="";n.up(".addCheckBoxLine").style.display="none";n.up(".contentHeader").querySelector(".addCheckBoxLineBtn").style.display=""},addResponsible:function(n){var t=n.up(".NoteEditor").querySelector("#responsibleTemplate"),i;t&&(i=$(t).html(),$("#responsibleArea > .addedContent:last-of-type").before(i))},removeItem:function(n){var t=n.up(".addedContent");$(t).remove()},openPopupNotifications:function(n,t,i){var r=new Popup.LayerOptions(null,null,null,function(){Notification.refreshPraisesAndNonConformitiesList(i)});ajaxRequest(n,t,"GET",null,null,{popupOptions:r})},refreshPraisesAndNonConformitiesList:function(n){ajaxRequest(null,n,"GET")},savePraiseAndNonConformities:function(n,t){var i=$(n.up(".contentHeader")).find("input").serializeAll();ajaxRequest(n,t,"POST",i)},saveEdit:function(n,t){var i=n.up(".NoteEditor"),r=$("#"+i.id+" *").serializeArray();ajaxRequest(n,t,"POST",r,function(n){n.status===1&&Popup.close()})},addNewUsersSelect:function(n,t){var i=$('<div style="margin-top: 10px;"/>');i.append(n.clone());i.append('<div class="clearContent"><a style="cursor: pointer;" class="blueOutlineBtn" onclick="$(this).parent().parent().remove();"><i class="icon-fechar"><\/i><\/a><\/div>');t.append(i)},getList:function(n,t,i){var r=[];r.push(Requests.get(Requests.keys.Page)+"="+i);r.push($("#notificationContentData").find("*").serializeAll());r=r.filter(function(n){return n.length}).join("&");ajaxRequest(n,t,"POST",r)}}}(),Slideshow=function(){function f(n){return n?(n.id||(n.id="slideshow_elem_"+shortGuid()),n.id):(console.error("Slideshow[_ensureSlideshowDomElementID]: domElem invalido ou nao fornecido."),console.log(n),null)}function t(t,i,r,u){var y,c,e,a,l,o,s,v;if(r=r||".swiper-container-photos",y=t&&t>1?!0:!1,c={spaceBetween:30,centeredSlides:!0,observer:!0,observeParents:!0,noSwiping:y?!1:!0,mode:"horizontal",loop:!1,lazy:!0,pagination:{el:".swiper-pagination",clickable:!0,type:"fraction"},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}},isObject(u)&&(c=$.extend(!0,c,u)),e=null,i&&(e=i.querySelectorAll(".propertyPhoto")),a=new Swiper(r,c),e)for(l=0;l<e.length;l++)o=e[l],o&&o.querySelectorAll("img").length==1&&(Element.hide(o.querySelector(".swiper-button-next")),Element.hide(o.querySelector(".swiper-button-prev")));return(i&&typeof r=="string"?s=i.querySelector(r):isObject(r)&&(s=r),v=f(s),!v)?(console.error("Slideshow[_initPhotosSlideshow]: erro ao obter o ID do elemento que deve conter o slideshow. operacao cancelada."),console.log(s),null):(n.remove(function(n){return n.id===v}),n.push(new h(s,a)),a)}function e(n){var f=n.parentNode,e=f.querySelector(".swiper-container"),r="swipperFullscreen",t=$(e).html();t=t.replace(/ data-src=/g," src-ori=");t=t.replace(/data-fullscreen-/g,"");t+='<div class="fullscreen-swiper-close"><\/div>';_SwipperContainer=document.createElement("div");_SwipperContainer.setAttribute("id",r);document.body.appendChild(_SwipperContainer);_SwipperContainer=document.getElementById(r);_SwipperContainer.innerHTML='<div class="fullscreen-swiper">'+t+'<\/div><div class="fullscreen-swiper-backdrop"><\/div>';var u=_SwipperContainer.querySelector(".fullscreen-swiper-backdrop"),i=_SwipperContainer.querySelector(".fullscreen-swiper"),o=_SwipperContainer.querySelector(".fullscreen-swiper-close"),s=new Swiper($(i),{observer:!0,observeParents:!0,noSwiping:!0,mode:"horizontal",loop:!1,lazy:!0,pagination:{el:".swiper-pagination",clickable:!0,type:"fraction"},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},autoplay:!1});$("body, html").addClass("no-scroll");$(i).fadeIn();$(u).fadeIn();$(o).on("click",function(){$("body, html").removeClass("no-scroll");$(i).hide().empty();$(u).fadeOut(function(){$(_SwipperContainer).remove()})})}function r(t,r){return new Popup.LayerOptions(null,null,null,function(u){t||(i=null);n=[];typeof r==typeof Function&&r(u)})}function u(n,u,f,e,o,s,h,c){var l,a;if(!h&&(l=Search.GenericList.getSelectedIDs(),!l||l.length<=0)){MessageBox.alert(e);return}a=function(){i=n;var e=typeof c!=typeof Function,o={popupOptions:r(e,c)};ajaxRequest(n,u,"POST",f,function(n){if(n.status===ajaxRequest.StatusType.Success&&n.popupContent&&isObject(n.data)&&"slideshowCount"in n.data){var i=Popup.current();t(null,null,i.querySelector(".swiper-container-slideshow"),{loop:!1,noSwiping:!0,noSwipingClass:"swiper-container-slideshow",pagination:{el:".slideshow-pagination-content"},navigation:{nextEl:".slideshow-next",prevEl:".slideshow-prev"}});t(n.data.slideshowCount,i)}},o)};o&&s&&l.length>s?MessageBox.confirm(o.format(l.length),Translations.get(Translations.keys.OK),a):a()}function o(){function f(n,i){n&&n.split(",").forEach(function(n){videojs(n,{controls:!0,autoplay:!1,preload:"auto",flash:{swf:i}});t.push({playerID:n})})}function i(n,i){var f="#"+n,h=i.activeIndex,a=$(f+" .swiper-thumbs > div").length,c,e,o,r,s;$(f+" .swiper-thumbs > div").removeClass("active");h>a?$(f+" .swiper-thumbs > div").eq(0).addClass("active"):$(f+" .swiper-thumbs > div").eq(h).addClass("active");var v=$(f+" .swiper-thumbs").outerWidth(),l=$(f+" .swiper-thumbs > div").outerWidth(),y=$(f+" .swiper-thumbs > div.active").prevAll().length+1,p=y*l-v/2-l/2,w=$(window).width();w<769&&$(f+" .swiper-thumbs").animate({scrollLeft:p},800);$(".youtubeVideo").html("");$(".Image360").html("");i.slideTo(i.activeIndex,500);o=$(f+" .swiper-slide")[h];o&&(r=$(o).children("div").first(),r&&(r.hasClass("youtubeVideo")?(e=r.attr("data-url"),e&&u.startPlayer(r,e)):r.hasClass("Image360")&&(c=r.attr("data-file"),e=r.attr("data-url"),e&&r.append('<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="https://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,29,0" id="player" width="100%" height="100%" style="position: absolute;" ><param name="src" value="'+c+"?file="+e+"&rnd=1528468398358&tour="+e+'.xml&culture=null"><param name="quality" value="high"><param name="allowFullScreen" value="true"><embed pluginspage="https://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" value="true" id="player" width="100%" height="100%" src="'+c+"?file="+e+"&rnd=1528468398358&tour="+e+'.xml&culture=null"><\/object>'))),t&&t.length>0&&(t.forEach(function(n){var i=n.playerID,t;i&&(t=videojs.getPlayer(i),t&&!t.paused()&&(t.pause(),t.currentTime(0)))}),o=$(f+" .swiper-slide")[i.activeIndex],o&&(r=$(o).children("div")[0],r&&(s=$(r).attr("id"),s&&s.startsWith("video_")&&videojs.getPlayer(s).play()))))}var n=null,r=null,t=[],u=function(){function i(t){return t.indexOf("//www.")===-1&&(t=t.replace("//","//www.")),t=t.replace("youtu.be",n),t=t.replace("youtube.com/v",n),t.replace("youtube.com/watch?v=",n)}function r(n){var t=n.getAttribute("data-youtube-iframe");return t||(t="YT_Vid_"+shortGuid(),n.setAttribute("data-youtube-iframe",t)),t}function u(n,t,i,r){var u=document.getElementById(n);return u||(u=createHtmlElement("iframe",{id:n,width:i,height:r,frameborder:"0"}),u.style.border="none",t.appendChild(u)),u}function f(n,i,r,u,f){var o=n.contentWindow.document,e;return o.open(),o.write('<html><head><title><\/title><\/head><body style="font-size:0;margin:0;padding:0;"><div id="PlayerContainer"><\/div><script src="'+i+'"><\/script><script type="text/javascript">window.player = undefined;function onYouTubeIframeAPIReady() {window.player = new YT.Player('+t+");}<\/script><\/body><\/html>"),o.close(),e=createHtmlElement("iframe",{id:t,src:r,width:u,height:f,frameborder:"0",enablejsapi:"true"}),e.style.border="none",n.contentWindow.document.querySelector("#PlayerContainer").appendChild(e),e}var n="youtube.com/embed",t="PlayerIframe";return{startPlayer:function(n,e){if("jQuery"in window&&n instanceof jQuery&&(n=n.get(0)),!n){console.error("_YouTubeManager.startPlayer: target invalido ou nao fornecido.");return}if(!e){console.error("_YouTubeManager.startPlayer: url invalida ou nao fornecida.");return}var o=i(e),s=$(n).innerWidth().toString(),h=$(n).innerHeight().toString(),a=r(n),c=u(a,n,s,h),l=c.contentWindow.document.querySelector("#"+t);l?l.src=o:f(c,n.getAttribute("data-youtube-api"),o,s,h)}}}();return{init:function(t,u){var h=t?document.getElementById(t):null,e,o="#"+t,s,c,l;if(!h){console.warn("cannot initialize MultiPlayer without valid controller. received controllerID:");console.log(t);return}if(e=h.querySelector(".swiper-container-photos"),!e){console.warn("slideshow MultiPlayer target element not found.");return}if(e._MultiplayerInitialized){console.log("slideshow MultiPlayer ja inicializado para o seguinte elemento:");console.log(e);return}e._MultiplayerInitialized=!0;f(h.querySelector("#videoPlayersID").value,h.querySelector("#swfSrc").value);s=Slideshow.init(1,null,e,{noSwipingClass:"disableSliding"});s.on("slideChange",function(){i(t,this,u)});u?r=s:n=s;$(o+" .swiper-thumbs > div").click(function(){s.slideTo($(this).index(),500)});c=$(o+" .swiper-thumbs > div").length;$(o+" .showExtraContent a span").text("("+c+")");l=$(o+" .showExtraContent a").html();$(o+" .showExtraContent a").click(function(){$(this).parent().parent().find(".swiper-thumbs").hasClass("open")?($(this).parent().parent().find(".swiper-thumbs").removeClass("open"),$(this).html(l)):($(this).parent().parent().find(".swiper-thumbs").addClass("open"),$(this).html(Translations.get(Translations.keys.Close)))});$(o+" .swiper-container").on("mouseenter",function(){var n=$(this).find(".MultiplayerMediaControls");this.getAttribute("data-vis")!="1"?this.setAttribute("data-vis","1"):n.stop(!0);n.fadeIn(500,function(){n.css("opacity","")})}).on("mouseleave",function(){if(this.getAttribute("data-vis")=="1"){var n=$(this).find(".MultiplayerMediaControls"),t=this;n.fadeOut(500,function(){t.setAttribute("data-vis","0")})}}).animate({opacity:1},400,"linear");i(t,s)},toggleSliding:function(t){t&&n&&($(t).hasClass("play")?($(t).removeClass("play").addClass("stop"),n.autoplay.start()):($(t).removeClass("stop").addClass("play"),n.autoplay.stop()))},updateMediaRender:function(n){if(n){var t=$(n.querySelector(".PrivateData")).find("*").serializeAll();ajaxRequest(null,n.getAttribute("data-update-url"),"GET",t,function(t){t.status==ajaxRequest.StatusType.Success&&Slideshow.MultiPlayer.init(n.id)})}},fullscreen:function(t){var u=t.parentNode.parentNode,c=u.querySelector(".swiper-container"),l=u.querySelector(".PrivateData"),a=guid(),f="swipperFullscreen_"+a,e=$(l).html(),r;e=e.replace(u.id,f);r=$(c).html();r=r.replace(/ src=/g," src-ori=");r=r.replace(/data-fullscreen-/g,"");r+='<div class="fullscreen-swiper-close"><\/div>';_SwipperContainer=document.createElement("div");_SwipperContainer.setAttribute("id",f);_SwipperContainer.setAttribute("data-update-url",u.getAttribute("data-update-url"));_SwipperContainer.addClassName(u.className);document.body.appendChild(_SwipperContainer);_SwipperContainer=document.getElementById(f);_SwipperContainer.innerHTML='<div class="PrivateData">'+e+'<\/div><div class="fullscreen-swiper swiper-container-photos">'+r+'<\/div><div class="fullscreen-swiper-backdrop"><\/div>';var o=_SwipperContainer.querySelector(".fullscreen-swiper-backdrop"),s=_SwipperContainer.querySelector(".fullscreen-swiper"),v=_SwipperContainer.querySelector(".fullscreen-swiper-close"),y=_SwipperContainer.querySelector(".swiper-open-fullscreen"),h=_SwipperContainer.querySelector(".slideshowPlayer ");y.hide();h&&h.hide();Slideshow.MultiPlayer.init(f,!0);$("body, html").addClass("no-scroll");$(s).fadeIn();$(o).fadeIn();$(v).on("click",function(){$("body, html").removeClass("no-scroll");$(s).hide().empty();$(o).fadeOut(function(){$(_SwipperContainer).remove()});i(u.id,n);n.slideTo(0,500)})}}}function s(){function e(t,i,u){var e=Requests.get(Requests.keys.ObjectID)+"="+i;r.includes(i)==!1&&(r.push(i),e=e+"&"+Requests.get(Requests.keys.Value)+"=1");ajaxRequest(null,f,"GET",e,function(t){if(t&&t.status==ajaxRequest.StatusType.Handled&&t.data&&t.data.InvalidPopup==!0){var i=n.activeIndex;u.remove();n.updateSlides();i>0&&(i<n.slides.length?(n.slideTo(0),n.slideTo(i)):n.slideTo(n.slides.length-1))}})}function o(n,t){var r=t.activeIndex,o=$(n+" .swiper-page")[u],i=$(n+" .swiper-page")[r],f;i&&(f=i.getAttribute("data-popup-id"),e(t,f,i),setTimeout(o.html(""),3e3),u=r)}var u=0,f="",r=[],n=null,i="";return{init:function(u,e){ajaxRequest(u,e,"GET","",function(u){var e,h,s,c,l;if(u&&u.status==ajaxRequest.StatusType.Success){e=null;i=guid();h=Popup.current();e=h.querySelector(".swiper-container-slideshow");e.setAttribute("id",i);f=e.getAttribute("data-content-load");s=t(1,null,e,{loop:!1,noSwiping:!0,noSwipingClass:"swiper-container-slideshow",pagination:{el:".slideshow-pagination-content"},navigation:{nextEl:".slideshow-next",prevEl:".slideshow-prev"}});s.on("slideChange",function(){o("#"+i,this)});c=$("#"+i+" .swiper-page")[s.activeIndex];l=c.getAttribute("data-popup-id");r.push(l);n=s}})}}}function h(i,r){function s(i,r,u,s){var l=appendStringParams(o,[Requests.getPair(Requests.keys.ObjectID,r),Requests.getPair(Requests.keys.Index,s)]),h,c;f.includes(r)||f.push(r);h=u.id;c=u.querySelectorAll(".swiper-container-initialized").map(function(n){return n.id}).filter(function(n){return n});ajaxRequest(null,e,"GET",l,function(r){var f,e;if(r.status===ajaxRequest.StatusType.Success)u=Popup.current().querySelector("#"+h),c.forEach(function(t){n.remove(function(n){return n.id===t})}),t(n.length,u),Popup.rebind();else{if(f=n.find(function(n){return n.id===i}),!f)return;e=f.swiper.activeIndex;u.remove();f.swiper.updateSlides();e>0&&(e<f.swiper.slides.length?(f.swiper.slideTo(0),f.swiper.slideTo(e)):f.swiper.slideTo(f.swiper.slides.length-1))}})}function h(n,t){var r=t.activeIndex,u="#"+n+" .swiper-page",i=$(u)[r];i&&s(n,i.getAttribute("data-object"),i,r)}if(!i||!i.id)throw new Error("domElem invalido para criacao de SlideshowLayer.");if(!r)throw new Error("swiper invalido para criacao de SlideshowLayer.");this.id=i.id;this.swiper=r;var u=this,f=[],e=i.getAttribute("data-content-url"),o=i.getAttribute("data-content-params");if(e)u.swiper.on("slideChange",function(){var n=this.activeIndex,t=$("#"+u.id+" .swiper-page")[n],i=t.getAttribute("data-object");f.includes(i)||h(u.id,this)})}var i=null,n=[];return{popupSlideshow:function(n,u,f,e){i=n;ajaxRequest(n,u,"POST",f,function(n){n.status==ajaxRequest.StatusType.Success&&n.popupContent&&isObject(n.data)&&"slideshowCount"in n.data&&t(n.data.slideshowCount,Popup.current())},{popupOptions:r(!1,e)})},popupSlideshowBulk:function(n,t,i,r,f,e,o,s){u(n,t,i,r,f,e,o,s)},onPicLoadError:function(n,t){var i=n.getAttribute("data-alternative-src"),r=n.getAttribute("data-error-src");i?(n.src=i,n.removeAttribute("data-alternative-src")):r?(n.src=r,n.removeAttribute("data-error-src")):(n.up(".swiper-slide").querySelector(".swiper-image-description").hide(),n.src=t)},popupFractionsSlideshowBulk:function(n,t,i){u(n,t,i,Translations.get(Translations.keys.NoFractionSelected))},fullscreen:function(n){e(n)},slideshowKiosk:function(n){var t=Search.GenericList.getSelectedIDs(!0);if(t.length<=0){MessageBox.alert(Translations.get(Translations.keys.NoRealestateSelected));return}window.post(n,{ids:t},"_blank")},init:function(n,i,r,u){return t(n,i,r,u)},getStarter:function(){return i},getLayerCount:function(){return n.length},MultiPlayer:o(),AgencyNews:s()}}(),Historic=function(){var n={loadSimpleEditor:function(n,t,i){TinyMceEditor.loadSimpleEditor(n,t,i,Historic.validateTextBox,Historic.fadeOutTextBoxDefault);var r=document.getElementById(n),u=r?r.up(".tinyeditor"):null;u&&u.removeAttribute("style")},validateTextBox:function(){HistoricBody.TinyEditor&&HistoricBody.TinyEditor.e.body.textContent.trim()!=""?Historic.fadeOutTextBoxDefault():($(document.getElementById("HistoricEditor").querySelector(".shortMessageDefault")).fadeIn(),$(document.getElementById("HistoricEditor").querySelector(".shortMessageSubmit")).addClass("disabled"))},fadeOutTextBoxDefault:function(){$(document.getElementById("HistoricEditor").querySelector(".shortMessageDefault")).fadeOut();$(document.getElementById("HistoricEditor").querySelector(".shortMessageSubmit")).removeClass("disabled")},init:function(n){Historic.loadSimpleEditor("HistoricBody",40,"padding: 8px 100px 8px 8px;");Historic.initializeMedia(n,null,null,"#NoteCreationArea");Historic.setIframeBodyEvents()},toggleFastInsert:function(n){var t,i;n.classList.toggle("active");n.querySelector("i").classList.toggle("icon-lapis");n.querySelector("i").classList.toggle("icon-fechar");t=n.up(".listItemNote").querySelector("textarea");n.classList.contains("active")||(t.classList.add("greyText"),t.value=t.getAttribute("data-overlay"),i=n.up(".listItemNote").querySelector(".shortMessageSubmit"),i&&!i.classList.contains("disabled")&&i.classList.add("disabled"));$(n.nextElementSibling).stop().slideToggle("fast",function(){n.classList.contains("active")&&t.focus()})},fastInsertOnKeyUp:function(n){n&&n.value.length>0?n.parentNode.querySelector(".shortMessageSubmit").classList.remove("disabled"):n.parentNode.querySelector(".shortMessageSubmit").classList.add("disabled")},createQuickHistoric:function(n,t,i,r){var u=n.up(".shortMessageContent").querySelector("textarea"),f,e;if(u&&(f=u.value,e=u.getAttribute("data-overlay")),!f||f.trim().length<=0||e&&f==e)return!1;ajaxRequest(n,t,"POST",$("#divHistoricFastEdit_"+i+" *").serializeAll(),function(n){if(n&&n.status==1){$("#divHistoricSuccess_"+i).slideDown();r||(document.getElementById("anchorListItemNoteBtn_"+i).style.opacity=0);document.getElementById("divShorMessageContent_"+i).style.opacity=0;var t=document.getElementById("textArea_"+i);t.innerHTML="";t.value="";Overlay.applyDefaults(u.parentElement);setTimeout(function(){if($("#divHistoricSuccess_"+i).slideUp(),document.getElementById("divShorMessageContent_"+i).style.opacity=1,!r){document.getElementById("anchorListItemNoteBtn_"+i).style.opacity=1;var n=document.getElementById("divHistoricFastEdit_"+i).querySelector(".listItemNoteBtn");n.onclick.apply(n)}},1500)}})},popupBulk:function(n,t,i){var r=Search.GenericList.getSelectedIDs();if(!r||r.length<=0){MessageBox.alert(n.getAttribute("data-no-items-msg"));return}ajaxRequest(n,t,"POST",i)},setNotify:function(n,t){var u=n.up(".NoteEditor"),i,f,r,e;n.nodeName.toLowerCase()=="select"?n.value===t&&(i=u.querySelector(".NoteNotification"),i.querySelector(".ReminderMarker").hide(),f=i.querySelector(".InputDate"),f.show()):(i=u.querySelector(".NoteNotification"),r=i.querySelector(".ReminderMarker"),r.show(),e=r.querySelector("select").options[0].value,r.querySelector("select").value=e,i.querySelector(".InputDate").hide())},adjustTextArea:function(n){if(n)if(n.value.length>240)n.setAttribute("data-og-height",$(n).height()),$(n).stop().animate({height:"200px"},40);else if(n.value.length<220){var t=n.hasAttribute("data-og-height")?n.getAttribute("data-og-height"):114;$(n).stop().animate({height:t+"px"},40)}},saveBulk:function(n,t){var u=n.up("#PopupCreateHistoric"),i=u.querySelector("#HistoricBody"),r,f;if(!i||i.value.trim().length<=0)return r=n.getAttribute("data-blank-body-msg"),r&&MessageBox.confirm(r,Translations.get(Translations.keys.OK),function(n){n.focus()}.bind(this,i),"",Translations.get(Translations.keys.Cancel),null,!0),!1;f=$(u).find("*").serializeAll();ajaxRequest(n,t,"POST",f)},styleMoreOptionsAnchor:function(n){var t=$(n),i,r;t.parent().hasClass("active")?(i=t.parent().attr("data-moreoptions"),t.parent().children(".blueLink").html(i),t.parent().parent().find(".detailNotesActions").slideUp(),t.parent().removeClass("active"),r=t.parent().attr("data-cookiename"),Cookie.remove(r)):(i=t.parent().attr("data-lessoptions"),t.parent().children(".blueLink").html(i),t.parent().parent().find(".detailNotesActions").slideDown(),t.parent().addClass("active"),r=t.parent().attr("data-cookiename"),Cookie.set(r,"1",365))},save:function(n,t){var i,r,u,s,o;if(n&&t&&!n.classList.contains("disabled")){if(i=document.getElementById("note_with_call"),i&&i.checked&&!i.hasAttribute("data-shownedpopup")){Associated.Calls.openSavePopup(n,i.getAttribute("data-callurl"),i.getAttribute("data-callparam"),!0);return}r=n.up(".NoteEditor");u=r.querySelector("#HistoricBody");u.TinyEditor!=null&&u.TinyEditor.post();var h=$(r).find("*").serializeAll(),f=r.querySelector("#NoteCreationArea").querySelector(".AttachList"),c=Requests.get(Requests.keys.Medias)+"="+(f.MyMedia&&f.MyMedia.ItemList.length?f.MyMedia.serialize(!0):""),e=appendStringParams(h,[c]);$("#showNewTaskOptions").length==1&&(s=$("#showNewTaskOptions").attr("data-request"),e+="&"+s+"="+$("#showNewTaskOptions:checked").length);o=$(".detailNotesContentHeader").find(".NoteListType.active").attr("data-listtype");o&&(e+="&"+Requests.get(Requests.keys.HistoricListType)+"="+o);ajaxRequest(n,t,"POST",e,function(n){n.status==1&&n.data.list&&(Historic.clearControls(),i&&i.removeAttribute("data-shownedpopup"),Historic.mapIframesToRegister(n.data.list))})}},search:function(n,t){var i=$(".detailNotesContentHeader").find(".NoteListType.active").attr("data-listtype");Historic.getList(n,t,0,i)},saveEdit:function(n,t){var r,u;if(n&&t){var f=n.up("#RealestateFastEditPopup"),i=f.querySelector("#UploadMedia").querySelector(".AttachList"),o=Requests.get(Requests.keys.Medias)+"="+(i.MyMedia&&i.MyMedia.ItemList.length?i.MyMedia.serialize(!0):""),e=f.querySelector("#editHistoricBody");e.TinyEditor!=null&&e.TinyEditor.post();r=$("#RealestateFastEditPopup :input").serializeAll()+"&"+o;u=$(".detailNotesContentHeader").find(".NoteListType.active").attr("data-listtype");u&&(r+="&"+Requests.get(Requests.keys.HistoricListType)+"="+u);ajaxRequest(n,t,"POST",r,function(n){n&&n.status==1&&(n.data.list&&Historic.mapIframesToRegister(n.data.list),Popup.close())})}},toggleMenuEdit:function(n){$(n).toggleClass("active")},initializeMedia:function(n,t,i,r){var u,f;(u=t?document.getElementById(t):document.getElementById("HistoricEditor"),f=u.querySelector(r),f)&&(i||(i=[]),Media.setupUpload(f,n,i,u))},"delete":function(n,t,i,r,u,f){if(!r)return!1;var e="",o="";n&&(e=n.up(".detailNote"),o=n.up(".detailNotesList"));MessageBox.confirm(r,Translations.get(Translations.keys.Delete),function(){var r=null,s=n.up(".detailNotesList").querySelector(".listPagination");s!=null&&(r=n.up(".detailNotesList").querySelector(".listPagination").id);ajaxRequest(n,t,"POST",i,function(t){var h,s,c,i;t.status==1&&(e&&$(e).remove(),h=n.up(".detailNotesListContainer"),h&&(s=h.querySelector(".RecordCounter"),s&&(c=$(s).val(),$(s).val(parseInt(c)-1))),i=parseInt($(".paginationPages a.active").html()),o&&o.querySelectorAll(".detailNote").length==0&&(i?i>0&&(i=i-1):i=0),Historic.getList(document.getElementById(r),u,i,f))},{hideLoading:!0})})},edit:function(n,t,i,r){ajaxRequest(n,t,"GET",i,function(n){TinyMceEditor.load("editHistoricBody",300,r);var i=document.getElementById("RealestateFastEditPopup").getAttribute("data-mediauploadurl"),t=[];n.data.serializedMedia&&(t=JSON.parse(n.data.serializedMedia));Historic.initializeMedia(i,"RealestateFastEditPopup",t,"#UploadMedia")})},list:function(n,t,i,r,u){n&&n.classList.contains("active")||(u?$(".historicSearchContainer").hide():$(".historicSearchContainer").show(),Historic.getList(n,t,i,r,!0))},singleLoad:function(n,t,i,r,u){n.getAttribute("data-loaded")!=1&&(Historic.getList(n,t,i,r,u),n.setAttribute("data-loaded",1))},getList:function(n,t,i,r,u){var f=[],e,o,s,h,c,l,a,v;f.push(Requests.get(Requests.keys.Page)+"="+i);f.push($(".NoteEditor").find(".PrivateData").find("*").serializeAll());e=n?n.up(".detailNotesListContainer"):null;e&&(o=e.querySelector(".RecordCounter"),o&&f.push(Requests.get(Requests.keys.RecordCount)+"="+$(o).val()));r&&f.push(Requests.get(Requests.keys.HistoricListType)+"="+r);s=$(".searchNotes");s&&f.push(s.find("*").serializeAll());f=f.filter(function(n){return n.length}).join("&");h=!1;l="HistoricEditor";i&&(c=n?n.up(".detailNotesList").querySelector(".paginationPages"):null,c&&(a=$(c).find("a.active"),a&&(v=parseInt(a.html()),v&&v>parseInt(i)&&(l=n.parentElement.parentElement.getAttribute("id"),h=!0))));ajaxRequest(n,t,"GET",f,function(t){t&&t.status==1&&t.data&&t.data.list&&(u&&Historic.toggleList(n),Historic.mapIframesToRegister(t.data.list),i&&applyScroll(l,h))})},toggleSearch:function(n){$(n).hasClass("active")?($(n).next(".searchNotes").slideUp(),$(n).find("i").removeClass("icon-fechar").addClass("icon-pesquisa"),$(n).removeClass("active"),$(n).next(".searchNotes").find("input").val(""),$(n).next(".searchNotes").find("select").val("")):($(n).next(".searchNotes").slideDown(),$(n).find("i").removeClass("icon-pesquisa").addClass("icon-fechar"),$(n).addClass("active"))},clearControls:function(){var t,n;document.getElementById("HistoricBody").up("div").querySelector("iframe").contentWindow.document.body.innerHTML="";$("#TypeDropdown").length>0&&$("#TypeDropdown").val("");$("#HistoricEditor .AttachList").length==1&&$("#HistoricEditor .AttachList").html("");$("#showNewTaskOptions").length>0&&$("#showNewTaskOptions:checked").length==1&&$("#showNewTaskOptions").click();$("#notifyDropdown").length>0&&(t=$("#notifyDropdown").get(0).options[0].value,$("#notifyDropdown").val(t));$("#MinCreateDate").length>0&&$("#MinCreateDate").val("");n=$("#HistoricEditor").find(".shortMessageSubmit");n&&n.length==1&&!n.hasClass("disabled")&&n.addClass("disabled");$caller=$("#ToggleSearchAreaBtn");$("input[name=callUserList]").val("");Historic.setNotify(document.getElementById("HistoricBody"),"0");$caller.removeClass("active");$caller.next(".searchNotes").find("input").val("");$caller.next(".searchNotes").find("select").val("")},mapIframesToRegister:function(n){var n,t;if(n){if(n=JSON.parse(n),n&&n.length>0)for(IframeManager.registerIframes=[],t=0;t<n.length;t++)IframeManager.register(n[t].ID,n[t].Description);IframeManager.build(!0,!0)}},toggleList:function(n){var t;if(n){var i=$(n),u=i.index(),r=n.up(".detailNotesContentHeader");r&&$(r).find(".NoteListType").removeClass("active");i.addClass("active");t=i.parents(".detailNotes");t&&t.length==1&&t.find(".detailNotesContent").find(".detailNotesList").hide().eq(u).fadeIn()}},openManageBox:function(n,t){ajaxRequest(n,t,"GET",null,null,{popupOptions:new Popup.LayerOptions(null,null,null,function(){Historic.refreshHistoricType()})})},deleteHistoricType:function(n,t,i,r){var u,f;i&&n&&t&&(u=[],u.push($(".historicTypeManager").find(".PrivateData").find("*").serializeAll()),r&&u.push(Requests.get(Requests.keys.HistoricTypeID)+"="+r),f=u.filter(function(n){return n.length}).join("&"),MessageBox.confirm(i,Translations.get(Translations.keys.Delete),function(){ajaxRequest(n,t,"POST",f,function(t){if(t.status==1){var i=n.up(".etp_list_item");i&&i.remove()}},{hideLoading:!0})}))},editVisibilityHistoricType:function(n,t){var r,i,u,f;n.classList.toggle("active");r=n.up(".listContent").getAttribute("data-url");i=[];t&&i.push(Requests.get(Requests.keys.HistoricTypeID)+"="+t);u=n.classList.contains("active")?1:0;i.push(Requests.get(Requests.keys.Visible)+"="+u);f=i.filter(function(n){return n.length}).join("&");ajaxRequest(n,r,"POST",f)},openEditHistoricTypePopup:function(n,t,i,r){var u=[],f;i&&u.push(Requests.get(Requests.keys.HistoricTypeID)+"="+i);f=u.filter(function(n){return n.length}).join("&");ajaxRequest(n,t,"GET",f,function(n){n.status==1&&Translations.initAvailableLanguages("",r)})},saveEditHistoricType:function(n,t){if(n&&t){var i=$("#EditHistoricTypePopup :input").serializeAll();ajaxRequest(n,t,"POST",i,function(n){n&&n.status==1&&Popup.close()})}},refreshHistoricType:function(){var n=document.getElementById("NoteCreationArea");n&&ajaxRequest("",n.getAttribute("data-urlRefreshHistoricType"),"GET")},setIframeBodyEvents:function(){var n=document.getElementById("HistoricEditor").querySelector("iframe");n&&(n.contentWindow.document.designMode="on",navigator.userAgent.indexOf("Firefox")!=-1?($(n).contents().bind("blur",function(){Historic.setFocusout(n)}),$(n).contents().bind("focus",function(){Historic.setFocus(n)}),$("#shortMessageDefault").bind("click",function(){$(n).focus()})):($(n).contents().find("body").blur(function(){Historic.setFocusout(n)}),$(n).contents().find("body").focus(function(){Historic.setFocus(n)}),$("#shortMessageDefault").bind("click",function(){$(n).contents().find("body").focus()})),n.contentWindow.document.close())},setFocus:function(n){n.classList.contains("focusIframe")||n.classList.add("focusIframe")},setFocusout:function(n){n.classList.contains("focusIframe")&&n.classList.remove("focusIframe")},renderDeletedHistoricPopup:function(n,t,i){var r=[],u;i&&r.push(Requests.get(Requests.keys.HistoricID)+"="+i);u=r.filter(function(n){return n.length}).join("&");ajaxRequest(n,t,"GET",u,function(n){if(n.data){var t=document.getElementById("deletedHistoricFrame");t&&Historic.updateDeletedHistoricFrame(t,n.data)}})},updateDeletedHistoricFrame:function(n,t){var i,u,r;n&&t&&(n._content=t,i=n.contentDocument?n.contentDocument:n.contentWindow?n.contentWindow.document:n.document,i&&i.body&&i.body.getAttribute("ready")!="true")&&(u=document.createElement("base",{target:"_blank"}),i.getElementsByTagName("head")[0].appendChild(u),i.body.innerHTML=n._content,i.body.style.fontFamily="Arial",i.body.style.fontSize="12px",i.body.style.color="#6c7687",i.body.setAttribute("ready","true"),r=i.body.scrollHeight,n.style.height=r>500?"500px":r+5+"px")}};return n.LastNotes=function(){var n={};return{search:function(t,i){var o=0,r=[],e,u,f;$(t).parent().hasClass("dashboardMenu")?($(".LastNotesAction").each(function(){$(this).hasClass("active")&&$(this).removeClass("active")}),$(t).toggleClass("active"),$("#NoteTypeDropDown").length>0&&$("#NoteTypeDropDown").val(""),$("#TypeDropDown").length>0&&$("#TypeDropDown").val(""),$("#TimeIntervalDrop_DateLastNote").length>0&&$("#TimeIntervalDrop_DateLastNote").val(""),$("#EmployeeDropDown").length>0&&$("#EmployeeDropDown").val(""),$(t).attr("data-value")!=null&&$(t).attr("data-value")!=undefined&&$(t).attr("data-value").length>0&&(o=$(t).attr("data-value"))):(o=$("#NoteTypeDropDown option:selected").val(),r.push(Requests.get(Requests.keys.Type)+"="+$("#TypeDropDown option:selected").val()),e="",$("#TimeIntervalDrop_DateLastNote option:selected").val()==-1?(e=-1,u=$("#hidden_date_date_min"),f=$("#hidden_date_date_max"),u!=undefined&&f!=undefined&&u.attr("initval")!=undefined&&f.attr("initval")!=undefined&&(u.length>0&&u.attr("value").length>0&&r.push(Requests.get(Requests.keys.DateStart)+"="+u.attr("value")),f.length>0&&f.attr("value").length>0&&r.push(Requests.get(Requests.keys.DateEnd)+"="+f.attr("value")))):$("#TimeIntervalDrop_DateLastNote option:selected").val()!=""&&(e=$("#TimeIntervalDrop_DateLastNote option:selected").val()),r.push(Requests.get(Requests.keys.Date)+"="+e),r.push(Requests.get(Requests.keys.TargetUserID)+"="+$("#EmployeeDropDown option:selected").val()));r.push(Requests.get(Requests.keys.TypeID)+"="+o);ajaxRequest(t,i,"GET",r.join("&"),function(t){t&&t.status==1&&t.data&&(n=JSON.parse(t.data.parameters),Historic.mapIframesToRegister(t.data.iframeRegisterList))})},seeMore:function(t,i){var r=isObject(n)&&!$.isEmptyObject(n)?JSON.stringify(n):"",u;r=="{}"&&(r="");u=Requests.get(Requests.keys.SearchParameters)+"="+r;ajaxRequest(t,i,"GET",u,function(i){i&&i.status==1&&i.data&&(n=JSON.parse(i.data.parameters),$(t).parent().remove(),typeof i.data.html=="string"&&i.data.html.length>0&&$("#lastNotesResultsList").append(i.data.html),Historic.mapIframesToRegister(i.data.iframeRegisterList))})}}}(),n}(),AgencyNews=function(){var i,r=function(n,t){window.tinyEditors&&window.tinyEditors.forEach(function(n){n.post()});AgencyNews.PutPicturesOnPost();AgencyNews.PutFilesOnPost();AgencyNews.PutVideosOnPost();document.getElementById("FormWebsitePost").querySelectorAll(".contactSearchDrop").forEach(function(n){n.innerHTML=""});var i=$("#FormWebsitePost *").serializeAll();ajaxRequest(n,t,"POST",i,function(n){window.location=n.data.redirectUrl})},p=function(n){var t=$("postPublishSearch");n.hasClassName("off")?(n.removeClassName("off").addClassName("on"),t.value="1"):(n.removeClassName("on").addClassName("off"),t.value="");Paginator.searchByFreeText($("freeTextSearch"))},w=function(n){var t=$("postDeleteSearch");n.hasClassName("off")?(n.removeClassName("off").addClassName("on"),t.value="1"):(n.removeClassName("on").addClassName("off"),t.value="");Paginator.searchByFreeText($("freeTextSearch"))},b=function(){AgencyNews._pictures=null;$("oThumb").setAttribute("isempty","1");$("oThumb").src="";$("oUplHandlerRemove").hide()},u=function(n){var i=n.up(".contentPhoto"),t;if(i){for(t=AgencyNews.Pictures.length-1;t>=0;t--)if(AgencyNews.Pictures[t].UID===i.getAttribute("data-uid")){AgencyNews.Pictures[t].Deleted=!0;break}i.parentNode.removeChild(i)}},f=function(n){var i=n.up(".contentAgencyNewsFile"),t;if(i){for(t=AgencyNews.Files.length-1;t>=0;t--)if(AgencyNews.Files[t].UID===i.getAttribute("data-uid")){AgencyNews.Files[t].Deleted=!0;break}i.parentNode.removeChild(i)}},e=function(n){var i=n.up(".agencyNewsVideo"),t;if(i){for(t=AgencyNews.Videos.length-1;t>=0;t--)if(AgencyNews.Videos[t].UID===i.getAttribute("data-uid")){AgencyNews.Videos[t].Deleted=!0;break}i.parentNode.removeChild(i)}},o=function(n){n&&Translations.initAvailableLanguages(null,n);$("#photoContainer").sortable({handle:".photoDragHandler",connectWith:"#photoContainer",items:".contentPhoto"});$("#videoContainer").sortable({handle:".photoDragHandler",connectWith:"#photoContainer",items:".contentPhoto"})},n=function(n,t){if(!Array.isArray(n)||n.length==0)return null;for(var i=0;i<n.length;i++)if(n[i].UID==t)return n[i];return null},s=function(){var t=document.getElementById("photoContainer"),i=0;t&&t.querySelectorAll(".contentPhoto").forEach(function(t){var r=n(AgencyNews.Pictures,t.getAttribute("data-uid"));r&&(r.Priority=i,i++)});document.getElementById("picturesInput").value=JSON.stringify(AgencyNews.Pictures)},h=function(){var t=document.getElementById("fileContainer"),i=0;t&&t.querySelectorAll(".contentAgencyNewsFile").forEach(function(t){var r=n(AgencyNews.Files,t.getAttribute("data-uid"));r&&(r.Priority=i,i++)});document.getElementById("filesInput").value=JSON.stringify(AgencyNews.Files)},c=function(){var t=document.getElementById("videoContainer"),i=0;t&&t.querySelectorAll(".contentPhoto").forEach(function(t){var r=n(AgencyNews.Videos,t.getAttribute("data-uid"));r&&(r.Priority=i,i++)});document.getElementById("videosInput").value=JSON.stringify(AgencyNews.Videos)},l=function(n,t){n&&document.getElementById(t)&&(n.checked?(document.getElementById(t).show(),document.getElementById(t).querySelector(".ContactBar").click()):document.getElementById(t).hide())},t=function(n,t){if(n.checked){$("#PhoneRecipients").show();var i=$("#agencyNewsExtraInfo2 *").serializeAll();i?AgencyNews.UsersAndGroupsCount!=i?ajaxRequest(n,t||n.getAttribute("data-url"),"POST",i,function(){n.next().show();AgencyNews.UsersAndGroupsCount=i}):n.next().show():($("#smsCount").html("0"),n.next().show(),AgencyNews.UsersAndGroupsCount=i)}else n.next().hide(),$("#PhoneRecipients").hide()},a,v=function(n){n&&document.getElementById("notificationsContainer")&&document.getElementById("dateContainer")&&(n.value==1?(document.getElementById("notificationsContainer").show(),document.getElementById("dateContainer").show()):(document.getElementById("notificationsContainer").hide(),document.getElementById("dateContainer").hide()))},y=function(){IframeManager.build(!0,!0)};return{Pictures:[],Videos:[],Files:[],RemovePicture:u,Load:o,PutPicturesOnPost:s,Save:r,CheckSendEmail:l,UpdateSmsCount:t,UsersAndGroupsCount:a,YoutubeHandler:i,UpdateSmsCountFromCallback:function(){t(document.getElementById("sendSmsInput"))},ChangePublishStatus:v,OpenManageBox:function(n,t,i){ajaxRequest(n,t,"GET",null,null,{popupOptions:new Popup.LayerOptions(null,null,null,function(){typeof i=="function"&&i()})})},RenderDropdownOnPopupClose:function(n,t){var u={},i=document.getElementById(t),r;i&&(r=i.querySelector("select"),r&&(u[Requests.get(Requests.keys.SelectedIDs)]=$(r).val().toString()));ajaxRequest(null,n,"POST",u,function(){i&&applyDropdowns(i)})},RemoveFile:f,PutFilesOnPost:h,PutVideosOnPost:c,RemoveVideo:e,OpenYoutubeVideo:function(n,t){var i,r;t&&t.preventDefault();i=n.up(".agencyNewsVideo");i&&i.hasAttribute("data-vid-url")&&(r=createHtmlElement("object",{width:"420",height:"315",data:i.getAttribute("data-vid-url")}),Popup.openWithStructure(null,null,r,null,{hideHeader:!0,hideFooterContent:!0,fitContent:!0}))},OpenAgencyNews:function(n,t,i){ajaxRequest(n,t,"GET",i)},agencyNewsCommentsrenderPage:function(n,t,i){var r=document.getElementById("newsDetailPopup"),u=r.getAttribute("data-request");i="Page="+i+"&objID="+u;ajaxRequest(n,t,"POST",i)},OpenConfirmCommentDelete:function(n,t,i){ajaxRequest(n,t,"POST",i)},DeleteComment:function(n,t,i){ajaxRequest(n,t,"POST",i)},AddComment:function(n,t,i){var r=document.getElementById("commentText").value;i+="&note_body="+r;r.length>0&&ajaxRequest(n,t,"POST",i)},AddCommentKeyUpAction:function(){var i=document.getElementById("commentText").value,n=document.getElementById("AddCommentButton"),t=document.getElementById("commentDefault");i.length>0?(n.removeClassName("disabled"),t.hide()):(n.addClassName("disabled"),t.show())},SearchLoad:y,deleteOpenDialog:function(n,t,i){var r;i?r=i:(r=Search.GenericList.getSelectedIDs(),r.length>0&&(r=r.join(",")));ajaxRequest(n,t,"POST",Requests.get(Requests.keys.ObjectIDs)+"="+r)},"delete":function(n,t,i){ajaxRequest(n,t,"POST",i,function(n){n&&n.status==ajaxRequest.StatusType.Success&&Search.GenericList.deselectAll(!0)})}}}();